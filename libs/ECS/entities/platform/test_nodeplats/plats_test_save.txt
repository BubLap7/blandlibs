{"map":{"name":"plats_test","ambient":"#97a0a8","light":"#f2f8fc","sky":"#dce8ed","fog":"#8d9aa0","fogD":2000,"xyz":[532,10,1059,7,11,7,5,5,5,40,0.01,10,5000,10,5000,50,10,50,38,0.01,10,30,85,30,110,5,30,30,5,110,110,85,30,30,85,110,110,5,110,111,7,111,111,87,31,41.08,87,111],"colors":["#CC00C0"],"objects":[{"p":[0,0,0],"meshUUID":"0ebc6fd2-8b5a-4a66-9271-b87d8a367c5e","objUUID":"0c731f3e-7ef0-4719-80da-d42798c5c1f2","si":0},{"p":[-38,10,0],"meshUUID":"35a4e9ca-63e3-4e88-a0db-bff26af383cf","objUUID":"15e6ec6b-a468-42f3-b327-d42143e264f0","i":5,"tm":0,"si":1},{"p":[48,11,-194],"meshUUID":"fd186ae2-8617-4497-87ac-c2367f8a87e1","objUUID":"f5fdff29-b6a6-4807-885a-ca2a363b53b6","i":64,"l":1,"nid":201,"si":2},{"p":[50,51,-80],"meshUUID":"a3f87a0d-609f-49f0-9ed6-8a92ddd3008d","objUUID":"8ea648bb-b592-4ac0-9468-b811371b334d","i":64,"l":1,"nid":301,"si":2},{"p":[49,51,37],"meshUUID":"2cc4b793-0aa8-4aca-b8cf-78852f8bdfd7","objUUID":"8e9666e4-6073-44f7-94b5-9dd9e40c865c","i":64,"l":1,"nid":401,"si":2},{"p":[50,11,203],"meshUUID":"23eff5f0-d705-4d7e-b2ae-8ed7025f3028","objUUID":"4f3db29a-db86-4d6c-ac25-a8001d2e0b62","i":64,"l":1,"nid":501,"si":2},{"p":[49.95,14,-194.01],"meshUUID":"f12d4d92-9fc8-4803-b81a-c8edccef4b08","objUUID":"aa834df2-ec03-4707-8298-a0b4da6c15de","i":30,"r":[1.57,0,1.57],"st":"Z_LIN_PLAT","bv":1,"sf":70,"sa":1,"si":3},{"p":[52,54.05,-80],"meshUUID":"438863a3-35b0-4918-bbfa-4ae525d00dee","objUUID":"012e9909-b941-4331-b162-8c206053ada1","i":30,"r":[1.57,0,1.57],"st":"VERT_CIRCLEX_PLAT","bv":1,"sf":70,"sa":1,"si":3},{"p":[51.04,54.09,37],"meshUUID":"b9369c0f-e66e-40ac-82e5-0e6206d4a2cd","objUUID":"59ccbbc3-7bb0-4c9d-b965-75839ca345d0","i":30,"r":[1.57,0,1.57],"st":"VERT_CIRCLEZ_PLAT","bv":1,"sf":70,"sa":1,"si":3},{"p":[52.07,14.12,202.93],"meshUUID":"e9016a18-6729-48c6-adbd-b849d891e163","objUUID":"6298bd43-b174-4c34-a223-1586b047b56a","i":30,"r":[1.57,0,1.57],"st":"HOR_CIRCLE_PLAT","bv":1,"sf":70,"sa":1,"si":3},{"p":[50,11,-366],"meshUUID":"422572d0-72fa-4c8e-932b-e5d4cccfe2bc","objUUID":"d6869632-279c-4f36-a3cc-0c168e9ad867","i":64,"l":1,"si":2},{"p":[51.95,14,-366.07],"meshUUID":"192f8338-d938-46ee-b7df-de0d3a67227e","objUUID":"eb077eb8-0dc5-4243-a8f9-1b0feeef20bb","i":30,"r":[1.57,0,1.57],"st":"X_LIN_PLAT","bv":1,"sf":70,"sa":1,"si":3},{"p":[48,51,-296],"meshUUID":"eebc208a-79cc-406a-9d47-222ea3fce716","objUUID":"a13ae9a6-3ec9-48a9-9ef8-be20a8e6c6dd","i":64,"l":1,"nid":101,"si":2},{"p":[49.95,54,-296.01],"meshUUID":"f0a79f97-b9e7-483f-908b-b3002e62f528","objUUID":"d68fa617-6927-45b6-b5ad-171bb20f0974","i":30,"r":[1.57,0,1.57],"st":"Y_LIN_PLAT","bv":1,"sf":70,"sa":1,"si":3},{"p":[0,-21,0],"meshUUID":"0f027443-edce-42e9-a210-5bfb2d340d04","objUUID":"aa96da64-3cd0-4b6d-bed7-d1964b00a3dd","i":27,"tm":0,"m":1,"tcp":1,"si":4},{"p":[-38,10,0],"meshUUID":"d3086935-0836-4166-948a-ce191d722970","objUUID":"7530de3e-7470-42c1-a815-060b3ab7f157","i":25,"tm":0,"si":5},{"p":[-150,11,-366],"meshUUID":"926c38aa-5942-469e-989b-b9f8aab89f33","objUUID":"7a621e4f-e20f-4b01-a9ff-ccfbc5df9218","i":64,"l":1,"nid":51,"si":2},{"p":[-148.71,14,-366.06],"meshUUID":"35880ac0-c3c1-4084-9219-81cd89fd4a8d","objUUID":"83c46467-5586-450d-a800-977eac63c3a5","i":30,"r":[1.57,0,-1.57],"st":"X_LIN_0_5_PLAT","bv":1,"sf":70,"sa":1,"si":3},{"p":[-146,51,-296],"meshUUID":"dd8b25db-b7cf-4493-9c73-46c60ba7ebd3","objUUID":"2fa34afd-2d6a-4d52-90f0-08a7cd9e1893","i":64,"l":1,"nid":151,"si":2},{"p":[-150,54,-295.94],"meshUUID":"a7936ffd-0a86-464e-9277-373a856fa1b7","objUUID":"598b4602-8f11-4a42-be87-c09fd598f9b6","i":30,"r":[1.57,0,-1.57],"st":"Y_LIN_0_5_PLAT","bv":1,"sf":70,"sa":1,"si":3},{"p":[-122,11,-194],"meshUUID":"4ccc0dd0-4dc0-4279-93d9-c840a4d14deb","objUUID":"2039494f-cbf8-4224-a46b-1d79a4f7d08f","i":64,"l":1,"nid":251,"si":2},{"p":[-150,14,-193.95],"meshUUID":"88efb23a-a1dc-4b5d-9bf1-e6a9ed676702","objUUID":"cc7327bb-67b3-48c3-9f1d-d6c87a38fc36","i":30,"r":[1.57,0,-1.57],"st":"Z_LIN_0_5_PLAT","bv":1,"sf":70,"sa":1,"si":3},{"p":[-150,51,-80],"meshUUID":"ccc42296-d3cc-436b-8f61-f455a9cb19eb","objUUID":"046b10bb-685b-4f98-8ee4-dc64cf8a4694","i":64,"l":1,"nid":351,"si":2},{"p":[-154,54.05,-80],"meshUUID":"fb14785a-1865-4e58-819b-2ee321fe3daa","objUUID":"3c10eeda-a9d3-450a-b4c2-e8aa5c28b68e","i":30,"r":[1.57,0,-1.57],"st":"VERT_CIRCLEX_0_5_PLAT","bv":1,"sf":52,"sa":1,"si":6},{"p":[-152,51,37],"meshUUID":"e812e3e5-6147-4c1d-ae80-deaf5e83441d","objUUID":"aa52425c-b352-4ed9-b750-88d99192b948","i":64,"l":1,"nid":451,"si":2},{"p":[-149.96,54.09,37],"meshUUID":"6ec55d54-1ce2-421b-821a-2e2e265a4526","objUUID":"32c6709d-ae69-41e1-bba9-25a2045c0e41","i":30,"r":[1.57,0,-1.57],"st":"VERT_CIRCLEZ_0_5_PLAT","bv":1,"sf":57,"sa":1,"si":3},{"p":[-150,11,203],"meshUUID":"c17b1e6b-67cb-4383-bdbf-f35667908ce1","objUUID":"9980a9b2-42f1-4d5d-b0fc-a6d7acdd6d5c","i":64,"l":1,"nid":551,"si":2},{"p":[-147.93,14.12,202.93],"meshUUID":"a4314c74-e18c-46f0-964a-86af845c941d","objUUID":"53c99d02-b7c7-4e47-acec-3c53c2e302f5","i":30,"r":[1.57,0,-1.57],"st":"HOR_CIRCLE_0_5_PLAT","bv":1,"sf":66,"sa":1,"si":3},{"p":[48,11,-296],"meshUUID":"c10c390f-d1c7-4ead-9059-b10a81cc2de6","objUUID":"f600d877-e5f4-40ee-ba91-5a240207934b","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":7},{"p":[-146,11,-296],"meshUUID":"fbe81d09-f7b5-4477-96f9-1ad5a7a3c976","objUUID":"7fe52fdd-95d4-4892-bdd9-aaf1cd5d1485","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":7},{"p":[-150,11,-366],"meshUUID":"5a9b7bff-ca9d-4abc-aee7-15b46448403a","objUUID":"7361e72e-e6ed-45b2-908a-a5f4c06111a6","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":8},{"p":[50,11,-366],"meshUUID":"9d690e2a-e48c-4a24-973f-0dc2ac629fb0","objUUID":"cb8ca87a-6bc4-424c-9b8f-ad98508f4d7c","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":8},{"p":[48,11,-194.01],"meshUUID":"0956b0c0-e7b3-4617-a5b7-370407166c10","objUUID":"64f74ba7-eed6-4664-8450-3be141258424","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":9},{"p":[-122,11,-194.01],"meshUUID":"6c37e6ca-7eba-42a7-a780-ed1e0d0e65be","objUUID":"8283677b-4107-4545-9f0e-c02e72605f52","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":9},{"p":[50,11,-80],"meshUUID":"3b24c6a5-2e43-4ab0-8d21-bcf284989e00","objUUID":"7417ee38-04a4-4f9f-bd7b-5b3948c29b82","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":10},{"p":[-150,11,-80],"meshUUID":"91c5bd08-a90d-49a8-8ffe-d7e8329edb59","objUUID":"2ba025b9-76d2-4a46-950e-58b40b310b74","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":10},{"p":[49,11,37],"meshUUID":"f369a65e-ff40-4031-a7d8-223c8ad42a48","objUUID":"aea35520-153c-45d5-83c8-01b7e46e7110","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":11},{"p":[-152,11,37],"meshUUID":"2b64bce8-2823-4c16-b806-46e25387785d","objUUID":"98a8861d-4541-4214-bba1-ca94d4b3216a","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":11},{"p":[50,11,203],"meshUUID":"a77a4e72-03d9-414b-a5cb-ebaa5f38b1ce","objUUID":"fd1d49a1-34a9-4dde-8bf3-d199fd7b53b8","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":12},{"p":[-150,11,203],"meshUUID":"418ccdf4-0015-4b9f-b224-54726edc6dda","objUUID":"dadb9997-1025-4e44-9ba7-d93e217d52eb","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":12},{"p":[50,10,203],"meshUUID":"493c2716-93c4-4496-a634-b2d3363964de","objUUID":"ff5e1b15-76d9-4e50-bbd7-29fbc54aa9c9","i":35,"si":13},{"p":[50,11,350],"meshUUID":"d7e27226-c4ea-47f7-aa3e-dee4a0ec9143","objUUID":"49c438c9-f2b1-4224-a58c-28fed2b89cb3","i":64,"l":1,"nid":601,"si":2},{"p":[52.07,14.12,349.93],"meshUUID":"afb40494-d2c5-45e5-b7eb-68ca02e0b92e","objUUID":"9cde0ac4-5419-4d0b-a79b-8c5b8f0b4298","i":30,"r":[1.57,0,1.57],"st":"HOR_CIRCLE_CC_PLAT","bv":1,"sf":70,"sa":1,"si":3},{"p":[50,11,350],"meshUUID":"4a375cf4-b307-425f-88d3-044f3ff573b0","objUUID":"60816c00-2502-421e-bd0e-aa209e287871","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":12},{"p":[50,10,350],"meshUUID":"25ca7813-b506-4753-ba13-3bdd6707173d","objUUID":"bf3b9c71-fd33-43e5-9c6d-331ac877af1b","i":35,"si":13},{"p":[-150,10,203],"meshUUID":"ef114562-aec7-4415-b987-97ab28bc01aa","objUUID":"828eaa92-32ba-4a5b-b8a1-d4359c5524a0","i":35,"si":13},{"p":[-150,11,350],"meshUUID":"51ce432e-99f4-47cf-a329-1a537353b425","objUUID":"496e1e7d-a0ec-4f33-87b5-ecaa692c38ac","i":64,"l":1,"nid":651,"si":2},{"p":[-147.93,14.12,349.93],"meshUUID":"f63c26e9-0a27-4f95-af08-4b44fd2c11ae","objUUID":"931d619a-fd6f-4995-bbc7-40b1e9969850","i":30,"r":[1.57,0,-1.57],"st":"HOR_CIRCLE_0_5__CC_PLAT","bv":1,"sf":66,"sa":1,"si":3},{"p":[-150,11,350],"meshUUID":"35d2f234-500c-44d7-bdc6-09dcad7a505d","objUUID":"344c86da-90c1-4e0d-a632-16e445f6e6cb","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":12},{"p":[-150,10,350],"meshUUID":"dda818ff-b7bc-478e-b4d2-366b3888f2f9","objUUID":"12289831-a714-48bf-a768-9dba5e408d2a","i":35,"si":13},{"p":[50,10,-80],"meshUUID":"8d55049a-8155-4d8d-bb99-0ce960c1e9d4","objUUID":"baa7b0f0-7018-4afb-810b-368b4c8d18d6","i":35,"si":14},{"p":[186,51,-80],"meshUUID":"54e12a9b-e299-4e3b-9542-45eb071001d4","objUUID":"e40aab9d-0d23-4a05-b1b9-816068281351","i":64,"l":1,"nid":701,"si":2},{"p":[188,54.05,-80],"meshUUID":"9d877895-1634-4cba-8ae0-3d6adbfdce3d","objUUID":"a885b7d8-74ef-47f7-9f42-517f58b3f524","i":30,"r":[1.57,0,1.57],"st":"VERT_CIRCLEX_CC_PLAT","bv":1,"sf":70,"sa":1,"si":3},{"p":[186,11,-80],"meshUUID":"e1fc0070-fe0f-496c-84f2-383e7297edeb","objUUID":"43d7d586-a16e-4e12-bf0f-a42b6a7a7b0c","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":10},{"p":[186,10,-80],"meshUUID":"205984bc-51f4-42b5-8fcc-a64e31afbc63","objUUID":"9f9a2a32-b386-476c-a56c-660c806e6120","i":35,"si":14},{"p":[-150,10,-80],"meshUUID":"e82222d5-c855-4ae5-8995-75b5bd755a8f","objUUID":"7ab79dc0-30d3-4038-b8ba-15755cda97d4","i":35,"si":14},{"p":[-282,51,-80],"meshUUID":"b8f32724-5f4c-4129-9d9f-1682476fed08","objUUID":"cbb5f097-7f8a-48e3-a227-49c5355e013d","i":64,"l":1,"nid":751,"si":2},{"p":[-286,54.05,-80],"meshUUID":"30e43e38-8bbb-4128-ab38-27653e65efd2","objUUID":"04236131-1748-44b9-bb7a-29f5328f23d5","i":30,"r":[1.57,0,-1.57],"st":"VERT_CIRCLEX_CC_0_5_PLAT","bv":1,"sf":52,"sa":1,"si":6},{"p":[-282,11,-80],"meshUUID":"daded675-9d9e-4fe6-b9b0-308f5ab51a17","objUUID":"40b9dd36-6ff9-45c3-a1ea-afc4b55ff0dc","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":10},{"p":[-282,10,-80],"meshUUID":"4ca2014e-12ea-4851-8677-57bc8b2eb8ab","objUUID":"80ffc61a-1fda-405b-bd34-037e66d29716","i":35,"si":14},{"p":[51,10,37],"meshUUID":"b0c8c79f-44b5-4e57-82fb-c8291c202370","objUUID":"4c85c59d-9527-41e2-a433-59ad4a9a046a","i":35,"si":15},{"p":[135,51,37],"meshUUID":"ce73fb97-bbcb-41d1-b18c-6b5fbbd082d0","objUUID":"7227f0f9-0d27-4c6b-b4c2-4ce836b40698","i":64,"l":1,"nid":801,"si":2},{"p":[137.04,54.09,37],"meshUUID":"89246411-f42d-4205-9738-d97fe35b638b","objUUID":"161eec8c-7687-4292-8a1d-fdbb8e8530ee","i":30,"r":[1.57,0,1.57],"st":"VERT_CIRCLEZ_CC_PLAT","bv":1,"sf":70,"sa":1,"si":3},{"p":[135,11,37],"meshUUID":"6b019a83-e86b-4c20-beeb-6a3c5f1ed133","objUUID":"5984e84e-900f-49c5-929b-1162e06ba757","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":11},{"p":[137,10,37],"meshUUID":"0384ac8e-4d17-434b-b677-ef3e0df9c2f2","objUUID":"22ead92d-f746-48fc-ba20-68ece63e1563","i":35,"si":15},{"p":[-150,10,37],"meshUUID":"98424399-6188-4218-9218-dfc8742a3aea","objUUID":"5c187305-d0cb-4d76-b866-8f6425929fb1","i":35,"si":15},{"p":[-231,51,37],"meshUUID":"fecc18b9-1608-47ac-97b2-3c1e17164ab9","objUUID":"5223d11d-10f8-4ea9-9864-66d8dedcee1e","i":64,"l":1,"nid":851,"si":2},{"p":[-228.96,54.09,37],"meshUUID":"c32de8eb-ba74-4138-b564-9de8438ea3f2","objUUID":"969daef9-6dd3-4eb5-95dd-5387788ff48e","i":30,"r":[1.57,0,-1.57],"st":"VERT_CIRCLEZ_CC_0_5_PLAT","bv":1,"sf":57,"sa":1,"si":3},{"p":[-231,11,37],"meshUUID":"47413c3d-69bf-42fe-8b20-40c69b6de00b","objUUID":"a27174de-7a8e-426d-b6ce-24e8e649a576","i":29,"pl":1,"cdy":1,"o":0.7,"tm":0,"tas":[{}],"sd":1,"ci":0,"si":11},{"p":[-229,10,37],"meshUUID":"ff8cf6e1-7ab1-44ee-90ad-60c742613d88","objUUID":"6ecc930e-0970-43c6-b644-eed34da73bb2","i":35,"si":15}],"config":{"classes":[9],"settings":{"maxPlayers":20,"gameTime":0}},"scripts":{"client":"IyBjb2xsaXNpb24gd2l0aCBwbGF0Zm9ybXMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMgTGlicmFyeTogXGxpYnNcdXRpbHNccGxheWVyc1xwbHJ1dGlsX2Mua3JuawojIEF1dGhvcjogYmxhbmRyaWNlCiMgICBEZXNjcmlwdGlvbjogd29ya2Fyb3VuZCB0byBjaGVjayBob3cgbWFueSBwbGF5ZXJzIGFyZSBzcGF3bmVkIGluCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKYm9vbCBwbHJ1dGlsX2NfaW1zcGF3bmVkID0gZmFsc2U7CgphY3Rpb24gcGxydXRpbF9jX3N0YXJ0KCkgewogICAgcGxydXRpbF9jX2ltc3Bhd25lZCA9IGZhbHNlOwp9CgphY3Rpb24gcGxydXRpbF9jX29uUGxheWVyU3Bhd24oc3RyIGlkKSB7CiAgICBvYmogdHBsciA9IEdBTUUuUExBWUVSUy5maW5kQnlJRChpZCk7CiAgICBpZiAoKGJvb2wpdHBsci5pc1lvdSkgewogICAgICAgIEdBTUUuTkVUV09SSy5zZW5kKCJzcGF3biIsIHt9KTsKICAgICAgICBwbHJ1dGlsX2NfaW1zcGF3bmVkID0gdHJ1ZTsKICAgIH0KfQoKYWN0aW9uIHBscnV0aWxfY19vblBsYXllckRlYXRoKHN0ciBpZCwgc3RyIGtpbGxlcklEKSB7CiAgICBvYmogdHBsciA9IEdBTUUuUExBWUVSUy5maW5kQnlJRChpZCk7CiAgICBpZiAoKGJvb2wpdHBsci5pc1lvdSkgewogICAgICAgIHBscnV0aWxfY19pbXNwYXduZWQgPSBmYWxzZTsgICAgCiAgICB9Cn0KCgojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIyBIZWFkZXI6IFxsaWJzXHV0aWxzXGdsb2JhbFxnLmtybmsKIyBBdXRob3I6IGJsYW5kcmljZQojICAgRGVzY3JpcHRpb246IHNvbWUgZ2xvYmFsIHZhcnMgdGhhdCBvdGhlciBsaWJzIGNhbiByZWZlcmVuY2UgdG8gcmVkdWNlIGNhbGxzCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCm51bSBnX3Rub3cgPSAwOwoKYWN0aW9uIGdfdXBkYXRlKG51bSBkZWx0YSl7CiAgICBnX3Rub3cgPSBHQU1FLlRJTUUubm93KCk7Cn0KIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMgSGVhZGVyOiBcbGlic1xjb2xsaXNpb25zXEFBQkIua3JuawojIEF1dGhvcjogS0cwNyAobW9kaWZpZWQgYnkgYmxhbmRyaWNlKQojIERlc2NyaXB0aW9uOiBBQUJCIChheGlzLWFsaWduZWQgYm91bmRpbmcgYm94LWJveCkgY29sbGlzaW9uICsgcmVzb2x1dGlvbgojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCm51bSBBQUJCX3cgPSA0Ljk7IyBwbGF5ZXIgd2lkdGgKbnVtIEFBQkJfYyA9IDg7IyBjcm91Y2hpbmcgaGVpZ2h0Cm51bSBBQUJCX0ggPSAxMTsjIHN0YW5kaW5nIGhlaWdodAoKbnVtIEFBQkJfWE5FRyA9IDB4MTsKbnVtIEFBQkJfWFBPUyA9IDB4MjsKbnVtIEFBQkJfWU5FRyA9IDB4NDsgI2hpdCAiZ3JvdW5kIgpudW0gQUFCQl9ZUE9TID0gMHg4OyAKbnVtIEFBQkJfWk5FRyA9IDB4MTA7Cm51bSBBQUJCX1pQT1MgPSAweDIwOwoKIyBjb2xsaWRlIHR5cGVzCm51bSBBQUJCX0NPTF9OT05FID0gMHgwOyAjIG5vIGNvbGxpZGUKbnVtIEFBQkJfQ09MX1dPUkxEID0gMHgwMTsgIyBvYmplY3QgY2FuIGNvbGxpZGUgd2l0aCB3b3JsZApudW0gQUFCQl9DT0xfT0JKUyA9IDB4MDI7ICMgb2JqZWN0IGNhbiBjb2xsaWRlIHdpdGggb3RoZXIgb2JqZWN0cwpudW0gQUFCQl9DT0xfUExSUyA9IDB4MDQ7ICMgb2JqZWN0IGNhbiBBQUJCX2RldGVjdCBjb2xsaWRlIHdpdGggcGxheWVyCm51bSBBQUJCX0NPTF9PQkoyUExSUyA9IDB4MDg7ICMgIyBwbGF5ZXIgY2FuIGNvbGxpZGUgd2l0aCBvYmplY3QgKHVzdWFsbHkgcmVzb2x2ZXMgY29sbGlkZS4gY3VycmVudGx5IGRlZmF1bHQgdGhpcyBkb2VzIG5vdCBtYXR0ZXIpCgpib29sIGFjdGlvbiBBQUJCX2lzQ29sbGlzaW9uKG9iaiBjdWJlMSwgb2JqIGN1YmUyKQp7CiAgICAjIEFkYXB0ZWQgZnJvbSBodHRwczovL3R1dG9yaWFsZWRnZS5uZXQvZ2FtZWRldi9hYWJiLWNvbGxpc2lvbi1kZXRlY3Rpb24tdHV0b3JpYWwvCiAgICBudW0gZHggPSBNYXRoLmFicygobnVtKWN1YmUxLnBvc2l0aW9uLnggLSAobnVtKWN1YmUyLnBvc2l0aW9uLngpIC0gKChudW0pY3ViZTEuc2NhbGUueC8yICsgKG51bSljdWJlMi5zY2FsZS54LzIpOwogICAgbnVtIGR5ID0gTWF0aC5hYnMoKG51bSljdWJlMS5wb3NpdGlvbi55ICsobnVtKWN1YmUxLnNjYWxlLnkvMiAtIChudW0pY3ViZTIucG9zaXRpb24ueSAtIChudW0pY3ViZTIuc2NhbGUueS8yKSAtICgobnVtKWN1YmUxLnNjYWxlLnkvMiArIChudW0pY3ViZTIuc2NhbGUueS8yKTsKICAgIG51bSBkeiA9IChNYXRoLmFicygobnVtKWN1YmUxLnBvc2l0aW9uLnogLSAobnVtKWN1YmUyLnBvc2l0aW9uLnopIC0gKChudW0pY3ViZTEuc2NhbGUuei8yICsgKG51bSljdWJlMi5zY2FsZS56LzIpKTsKICAgIGlmICgoZHggPCAwKSAmJiAoZHkgPCAwKSAmJiAoZHogPCAwKSkKICAgIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIHJldHVybiBmYWxzZTsKICAgICAgICAKfQoKb2JqIGFjdGlvbiBBQUJCX0NhbGN1bGF0ZUFhYmJEaXN0YW5jZVRvKG9iaiBjdWJlMSwgb2JqIGN1YmUyKQp7CiAgICBudW0gZHggPSBNYXRoLmFicygobnVtKWN1YmUxLnBvc2l0aW9uLnggLSAobnVtKWN1YmUyLnBvc2l0aW9uLngpIC0gKChudW0pY3ViZTEuc2NhbGUueC8yICsgKG51bSljdWJlMi5zY2FsZS54LzIpOwogICAgbnVtIGR5ID0gTWF0aC5hYnMoKG51bSljdWJlMS5wb3NpdGlvbi55ICsobnVtKWN1YmUxLnNjYWxlLnkvMiAtIChudW0pY3ViZTIucG9zaXRpb24ueSAtIChudW0pY3ViZTIuc2NhbGUueS8yKSAtICgobnVtKWN1YmUxLnNjYWxlLnkvMiArIChudW0pY3ViZTIuc2NhbGUueS8yKTsKICAgIG51bSBkeiA9IChNYXRoLmFicygobnVtKWN1YmUxLnBvc2l0aW9uLnogLSAobnVtKWN1YmUyLnBvc2l0aW9uLnopIC0gKChudW0pY3ViZTEuc2NhbGUuei8yICsgKG51bSljdWJlMi5zY2FsZS56LzIpKTsKCiAgICByZXR1cm4ge3g6ZHgseTpkeSx6OmR6fTsKfQoKbnVtIEFBQkJfc3QgPSAzOyNzdGFpciBoZWlnaHQKCm51bSBhY3Rpb24gQUFCQl9zaWRlKG51bSBDLCBudW0gUywgbnVtIGlucHV0KXsKCWlmKGlucHV0IDw9IEMtUyl7cmV0dXJuIC0xO30KCWlmKGlucHV0ID49IEMrUyl7cmV0dXJuIDE7fQoJcmV0dXJuIDA7Cn0KCm9ialtdIGFjdGlvbiBBQUJCX3Jlc29sdmUob2JqIGN1YmUxLG9ialtdIGN1YmVzKSB7CiAgICBvYmpbXSBjb2xsaXNpb25zID0gb2JqW107CiAgICBudW0gdG90YWxjb2xzaWRlID0gMDsKCWZvcihudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBjdWJlczsgaSsrKXsKICAgICAgICBudW0gY29sc2lkZSA9IDA7CiAgICAgICAgb2JqIGNvbG9iaiA9IHt9OwoKICAgICAgICBudW0gcHggPSAobnVtKSBjdWJlMS5wb3NpdGlvbi54OwogICAgICAgIG51bSBweSA9IChudW0pIGN1YmUxLnBvc2l0aW9uLnk7CiAgICAgICAgbnVtIHB6ID0gKG51bSkgY3ViZTEucG9zaXRpb24uejsKICAgICAgICBudW0gdnggPSAobnVtKSBjdWJlMS52ZWxvY2l0eS54OwogICAgICAgIG51bSB2eSA9IChudW0pIGN1YmUxLnZlbG9jaXR5Lnk7CiAgICAgICAgbnVtIHZ6ID0gKG51bSkgY3ViZTEudmVsb2NpdHkuejsKICAgICAgICAKICAgICAgICBudW0gY3N4ID0gKG51bSkgY3ViZTEuc2NhbGUueC8yOwogICAgICAgIG51bSBjc3kgPSAobnVtKSBjdWJlMS5zY2FsZS55LzI7CiAgICAgICAgbnVtIGNzeiA9IChudW0pIGN1YmUxLnNjYWxlLnovMjsKCiAgICAgICAgb2JqIHRjdWJlID0gY3ViZXNbaV07CiAgICAgICAgaWYgKG5vdEVtcHR5IChvYmopdGN1YmUuY29sbGlkZSkKICAgICAgICB7CiAgICAgICAgICAgIGlmICghKChudW0pdGN1YmUuY29sbGlkZS50eXBlICYgQUFCQl9DT0xfT0JKMlBMUlMpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjb250aW51ZTsgIyBza2lwIHRoaXMgb2JqZWN0IGlmIGl0IGlzIG5vdCBjb2xsaWRhYmxlCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgbnVtIGN4ID0gKG51bSkgdGN1YmUucG9zaXRpb24ueDsKICAgICAgICBudW0gY3kgPSAobnVtKSB0Y3ViZS5wb3NpdGlvbi55OwogICAgICAgIG51bSBjeiA9IChudW0pIHRjdWJlLnBvc2l0aW9uLno7CiAgICAgICAgbnVtIHN4ID0gKG51bSkgdGN1YmUuc2NhbGUueCAvIDI7CiAgICAgICAgbnVtIHN5ID0gKG51bSkgdGN1YmUuc2NhbGUueSAvIDI7CiAgICAgICAgbnVtIHN6ID0gKG51bSkgdGN1YmUuc2NhbGUueiAvIDI7CiAgICAgICAgbnVtIG9weCA9IHB4OwogICAgICAgIG51bSBvcHkgPSBweTsKICAgICAgICBudW0gb3B6ID0gcHo7CiAgICAgICAgbnVtIG9jeCA9IGN4OwogICAgICAgIG51bSBvY3kgPSBjeTsKICAgICAgICBudW0gb2N6ID0gY3o7CiAgICAgICAgCiAgICAgICAgaWYgKG5vdEVtcHR5IChvYmopIGN1YmUxLm9ncG9zKXsKICAgICAgICAgICAgb3B4ID0gKG51bSljdWJlMS5vZ3Bvcy54OwogICAgICAgICAgICBvcHkgPSAobnVtKWN1YmUxLm9ncG9zLnk7CiAgICAgICAgICAgIG9weiA9IChudW0pY3ViZTEub2dwb3MuejsKICAgICAgICB9IGlmIChub3RFbXB0eSAob2JqKXRjdWJlLm9ncG9zKXsKICAgICAgICAgICAgb2N4ID0gKG51bSl0Y3ViZS5vZ3Bvcy54OwogICAgICAgICAgICBvY3kgPSAobnVtKXRjdWJlLm9ncG9zLnk7CiAgICAgICAgICAgIG9jeiA9IChudW0pdGN1YmUub2dwb3MuejsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgIyAteAogICAgICAgIGlmKHB4IDw9IGN4ICsgc3ggKyBjc3ggJiYgb3B4ID49IG9jeCArIHN4ICsgY3N4ICYmIEFBQkJfc2lkZShjeiwgc3ogKyBjc3osIHB6KSA9PSAwICYmIEFBQkJfc2lkZShjeSArIHN5LCBzeSArIGNzeSwgcHkgKyBjc3kpID09IDApewogICAgICAgICAgICBpZihweSA+PSBjeSArIDIgKiBzeSAtIEFBQkJfc3QgJiYgKChib29sKSBjdWJlMS5vbkdyb3VuZCkpewogICAgICAgICAgICAgICAgY3ViZTEucG9zaXRpb24ueSA9IGN5ICsgMiAqIHN5OyAKICAgICAgICAgICAgICAgIGN1YmUxLnZlbG9jaXR5LnkgPSAobm90RW1wdHkgKG9iail0Y3ViZS52ZWxvY2l0eSkgPyAobnVtKXRjdWJlLnZlbG9jaXR5LnkgOiAwOwogICAgICAgICAgICAgICAgY3ViZTEub25Hcm91bmQgPSB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgY3ViZTEucG9zaXRpb24ueCA9IGN4ICsgc3ggKyBjc3g7CiAgICAgICAgICAgICAgICBjdWJlMS52ZWxvY2l0eS54ID0gKG5vdEVtcHR5IChvYmopdGN1YmUudmVsb2NpdHkpID8gKG51bSl0Y3ViZS52ZWxvY2l0eS54IDogMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBjdWJlMS5vbldhbGwgPSB0cnVlOwogICAgICAgICAgICBjb2xzaWRlIHw9IEFBQkJfWE5FRzsKICAgICAgICB9CiAgICAgICAgIyAreAogICAgICAgIGlmKHB4ID49IGN4IC0gc3ggLSBjc3ggJiYgb3B4IDw9IG9jeCAtIHN4IC0gY3N4ICYmIEFBQkJfc2lkZShjeiwgc3ogKyBjc3osIHB6KSA9PSAwICYmIEFBQkJfc2lkZShjeSArIHN5LCBzeSArIGNzeSwgcHkgKyBjc3kpID09IDApewogICAgICAgICAgICBpZihweSA+PSBjeSArIDIgKiBzeSAtIEFBQkJfc3QgJiYgKChib29sKSBjdWJlMS5vbkdyb3VuZCkpewogICAgICAgICAgICAgICAgY3ViZTEucG9zaXRpb24ueSA9IGN5ICsgMiAqIHN5OyAKICAgICAgICAgICAgICAgIGN1YmUxLnZlbG9jaXR5LnkgPSAobm90RW1wdHkgKG9iail0Y3ViZS52ZWxvY2l0eSkgPyAobnVtKXRjdWJlLnZlbG9jaXR5LnkgOiAwOwogICAgICAgICAgICAgICAgY3ViZTEub25Hcm91bmQgPSB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgY3ViZTEucG9zaXRpb24ueCA9IGN4IC0gc3ggLSBjc3g7CiAgICAgICAgICAgICAgICBjdWJlMS52ZWxvY2l0eS54ID0gKG5vdEVtcHR5IChvYmopdGN1YmUudmVsb2NpdHkpID8gKG51bSl0Y3ViZS52ZWxvY2l0eS54IDogMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBjdWJlMS5vbldhbGwgPSB0cnVlOwogICAgICAgICAgICBjb2xzaWRlIHw9IEFBQkJfWFBPUzsKICAgICAgICB9CiAgICAgICAgIyAteQogICAgICAgIGlmKHB5IDw9IGN5ICsgMiAqIHN5ICYmIG9weSA+PSBvY3kgKyAyICogc3kgJiYgQUFCQl9zaWRlKGN4LCBzeCArIGNzeCwgcHgpID09IDAgJiYgQUFCQl9zaWRlKGN6LCBzeiArIGNzeiwgcHopID09IDApewogICAgICAgICAgICBjdWJlMS5wb3NpdGlvbi55ID0gY3kgKyAyICogc3k7CiAgICAgICAgICAgIGN1YmUxLnZlbG9jaXR5LnkgPSAobm90RW1wdHkgKG9iail0Y3ViZS52ZWxvY2l0eSkgPyAobnVtKXRjdWJlLnZlbG9jaXR5LnkgOiAwOwogICAgICAgICAgICBjdWJlMS5vbkdyb3VuZCA9IHRydWU7CiAgICAgICAgICAgIGNvbHNpZGUgfD0gQUFCQl9ZTkVHOwogICAgICAgIH0KICAgICAgICAjICt5CiAgICAgICAgaWYocHkgKyAyICogY3N5ID49IGN5ICYmIG9weSArIDIgKiBjc3kgPD0gb2N5ICYmIEFBQkJfc2lkZShjeCwgc3ggKyBjc3gsIHB4KSA9PSAwICYmIEFBQkJfc2lkZShjeiwgc3ogKyBjc3osIHB6KSA9PSAwKXsKICAgICAgICAgICAgY3ViZTEucG9zaXRpb24ueSA9IGN5IC0gMiAqIGNzeTsKICAgICAgICAgICAgY3ViZTEudmVsb2NpdHkueSA9IChub3RFbXB0eSAob2JqKXRjdWJlLnZlbG9jaXR5KSA/IChudW0pdGN1YmUudmVsb2NpdHkueSA6IDA7CiAgICAgICAgICAgIGNvbHNpZGUgfD0gQUFCQl9ZUE9TOwogICAgICAgIH0KICAgICAgICAjIC16CiAgICAgICAgaWYocHogPD0gY3ogKyBzeiArIGNzeiAmJiBvcHogPj0gb2N6ICsgc3ogKyBjc3ogJiYgQUFCQl9zaWRlKGN4LCBzeCArIGNzeCwgcHgpID09IDAgJiYgQUFCQl9zaWRlKGN5ICsgc3ksIHN5ICsgY3N6LCBweSArIGNzeikgPT0gMCl7CiAgICAgICAgICAgIGlmKHB5ID49IGN5ICsgMiAqIHN5IC0gQUFCQl9zdCAmJiAoKGJvb2wpIGN1YmUxLm9uR3JvdW5kKSl7CiAgICAgICAgICAgICAgICBjdWJlMS5wb3NpdGlvbi55ID0gY3kgKyAyICogc3k7IAogICAgICAgICAgICAgICAgY3ViZTEudmVsb2NpdHkueSA9IChub3RFbXB0eSAob2JqKXRjdWJlLnZlbG9jaXR5KSA/IChudW0pdGN1YmUudmVsb2NpdHkueSA6IDA7CiAgICAgICAgICAgICAgICBjdWJlMS5vbkdyb3VuZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgIGN1YmUxLnBvc2l0aW9uLnogPSBjeiArIHN6ICsgY3N6OwogICAgICAgICAgICAgICAgY3ViZTEudmVsb2NpdHkueiA9IChub3RFbXB0eSAob2JqKXRjdWJlLnZlbG9jaXR5KSA/IChudW0pdGN1YmUudmVsb2NpdHkueiA6IDA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIGN1YmUxLm9uV2FsbCA9IHRydWU7CiAgICAgICAgICAgIGNvbHNpZGUgfD0gQUFCQl9aTkVHOwogICAgICAgIH0KICAgICAgICAjICt6CiAgICAgICAgaWYocHogPj0gY3ogLSBzeiAtIGNzeiAmJiBvcHogPD0gb2N6IC0gc3ogLSBjc3ogJiYgQUFCQl9zaWRlKGN4LCBzeCArIGNzeCwgcHgpID09IDAgJiYgQUFCQl9zaWRlKGN5ICsgc3ksIHN5ICsgY3N5LCBweSArIGNzeSkgPT0gMCl7CiAgICAgICAgICAgIGlmKHB5ID49IGN5ICsgMiAqIHN5IC0gQUFCQl9zdCAmJiAoKGJvb2wpIGN1YmUxLm9uR3JvdW5kKSl7CiAgICAgICAgICAgICAgICBjdWJlMS5wb3NpdGlvbi55ID0gY3kgKyAyICogc3k7IAogICAgICAgICAgICAgICAgY3ViZTEudmVsb2NpdHkueSA9IChub3RFbXB0eSAob2JqKXRjdWJlLnZlbG9jaXR5KSA/IChudW0pdGN1YmUudmVsb2NpdHkueSA6IDA7IAogICAgICAgICAgICAgICAgY3ViZTEub25Hcm91bmQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICBjdWJlMS5wb3NpdGlvbi56ID0gY3ogLSBzeiAtIGNzejsKICAgICAgICAgICAgICAgIGN1YmUxLnZlbG9jaXR5LnogPSAobm90RW1wdHkgKG9iail0Y3ViZS52ZWxvY2l0eSkgPyAobnVtKXRjdWJlLnZlbG9jaXR5LnogOiAwOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGN1YmUxLm9uV2FsbCA9IHRydWU7CiAgICAgICAgICAgIGNvbHNpZGUgfD0gQUFCQl9aUE9TOwogICAgICAgIH0KICAgICAgICBpZiAoY29sc2lkZSA+IDApewogICAgICAgICAgICBjb2xvYmogPSB0Y3ViZTsKICAgICAgICAgICAgYWRkVG8gY29sbGlzaW9ucyB7Y29sc2lkZTpjb2xzaWRlLGNvbG9iajpjb2xvYmp9OwogICAgICAgIH0gCiAgICAgICAgdG90YWxjb2xzaWRlIHw9IGNvbHNpZGU7Cgl9CiAgICBpZiAobm90RW1wdHkgKG9iailjdWJlMS5vZ3BvcykgewogICAgICAgIGN1YmUxLm9ncG9zLnggPSAobnVtKSBjdWJlMS5wb3NpdGlvbi54ICsgMDsKICAgICAgICBjdWJlMS5vZ3Bvcy55ID0gKG51bSkgY3ViZTEucG9zaXRpb24ueSArIDA7CiAgICAgICAgY3ViZTEub2dwb3MueiA9IChudW0pIGN1YmUxLnBvc2l0aW9uLnogKyAwOwogICAgfSBlbHNlIHsKICAgICAgICBjdWJlMS5vZ3BvcyA9IAogICAgICAgIHsKICAgICAgICAgICAgeDoobnVtKWN1YmUxLnBvc2l0aW9uLnggKyAwLAogICAgICAgICAgICB5OihudW0pY3ViZTEucG9zaXRpb24ueSArIDAsCiAgICAgICAgICAgIHo6KG51bSljdWJlMS5wb3NpdGlvbi56ICsgMAogICAgICAgIH07CiAgICB9CiAgICAjIEdBTUUubG9nKGNvbGxpc2lvbnMpOwogICAgcmV0dXJuIGNvbGxpc2lvbnM7CgkKfQoKb2JqW10gYWN0aW9uIEFBQkJfZGV0ZWN0KG9iaiBjdWJlMSxvYmpbXSBjdWJlcykgewogICAgb2JqW10gY29sbGlzaW9ucyA9IG9ialtdOwogICAgbnVtIHRvdGFsY29sc2lkZSA9IDA7Cglmb3IobnVtIGkgPSAwOyBpIDwgbGVuZ3RoT2YgY3ViZXM7IGkrKyl7CiAgICAgICAgbnVtIGNvbHNpZGUgPSAwOwogICAgICAgIG9iaiBjb2xvYmogPSB7fTsKCiAgICAgICAgbnVtIHB4ID0gKG51bSkgY3ViZTEucG9zaXRpb24ueDsKICAgICAgICBudW0gcHkgPSAobnVtKSBjdWJlMS5wb3NpdGlvbi55OwogICAgICAgIG51bSBweiA9IChudW0pIGN1YmUxLnBvc2l0aW9uLno7CiAgICAgICAgbnVtIHZ4ID0gKG51bSkgY3ViZTEudmVsb2NpdHkueDsKICAgICAgICBudW0gdnkgPSAobnVtKSBjdWJlMS52ZWxvY2l0eS55OwogICAgICAgIG51bSB2eiA9IChudW0pIGN1YmUxLnZlbG9jaXR5Lno7CiAgICAgICAgCiAgICAgICAgbnVtIGNzeCA9IChudW0pIGN1YmUxLnNjYWxlLngvMjsKICAgICAgICBudW0gY3N5ID0gKG51bSkgY3ViZTEuc2NhbGUueS8yOwogICAgICAgIG51bSBjc3ogPSAobnVtKSBjdWJlMS5zY2FsZS56LzI7CgogICAgICAgIG9iaiB0Y3ViZSA9IGN1YmVzW2ldOwogICAgICAgIG51bSBjeCA9IChudW0pIHRjdWJlLnBvc2l0aW9uLng7CiAgICAgICAgbnVtIGN5ID0gKG51bSkgdGN1YmUucG9zaXRpb24ueTsKICAgICAgICBudW0gY3ogPSAobnVtKSB0Y3ViZS5wb3NpdGlvbi56OwogICAgICAgIG51bSBzeCA9IChudW0pIHRjdWJlLnNjYWxlLnggLyAyOwogICAgICAgIG51bSBzeSA9IChudW0pIHRjdWJlLnNjYWxlLnkgLyAyOwogICAgICAgIG51bSBzeiA9IChudW0pIHRjdWJlLnNjYWxlLnogLyAyOwogICAgICAgIG51bSBvcHggPSBweDsKICAgICAgICBudW0gb3B5ID0gcHk7CiAgICAgICAgbnVtIG9weiA9IHB6OwogICAgICAgIG51bSBvY3ggPSBjeDsKICAgICAgICBudW0gb2N5ID0gY3k7CiAgICAgICAgbnVtIG9jeiA9IGN6OwogICAgICAgIAogICAgICAgIGlmIChub3RFbXB0eSAob2JqKSBjdWJlMS5vZ3Bvcyl7CiAgICAgICAgICAgIG9weCA9IChudW0pY3ViZTEub2dwb3MueDsKICAgICAgICAgICAgb3B5ID0gKG51bSljdWJlMS5vZ3Bvcy55OwogICAgICAgICAgICBvcHogPSAobnVtKWN1YmUxLm9ncG9zLno7CiAgICAgICAgfSBpZiAobm90RW1wdHkgKG9iail0Y3ViZS5vZ3Bvcyl7CiAgICAgICAgICAgIG9jeCA9IChudW0pdGN1YmUub2dwb3MueDsKICAgICAgICAgICAgb2N5ID0gKG51bSl0Y3ViZS5vZ3Bvcy55OwogICAgICAgICAgICBvY3ogPSAobnVtKXRjdWJlLm9ncG9zLno7CiAgICAgICAgfQogICAgICAgIAogICAgICAgICMgLXgKICAgICAgICBpZihweCA8PSBjeCArIHN4ICsgY3N4ICYmIG9weCA+PSBvY3ggKyBzeCArIGNzeCAmJiBBQUJCX3NpZGUoY3osIHN6ICsgY3N6LCBweikgPT0gMCAmJiBBQUJCX3NpZGUoY3kgKyBzeSwgc3kgKyBjc3ksIHB5ICsgY3N5KSA9PSAwKXsKICAgICAgICAgICAgaWYocHkgPj0gY3kgKyAyICogc3kgLSBBQUJCX3N0ICYmICgoYm9vbCkgY3ViZTEub25Hcm91bmQpKXsKICAgICAgICAgICAgICAgIGN1YmUxLm9uR3JvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjdWJlMS5vbldhbGwgPSB0cnVlOwogICAgICAgICAgICBjb2xzaWRlIHw9IEFBQkJfWE5FRzsKICAgICAgICB9CiAgICAgICAgIyAreAogICAgICAgIGlmKHB4ID49IGN4IC0gc3ggLSBjc3ggJiYgb3B4IDw9IG9jeCAtIHN4IC0gY3N4ICYmIEFBQkJfc2lkZShjeiwgc3ogKyBjc3osIHB6KSA9PSAwICYmIEFBQkJfc2lkZShjeSArIHN5LCBzeSArIGNzeSwgcHkgKyBjc3kpID09IDApewogICAgICAgICAgICBpZihweSA+PSBjeSArIDIgKiBzeSAtIEFBQkJfc3QgJiYgKChib29sKSBjdWJlMS5vbkdyb3VuZCkpewogICAgICAgICAgICAgICAgY3ViZTEub25Hcm91bmQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGN1YmUxLm9uV2FsbCA9IHRydWU7CiAgICAgICAgICAgIGNvbHNpZGUgfD0gQUFCQl9YUE9TOwogICAgICAgIH0KICAgICAgICAjIC15CiAgICAgICAgaWYocHkgPD0gY3kgKyAyICogc3kgJiYgb3B5ID49IG9jeSArIDIgKiBzeSAmJiBBQUJCX3NpZGUoY3gsIHN4ICsgY3N4LCBweCkgPT0gMCAmJiBBQUJCX3NpZGUoY3osIHN6ICsgY3N6LCBweikgPT0gMCl7CiAgICAgICAgICAgIGN1YmUxLm9uR3JvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgY29sc2lkZSB8PSBBQUJCX1lORUc7CiAgICAgICAgfQogICAgICAgICMgK3kKICAgICAgICBpZihweSArIDIgKiBjc3kgPj0gY3kgJiYgb3B5ICsgMiAqIGNzeSA8PSBvY3kgJiYgQUFCQl9zaWRlKGN4LCBzeCArIGNzeCwgcHgpID09IDAgJiYgQUFCQl9zaWRlKGN6LCBzeiArIGNzeiwgcHopID09IDApewogICAgICAgICAgICBjb2xzaWRlIHw9IEFBQkJfWVBPUzsKICAgICAgICB9CiAgICAgICAgIyAtegogICAgICAgIGlmKHB6IDw9IGN6ICsgc3ogKyBjc3ogJiYgb3B6ID49IG9jeiArIHN6ICsgY3N6ICYmIEFBQkJfc2lkZShjeCwgc3ggKyBjc3gsIHB4KSA9PSAwICYmIEFBQkJfc2lkZShjeSArIHN5LCBzeSArIGNzeiwgcHkgKyBjc3opID09IDApewogICAgICAgICAgICBpZihweSA+PSBjeSArIDIgKiBzeSAtIEFBQkJfc3QgJiYgKChib29sKSBjdWJlMS5vbkdyb3VuZCkpewogICAgICAgICAgICAgICAgY3ViZTEub25Hcm91bmQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGN1YmUxLm9uV2FsbCA9IHRydWU7CiAgICAgICAgICAgIGNvbHNpZGUgfD0gQUFCQl9aTkVHOwogICAgICAgIH0KICAgICAgICAjICt6CiAgICAgICAgaWYocHogPj0gY3ogLSBzeiAtIGNzeiAmJiBvcHogPD0gb2N6IC0gc3ogLSBjc3ogJiYgQUFCQl9zaWRlKGN4LCBzeCArIGNzeCwgcHgpID09IDAgJiYgQUFCQl9zaWRlKGN5ICsgc3ksIHN5ICsgY3N5LCBweSArIGNzeSkgPT0gMCl7CiAgICAgICAgICAgIGlmKHB5ID49IGN5ICsgMiAqIHN5IC0gQUFCQl9zdCAmJiAoKGJvb2wpIGN1YmUxLm9uR3JvdW5kKSl7CiAgICAgICAgICAgICAgICBjdWJlMS5vbkdyb3VuZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY3ViZTEub25XYWxsID0gdHJ1ZTsKICAgICAgICAgICAgY29sc2lkZSB8PSBBQUJCX1pQT1M7CiAgICAgICAgfQogICAgICAgIGlmIChjb2xzaWRlID4gMCl7CiAgICAgICAgICAgIGNvbG9iaiA9IHRjdWJlOwogICAgICAgICAgICBhZGRUbyBjb2xsaXNpb25zIHtjb2xzaWRlOmNvbHNpZGUsY29sb2JqOmNvbG9ian07CiAgICAgICAgfSAKICAgICAgICB0b3RhbGNvbHNpZGUgfD0gY29sc2lkZTsKCX0KICAgIGlmIChub3RFbXB0eSAob2JqKWN1YmUxLm9ncG9zKSB7CiAgICAgICAgY3ViZTEub2dwb3MueCA9IChudW0pIGN1YmUxLnBvc2l0aW9uLnggKyAwOwogICAgICAgIGN1YmUxLm9ncG9zLnkgPSAobnVtKSBjdWJlMS5wb3NpdGlvbi55ICsgMDsKICAgICAgICBjdWJlMS5vZ3Bvcy56ID0gKG51bSkgY3ViZTEucG9zaXRpb24ueiArIDA7CiAgICB9IGVsc2UgewogICAgICAgIGN1YmUxLm9ncG9zID0gCiAgICAgICAgewogICAgICAgICAgICB4OihudW0pY3ViZTEucG9zaXRpb24ueCArIDAsCiAgICAgICAgICAgIHk6KG51bSljdWJlMS5wb3NpdGlvbi55ICsgMCwKICAgICAgICAgICAgejoobnVtKWN1YmUxLnBvc2l0aW9uLnogKyAwCiAgICAgICAgfTsKICAgIH0KICAgICMgR0FNRS5sb2coY29sbGlzaW9ucyk7CiAgICByZXR1cm4gY29sbGlzaW9uczsKCQp9CgoKb2JqW10gYWN0aW9uIEFBQkJfcmVzb2x2ZXBscihvYmogcGxyLGJvb2wgY3JvdWNoLG9ialtdIGN1YmVzKXsKICAgIGlmIChjcm91Y2gpewogICAgICAgIHBsci5zY2FsZSA9IAogICAgICAgIHsKICAgICAgICAgICAgeDpBQUJCX3csCiAgICAgICAgICAgIHk6QUFCQl9jLAogICAgICAgICAgICB6OkFBQkJfdwogICAgICAgIH07CiAgICB9IGVsc2UgewogICAgICAgIHBsci5zY2FsZT0KICAgICAgICB7CiAgICAgICAgICAgIHg6QUFCQl93LAogICAgICAgICAgICB5OkFBQkJfSCwKICAgICAgICAgICAgejpBQUJCX3cKICAgICAgICB9OwogICAgfQogICAgcmV0dXJuIEFBQkJfcmVzb2x2ZShwbHIsY3ViZXMpOwp9CgphY3Rpb24gQUFCQl9vblBsYXllclNwYXduKHN0ciBpZCkgewogICAgb2JqIHBsciA9IEdBTUUuUExBWUVSUy5maW5kQnlJRChpZCk7CiAgICBwbHIuc2NhbGUgPSB7eDpBQUJCX3cseTpBQUJCX3csejpBQUJCX0h9Owp9CgojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIyBIZWFkZXI6IFxsaWJzXGZsb2F0XGR0eXBlcy5rcm5rCiMgQXV0aG9yOiBibGFuZHJpY2UKIyAgIERlc2NyaXB0aW9uOiBjdXN0b20gZmxvYXQgZGF0YSB0eXBlcy0tPiBiaW5hcnkgcmVwcmVzZW50YXRpb24gY2FsY3VsYXRpb25zLgojICAgR29hbCB3YXMgdG8gcGFjayBmbG9hdCBkYXRhIGludG8gMTYtYml0cyBhbmQgc2VuZCBvdmVyIE5ldHdvcmtNZXNzYWdlIAojICAgKG11Y2ggc21hbGxlciB0aGFuIEFTQ0lJIHN0cmluZyByZXByZXNlbnRhdGlvbikKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Cm51bSBhY3Rpb24gZHR5cGVzX2ZpbmRNU0JMb2MobnVtIHYpewoJIyB2IGJldHRlciBiZSBhbiBpbnRlZ2VyIHUgZHVtYm8KCW51bSByID0gLTE7CgkjIHYgPSB2ID4+IDE7Cgl3aGlsZSAodiA+IDApIHsKCQlyKys7CgkJdiA9IHYgPj4gMTsKCX0KCXJldHVybiByOwp9Cm51bSBhY3Rpb24gZHR5cGVzX2Ztb2QobnVtIHgsIG51bSByKXsKCXJldHVybiB4IC0gKHIqTWF0aC5mbG9vcih4IC8gcikpOwkKfQpzdHIgYWN0aW9uIGR0eXBlc19wcmludEJpbmFyeShudW0gZil7CglzdHIgcmV0c3RyID0gIiI7Cglmb3IgKG51bSBpID0gMzItMTsgaSA+PSAwOyBpLS0pIHsKCQlyZXRzdHIgKz0gdG9TdHIgKGYgPj4gaSAmIDB4MSk7Cgl9CglyZXR1cm4gcmV0c3RyOwp9Cm51bSBhY3Rpb24gZHR5cGVzX29uZXMobnVtIGYpewoJbnVtIHJldG51bSA9IDA7Cglmb3IgKG51bSBpID0gMDsgaSA8IGY7IGkrKyl7CgkJcmV0bnVtID0gKHJldG51bSA8PCAxKSB8IDE7Cgl9CglyZXR1cm4gcmV0bnVtOwkKfQoKCiMgYWRhcHRlZCBmcm9tIElFRUUgNzU0IFN0YW5kYXJkIGZvciBTaW5nbGUgUHJlY2lzaW9uIDMyIGJpdCBmbG9hdGluZwojIGJ1dCBhbGxvd3MgZm9yIHlvdSB0byBzZWxlY3QgIyBvZiBleHBvbmVudCAvIG1hbnRpc3NhIGJpdHMKIyBoYWxmLXByZWNpc2lvbiAoMTYgYml0KSwgc2luZ2xlLXByZWNpc2lvbiAoMzIgYml0KQojIG51bSBkdHlwZXNfTUFYX0JJVFMgPSAzMjsgbnVtIEJJVFNfRVhQID0gODsKbnVtIGR0eXBlc19NQVhfQklUUyA9IDE2OyBudW0gQklUU19FWFAgPSA1OyAKI2Rvbid0IGNoYW5nZSB0byBzb21ldGhpbmcgbGlrZSAxNi0zLi4gZXJyb3IgdXAgdG8gMzAgdW5pdHMgb2JzZXJ2ZWQKCiMgKGUuZy4gMzItYml0KSBmcm9tIGxlZnQgdG8gcmlnaHQ6CiMgMSBiaXQgLSBTaWduIGJpdCAoMidzIGNvbXBsZW1lbnQpICs9ICgtMSkgKiAyXnBsYWNlIGluIGV4cG9uZW50CiMgOCBiaXRzIC0gRXhwb25lbnQgKDJeZSkKIyAyMyBiaXRzIC0gTWFudGlzc2EgKHBhcnQgYWZ0ZXIgZGVjaW1hbCkKIyByYW5nZSA9IDJeQklUU19FWFAgCiMgcHJlY2lzaW9uID0gMS8oMl5kdHlwZXNfQklUU19NQU5UKQoKbnVtIGR0eXBlc19CSUFTID0gMioqKEJJVFNfRVhQLTEpLTE7Cm51bSBkdHlwZXNfQklUU19NQU5UID0gZHR5cGVzX01BWF9CSVRTIC0gMSAtIEJJVFNfRVhQOwpudW0gZHR5cGVzX1NJR05fTE9DID0gZHR5cGVzX01BWF9CSVRTLTE7CgpudW0gYWN0aW9uIGR0eXBlc19udW1Ub0Zsb2F0MTYobnVtIGRhdGEpIHsKCSMgMS4gZGV0ZXJtaW5lIHRoZSBzaWduIGJpdAoJbnVtIHNpZ25iaXQgPSAwOwoJaWYgKGRhdGEgPCAwKSB7c2lnbmJpdCA9IDE7IGRhdGEgPSAtZGF0YTt9CiAgICBpZiAoZGF0YSA9PSAwKSB7cmV0dXJuIDA7fQoJIyAyLiBDb252ZXJ0ICB3aG9sZSAvIGRlY2ltYWwgYml0cyB0byBwdXJlIGJpbmFyeQoJbnVtIHdob2xlID0gTWF0aC5mbG9vcihkYXRhKTsgIyBmbG9vciBpdCBzbyBpdCdzIGp1c3QgYW4gaW50ZWdlciAod2lsbCBiZSBiZXR3ZWVuIDAgYW5kIDJeYml0c2V4cCkuIG1heCBpcyB0aGUgMiBeIGJpdHMgb2YgdGhlIGV4cG9uZW50CgludW0gZGVjaW1hbCA9IChkYXRhIC0gd2hvbGUgPiAwKSA/IGRhdGEgLSB3aG9sZSA6IDA7CgludW0gZGVjYml0ID0gMHgwMDA7IAoJZm9yIChudW0gaSA9IDA7IGkgPCBkdHlwZXNfQklUU19NQU5UOyBpKyspeyAjIGNvbnZlcnQgZGVjaW1hbHMgaW50byBiaW5hcnkKCQlkZWNpbWFsICo9IDI7CgkJbnVtIHRkZWNiaXQgPSAoZGVjaW1hbCA+PSAxID8gMSA6IDApOwoJCWRlY2JpdCB8PSAgdGRlY2JpdCA8PCAoZHR5cGVzX0JJVFNfTUFOVC0xLWkpOyAjIDEyIC0gaSAKCQlpZiAoZGVjaW1hbCA+PSAxKSB7ZGVjaW1hbCAtPTE7fQoJfQoJCSMgR0FNRS5sb2coImRlY2JpdCIsZHR5cGVzX3ByaW50QmluYXJ5KGRlY2JpdCkpOwoKCW51bSBwdXJiaW5hcnkgPSAod2hvbGUgPDwgZHR5cGVzX0JJVFNfTUFOVCkgfCBkZWNiaXQ7CgkJIyBHQU1FLmxvZygicHVyYmluYXJ5IixkdHlwZXNfcHJpbnRCaW5hcnkocHVyYmluYXJ5KSk7CgkJIyBHQU1FLmxvZygiZHR5cGVzX2ZpbmRNU0JMb2MocHVyYmluYXJ5KSIsZHR5cGVzX2ZpbmRNU0JMb2MocHVyYmluYXJ5KSk7CgkKCSMgMy4gbm9ybWFsaXplIHRvIGRldGVybWluZSBtYW50aXNzYSBhbmQgdW5iaWFzZWQgZXhwb25lbnQKCW51bSB1bmJpYXNlZGV4cCA9IGR0eXBlc19maW5kTVNCTG9jKHB1cmJpbmFyeSkgLSBkdHlwZXNfQklUU19NQU5UOwoJCSMgR0FNRS5sb2coInVuYmlhc2VkZXhwIix1bmJpYXNlZGV4cCk7CgkjIDQuIGRldGVybWluZSBiaWFzZWQgZXhwb25lbnQKCW51bSBiaWFzZWRleHAgPSB1bmJpYXNlZGV4cCArIGR0eXBlc19CSUFTOwoJIyA1LiByZW1vdmUgbGVhZGluZyAxIChNU0IpCgkJIyBhbGlnbiBmaXJzdAoJbnVtIG1hbnRpc3NhID0gcHVyYmluYXJ5OwoJbnVtIGFsaWdubWFudGlzc2EgPSAoZHR5cGVzX0JJVFNfTUFOVC0xKS1kdHlwZXNfZmluZE1TQkxvYyhtYW50aXNzYSk7CglpZiAoYWxpZ25tYW50aXNzYSA+IDApIHsKCQltYW50aXNzYSA9IG1hbnRpc3NhIDw8IGFsaWdubWFudGlzc2E7Cgl9IGVsc2UgewoJCW1hbnRpc3NhID0gbWFudGlzc2EgPj4gKC0xICogYWxpZ25tYW50aXNzYSk7Cgl9CgltYW50aXNzYSA9IChtYW50aXNzYSBeICgxIDw8IChkdHlwZXNfZmluZE1TQkxvYyhtYW50aXNzYSkpKSkgPDwgMTsgIyByZW1vdmUgbGVhZGluZyAxCgkJIyBHQU1FLmxvZygibWFudGlzc2E6IixkdHlwZXNfcHJpbnRCaW5hcnkobWFudGlzc2EpKTsKCQkjIEdBTUUubG9nKCJsZWZ0LXNoaWZ0IGJ5OiIsYWxpZ25tYW50aXNzYSk7CQoJbnVtIGZsb2F0MTYgPSAoc2lnbmJpdCA8PCBkdHlwZXNfU0lHTl9MT0MpIHwgKGJpYXNlZGV4cCA8PCBkdHlwZXNfQklUU19NQU5UKSB8ICggbWFudGlzc2EgKTsKCXJldHVybiBmbG9hdDE2Owp9CgpudW0gYWN0aW9uIGR0eXBlc19mbG9hdDE2VG9OdW0obnVtIGYpIHsKCWlmIChmID09IDApIHtyZXR1cm4gMDt9CiAgICAjIERldGVybWluZSBzaWduCgludW0gc2lnbiA9ICgoKGYgPj4gZHR5cGVzX1NJR05fTE9DKSAmIDB4MSkgPiAwKSA/IC0xIDogMTsKCSMgRGV0ZXJtaW5lIGV4cG9uZW50IDIqZSAKCW51bSBleHAgPSAoZiA+PiBkdHlwZXNfQklUU19NQU5UKSAmIGR0eXBlc19vbmVzKEJJVFNfRVhQKTsgCglleHAgLT0gZHR5cGVzX0JJQVM7CgkjIENvbnZlcnQgbWFudGlzc2EgdG8gZGVuYXJ5CgludW0gbWFudGlzc2EgPSBmICYgZHR5cGVzX29uZXMoZHR5cGVzX0JJVFNfTUFOVCk7CgkjIEdBTUUubG9nKCJtYW50aXNzYTogIiwgZHR5cGVzX3ByaW50QmluYXJ5KG1hbnRpc3NhKSk7CgludW0gbWFudGRlbiA9IDA7Cglmb3IgKG51bSBpID0gZHR5cGVzX2ZpbmRNU0JMb2MobWFudGlzc2EpOyBpID49MCA7IGktLSkgewoJCW51bSB0bWFuID0gMS8oMioqKGR0eXBlc19CSVRTX01BTlQtaSkpICogKChtYW50aXNzYSA+PiBpKSAmIDB4MSk7CgkJbWFudGRlbiArPSB0bWFuOwoJCQoJfQoJbWFudGRlbiArPSAxOyAjIGFkZCAxIGJhY2sgCgludW0gUmFkID0gc2lnbiAqIG1hbnRkZW4gKiAoMiAqKiBleHApOwoJcmV0dXJuIFJhZDsKfQoKbnVtIGFjdGlvbiBkdHlwZXNfbnVtVG9VaW50MTYobnVtIHgpewoJcmV0dXJuICh4ICYgMHhGRkZGKTsgIyBjYXAgNjU1MzYgCn0KCm51bSBhY3Rpb24gZHR5cGVzX251bVRvSW50MTYobnVtIHgpewoJIyByZXR1cm4gKHggJiAweEZGKTsgIyBjYXAgNjU1MzYgCgludW0gcmV0bnVtID0gMDsKCXggPSBNYXRoLnJvdW5kKHgpOwoJeCA9ICh4ID4gMzI3NjcpID8gMzI3NjcgOiB4OwoJeCA9ICh4IDwgLTMyNzY3KSA/IC0zMjc2NyA6IHg7CgkjIGNhcCB0byBsYXJnZXN0IC8gc21hbGxlc3QgaW50IHNpemUKCgludW0gc2lnbiA9IHggPCAwID8gMSA6IDA7CgoJaWYgKHNpZ24gPT0gMSkgewoJCXggPSAteDsKCX0KCXJldG51bSB8PSBzaWduIDw8IDE1OwoKCW51bSBpID0gMTQ7ICMgMTUgLSAxCgl3aGlsZSAoeCA+IDApIHsKCQlpZiAoeCAvICgyKippKSA+PSAxKSB7CgkJCXJldG51bSB8PSAgKDEgPDwgaSk7CgkJCXgtPSAoMioqaSk7CgkJfQoJCWktLTsKCX0KCXJldHVybiByZXRudW07Cn0KCm51bVtdIGFjdGlvbiBkdHlwZXNfbnVtVG9fdWludDE2Qnl0ZUFycmF5KG51bSBkYXRhKSB7CglkYXRhID0gTWF0aC5yb3VuZChkYXRhKTsKCW51bVtdIHJldEFycmF5ID0gbnVtW107CglhZGRUbyByZXRBcnJheSAoZGF0YSA+PiA4KSAmIDB4ZmY7CglhZGRUbyByZXRBcnJheSAoZGF0YSA+PiAwKSAmIDB4ZmY7CgkKCXJldHVybiByZXRBcnJheTsKCn0KCm51bSBhY3Rpb24gZHR5cGVzX21lcmdlMkJ5dGVzKG51bSBhLG51bSBiKSB7CglyZXR1cm4gKGIgPDwgOCkgfCBhOwp9CgpudW0gYWN0aW9uIGR0eXBlc19JbnQxNlRvTnVtKG51bSBiaW4pIHsKCSMgbnVtIGJpbiA9IChiIDw8IDB4ZmYpIHwgYTsKCW51bSBzaWduID0gKChiaW4gJiAweDgwMDApID4gMCkgPyAtMSA6IDE7CgludW0gZGVuYXJ5ID0gYmluICYgMHg3RkZGOwoKCXJldHVybiBzaWduICogZGVuYXJ5Owp9CgojIGludCBOdW1iZXJzIHRvIGJ5dGUgYXJyYXkKbnVtW10gYWN0aW9uIGR0eXBlc19pbnQxNnRvQnl0ZUFycmF5KG51bSBkYXRhKXsKCXJldHVybiBudW1bKChkYXRhID4+IDApICYgMHhmZiksKGRhdGEgPj4gOCkgJiAweGZmXTsKfQoKbnVtW10gYWN0aW9uIGR0eXBlc19pbnQzMnRvQnl0ZUFycmF5KG51bSBkYXRhKXsKCW51bVtdIHJldGFyciA9IG51bVtdOwoJYWRkVG8gcmV0YXJyIChkYXRhID4+IDApICYgMHhmZjsgCglhZGRUbyByZXRhcnIgKGRhdGEgPj4gOCkgJiAweGZmOyAKCWFkZFRvIHJldGFyciAoZGF0YSA+PiAxNikgJiAweGZmOyAKCWFkZFRvIHJldGFyciAoZGF0YSA+PiAyNCkgJiAweGZmOyAKCXJldHVybiByZXRhcnI7Cn0KCm51bVtdIGFjdGlvbiBkdHlwZXNfQ29sb3JUb0J5dGVBcnJheShudW0gY29sb3IpIHsKCW51bVtdIHJldEFycmF5ID0gbnVtW107CglhZGRUbyByZXRBcnJheSAoY29sb3IgPj4gMCkgJiAweGZmOwoJYWRkVG8gcmV0QXJyYXkgKGNvbG9yID4+IDgpICYgMHhmZjsKCWFkZFRvIHJldEFycmF5IChjb2xvciA+PiAxNikgJiAweGZmOwoJCglyZXR1cm4gcmV0QXJyYXk7Cn0KCnN0ciBkdHlwZXNfYWxwaGFiZXQgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkhIyQlJigpKissLi86Ozw9Pj9AW11eX2B7fH1+LSI7CgojIFJlY3Vyc2lvbiBkdWUgdG8gbG9vcCBsaW1pdHMKbnVtIGFjdGlvbiBkdHlwZXNfZ2V0VmFsdWUoc3RyIGMsIG51bSBpbmRleCkgewoJaWYoaW5kZXggPj0gbGVuZ3RoT2YgZHR5cGVzX2FscGhhYmV0KSB7CgkJcmV0dXJuIC0xOwoJfQoJCglpZihkdHlwZXNfYWxwaGFiZXRbaW5kZXhdID09IGMpIHsKCQlyZXR1cm4gaW5kZXg7Cgl9CgkKCXJldHVybiBkdHlwZXNfZ2V0VmFsdWUoYywgaW5kZXggKyAxKTsKfQoKbnVtW10gYWN0aW9uIGR0eXBlc19zdHJ0b0J5dGVBcnJheShzdHIgcyl7CgludW1bXSByZXRBcnJheSA9IG51bVtdOwoJZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBzOyBpKyspewoJCWFkZFRvIHJldEFycmF5IGR0eXBlc19nZXRWYWx1ZShzW2ldLDApOwoJfQoJcmV0dXJuIHJldEFycmF5Owp9CgpzdHIgYWN0aW9uIGR0eXBlc19CeXRlQXJyYXlUb1N0cihudW1bXSBiKXsKCXN0ciBzID0gIiI7Cglmb3IgKG51bSBpID0gMDsgaSA8IGxlbmd0aE9mIGI7IGkrKyl7CgkJaWYgKGJbaV0gPj0wKQoJCXsKCQkJcyArPSBkdHlwZXNfYWxwaGFiZXRbYltpXV07CQoJCX0KCX0KCXJldHVybiBzOwp9CgpzdHJbXSBkdHlwZXNfbG9va3VwID0gc3RyWyIwIiwiMSIsIjIiLCIzIiwiNCIsIjUiLCI2IiwiNyIsIjgiLCI5IiwiQSIsIkIiLCJDIiwiRCIsIkUiLCJGIl07CgpzdHIgYWN0aW9uIGR0eXBlc19udW0yaGV4c3RyaW5nKG51bSBuKXsKCXN0ciBoZXhzdHIgPSAiIjsKCWZvciAobnVtIGkgPTA7IGkgPCA2OyBpKyspewoJCWhleHN0ciA9IGR0eXBlc19sb29rdXBbbiAmIDB4Rl0gKyBoZXhzdHI7CgkJbiA9IG4gPj4gNDsKCX0KCXJldHVybiBoZXhzdHI7Cn0KCm51bSBhY3Rpb24gZHR5cGVzX2hleHN0cmluZzJudW0oc3RyIGgpewoJbnVtIG4gPSAwOwoJaCA9IFVUSUxTLnRvVXBwZXIoaCk7Cglmb3IgKG51bSBpID0gMDsgaSA8IGxlbmd0aE9mIGg7IGkrKyl7CgkJZm9yIChudW0gaiA9IDA7IGogPCBsZW5ndGhPZiBkdHlwZXNfbG9va3VwOyBqKyspewoJCQlpZiAoZHR5cGVzX2xvb2t1cFtqXSA9PSBoW2ldKXsKCQkJCW4gfD0gaiA8PCAobGVuZ3RoT2YgaCAtIDEgLSBpKSo0OwoJCQkJYnJlYWs7CgkJCX0KCQl9Cgl9CglyZXR1cm4gbjsKfQoKbnVtIGFjdGlvbiBkdHlwZXNfY29uc3RyYWluUmFkaWFucyhudW0geCl7Cgl4ID0gZHR5cGVzX2Ztb2QoeCxNYXRoLlBJMik7CglpZiAoeCA8IDApewoJCXggKz0gMzYwOwoJfQogICAgcmV0dXJuIHg7Cn0KCgojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIyBIZWFkZXI6IGI5MWVuY29kaW5nXGI5MS5rcm5rCiMgQXV0aG9yOiBTbHhUblQKIyBEZXNjcmlwdGlvbjogQmFzZTkxIGRlY29kaW5nIGNvbnZlcnRlZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9LdmFuVFRUL0Jhc2VOY29kaW5nCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCm9iaiBiOTFfYmFzZTkxID0gewogICAgYWxwaGFiZXQ6ICJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSEjJCUmKCkqKywuLzo7PD0+P0BbXV5fYHt8fX4tIgp9OwoKIyBSZWN1cnNpb24gZHVlIHRvIGxvb3AgbGltaXRzCm51bSBhY3Rpb24gYjkxX2dldFZhbHVlKHN0ciBjLCBudW0gaW5kZXgpIHsKCWlmKGluZGV4ID49IGxlbmd0aE9mIGI5MV9iYXNlOTEuYWxwaGFiZXQpIHsKCQlyZXR1cm4gLTE7Cgl9CgkKCWlmKChzdHIpYjkxX2Jhc2U5MS5hbHBoYWJldFtpbmRleF0gPT0gYykgewoJCXJldHVybiBpbmRleDsKCX0KCQoJcmV0dXJuIGI5MV9nZXRWYWx1ZShjLCBpbmRleCArIDEpOwp9CgpudW1bXSBhY3Rpb24gYjkxX2RlY29kZShzdHIgZGF0YSkgewogICAgbnVtIGR2ID0gLTE7CiAgICBudW0gZG4gPSAwOwogICAgbnVtIGRicSA9IDA7CiAgICBudW1bXSByZXN1bHQgPSBudW1bXTsKCiAgICBmb3IobnVtIGkgPSAwOyBpIDwgbGVuZ3RoT2YgZGF0YTsgaSsrKSB7CiAgICAgICAgbnVtIGl2ID0gYjkxX2dldFZhbHVlKGRhdGFbaV0sIDApOwoKICAgICAgICBpZihpdiA9PSAtMSkgeyBjb250aW51ZTsgfQoKICAgICAgICBpZihkdiA9PSAtMSkgewogICAgICAgICAgICBkdiA9IGl2OyAKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGR2ICs9IGl2ICogOTE7CiAgICAgICAgICAgIGRicSB8PSAoZHYgPDwgZG4pOwoKICAgICAgICAgICAgaWYoKGR2ICYgODE5MSkgPiA4OCkgewogICAgICAgICAgICAgICAgZG4gKz0gMTM7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBkbiArPSAxNDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBkbyAuLi4gd2hpbGU/CiAgICAgICAgICAgIGJvb2wgZmlyc3QgPSB0cnVlOwoKICAgICAgICAgICAgd2hpbGUoZmlyc3QgfHwgZG4gPiA3KSB7CiAgICAgICAgICAgICAgICBhZGRUbyByZXN1bHQgZGJxICUgMjU2OwogICAgICAgICAgICAgICAgZGJxID4+Pj0gODsKICAgICAgICAgICAgICAgIGRuIC09IDg7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGZpcnN0ID0gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGR2ID0gLTE7CiAgICAgICAgfQogICAgfQoKCWlmKGR2ICE9IC0xKSB7CgkJYWRkVG8gcmVzdWx0IChkYnEgfCBkdiA8PCBkbikgJiAyNTU7Cgl9CgoJcmV0dXJuIHJlc3VsdDsKfQoKIyBCZWluZyB1c2VkIHNlcnZlci1zaWRlCnN0ciBhY3Rpb24gYjkxX2VuY29kZShudW1bXSBkYXRhKSB7CiAgICBudW0gZW4gPSAwOwogICAgbnVtIGVicSA9IDA7CiAgICBzdHIgcmVzdWx0ID0gIiI7CgoJZm9yKG51bSBpID0gMDsgaSA8IGxlbmd0aE9mIGRhdGE7IGkrKykgewoJCWVicSB8PSAoZGF0YVtpXSAmIDI1NSkgPDwgZW47CgkJZW4gKz0gODsKCQkKCQlpZihlbiA+IDEzKSB7CgkJCW51bSBldiA9IGVicSAmIDgxOTE7CgkJCQoJCQlpZihldiA+IDg4KSB7CgkJCQllYnEgPj4+PSAxMzsKCQkJCWVuIC09IDEzOwoJCQl9CgkJCWVsc2UgewoJCQkJZXYgPSBlYnEgJiAxNjM4MzsKCQkJCWVicSA+Pj49IDE0OwoJCQkJZW4gLT0gMTQ7CgkJCX0KCQkJCgkJCW51bSBxdW90aWVudCA9IE1hdGguZmxvb3IoZXYgLyA5MSk7CgkJCW51bSByZW1haW5kZXIgPSBldiAlIDkxOwoJCQoJCQlyZXN1bHQgKz0gKHN0ciliOTFfYmFzZTkxLmFscGhhYmV0W3JlbWFpbmRlcl07CgkJCXJlc3VsdCArPSAoc3RyKWI5MV9iYXNlOTEuYWxwaGFiZXRbcXVvdGllbnRdOwoJCX0KCX0KCglpZihlbiA+IDApIHsKCQkJbnVtIHF1b3RpZW50ID0gTWF0aC5mbG9vcihlYnEgLyA5MSk7CgkJCW51bSByZW1haW5kZXIgPSBlYnEgJSA5MTsKCgkJCXJlc3VsdCArPSAoc3RyKWI5MV9iYXNlOTEuYWxwaGFiZXRbcmVtYWluZGVyXTsKCgkJCWlmKGVuID4gNyB8fCBlYnEgPiA5MCkgewoJCQkJcmVzdWx0ICs9IChzdHIpYjkxX2Jhc2U5MS5hbHBoYWJldFtxdW90aWVudF07CgkJCX0KCX0KCglyZXR1cm4gcmVzdWx0Owp9CiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojIGhlYWRlcjogXGxpYnNcc3luY29ianNcc3luY29ianNfaC5rcm5rCiMgQXV0aG9yOiBibGFuZHJpY2UKIyAgIERlc2NyaXB0aW9uOiBub3QgcmVhZHkhCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKIyBjb250ZW50czEKbnVtIHN5bmNvYmpzX2hfZUhFQUxUSCA9IDB4MDE7Cm51bSBzeW5jb2Jqc19oX2VQT1NJVElPTiA9IDB4MDI7Cm51bSBzeW5jb2Jqc19oX2VST1RBVElPTiA9IDB4MDQ7Cm51bSBzeW5jb2Jqc19oX2VTQ0FMRSA9IDB4MDg7Cm51bSBzeW5jb2Jqc19oX2VUWVBFID0gMHgxMDsKbnVtIHN5bmNvYmpzX2hfZVRFWFRVUkUgPSAweDIwOwpudW0gc3luY29ianNfaF9lQ09MT1IgPSAweDQwOwpudW0gc3luY29ianNfaF9lRU1JU1NJVkUgPSAweDgwOwojIGNvbnRlbnRzMgpudW0gc3luY29ianNfaF9lQ09MTElTSU9OID0gMHgwMTsKCiMgZ2VvbWV0cnkgdHlwZXMKbnVtIHN5bmNvYmpzX2hfR0VPX0NVQkUgPSAwOwpudW0gc3luY29ianNfaF9HRU9fU1BIRVJFID0gMTsKbnVtIHN5bmNvYmpzX2hfR0VPX0NZTElOREVSID0gMjsKbnVtIHN5bmNvYmpzX2hfR0VPX1JPVENVQkUgPSAzOwpudW0gc3luY29ianNfaF9HRU9fQ09NUExFWENPTCA9IDQ7CgojIHJlc29sdmUgdHlwZXMKbnVtIHN5bmNvYmpzX2hfUkVTX1NUT1AgPSAwOyAjIHN0b3AgbW92ZW1lbnQKCiMgQmluYXJ5IGRlY29kaW5nIG9mIGFuIGFycmF5IG9mIGJ5dGVzIHRvIE9iamVjdHMKb2JqIGFjdGlvbiBzeW5jb2Jqc19oX2J5dGVBcnJheVRvT2JqcyhudW1bXSBieXRlQXJyYXkpIHsKCW9ialtdIG9iamxpc3QgPSBvYmpbXTsKCW51bVtdIGRlbExpc3QgPSBudW1bXTsKCW51bSBpID0gMDsgIyBwYyBpbiBhcnJheQoJbnVtIHRvdGFsb2JqcyA9IDA7CgludW0gdG90YWxkZWxvYmpzID0gMDsKCWlmIChsZW5ndGhPZiBieXRlQXJyYXkgPj0yKQoJewogICAgICAgIHRvdGFsb2JqcyA9IGJ5dGVBcnJheVswXTsKICAgICAgICBpKys7CgkJdG90YWxkZWxvYmpzID0gYnl0ZUFycmF5WzFdOwoJCWkrKzsKICAgIH0gZWxzZQoJewogICAgICAgIHJldHVybiB7b2JqbGlzdDpvYmpsaXN0LGRlbExpc3Q6ZGVsTGlzdH07CiAgICB9CgkKCWZvciAobnVtIGogPSAwOyBqIDwgdG90YWxvYmpzOyBqKyspewoJCW9iaiB0b2JqID0ge307CgkJIyBjb250ZW50cyBieXRlCgkJbnVtIGNvbnRlbnRzMSA9IGJ5dGVBcnJheVtpXTsKCQludW0gY29udGVudHMyID0gYnl0ZUFycmF5W2krMV07CgkJaSs9MjsKCQkjIG9iamVjdCBpZCAyIGJ5dGVzCgkJdG9iai5vYmppZCA9IGR0eXBlc19tZXJnZTJCeXRlcyhieXRlQXJyYXlbaV0sYnl0ZUFycmF5W2krMV0pOwoJCWkrPTI7CgkJIyA0IGJ5dGVzIGhlYWx0aCAvIGZ1bGxoZWFsdGgKCQlpZiAoKGNvbnRlbnRzMSAmIHN5bmNvYmpzX2hfZUhFQUxUSCkgPiAwKSB7CgkJCXRvYmouaGVhbHRoID0gZHR5cGVzX21lcmdlMkJ5dGVzKGJ5dGVBcnJheVtpXSxieXRlQXJyYXlbaSsxXSk7CgkJCXRvYmouZmhlYWx0aCA9IGR0eXBlc19tZXJnZTJCeXRlcyhieXRlQXJyYXlbaSsyXSxieXRlQXJyYXlbaSszXSk7CgkJCWkrPSA0OwoJCX0KCQkjIDYgYnl0ZXMgcG9zaXRpb24KCQlpZiAoKGNvbnRlbnRzMSAmIHN5bmNvYmpzX2hfZVBPU0lUSU9OKSA+IDApewoJCQl0b2JqLnBvc2l0aW9uID0gewoJCQkJeCA6IGR0eXBlc19JbnQxNlRvTnVtKGR0eXBlc19tZXJnZTJCeXRlcyhieXRlQXJyYXlbaV0sYnl0ZUFycmF5W2krMV0pKSwKCQkJCXkgOiBkdHlwZXNfSW50MTZUb051bShkdHlwZXNfbWVyZ2UyQnl0ZXMoYnl0ZUFycmF5W2krMl0sYnl0ZUFycmF5W2krM10pKSwKCQkJCXogOiBkdHlwZXNfSW50MTZUb051bShkdHlwZXNfbWVyZ2UyQnl0ZXMoYnl0ZUFycmF5W2krNF0sYnl0ZUFycmF5W2krNV0pKQoJCQl9OwoJCQlpKz0gNjsKCQl9CgkJIyA2IGJ5dGVzIHJvdGF0aW9uCgkJaWYgKChjb250ZW50czEgJiBzeW5jb2Jqc19oX2VST1RBVElPTikgPiAwKSB7CgkJCXRvYmoucm90YXRpb24gPXsKCQkJCXg6IGR0eXBlc19mbG9hdDE2VG9OdW0oZHR5cGVzX21lcmdlMkJ5dGVzKGJ5dGVBcnJheVtpXSxieXRlQXJyYXlbaSsxXSkpLAoJCQkJeTogZHR5cGVzX2Zsb2F0MTZUb051bShkdHlwZXNfbWVyZ2UyQnl0ZXMoYnl0ZUFycmF5W2krMl0sYnl0ZUFycmF5W2krM10pKSwKCQkJCXo6IGR0eXBlc19mbG9hdDE2VG9OdW0oZHR5cGVzX21lcmdlMkJ5dGVzKGJ5dGVBcnJheVtpKzRdLGJ5dGVBcnJheVtpKzVdKSkKCQkJfTsKCQkJaSs9IDY7CgkJfQoJCSMgNiBieXRlcyBzY2FsZQoJCWlmICgoY29udGVudHMxICYgc3luY29ianNfaF9lU0NBTEUpID4gMCkgewoJCQl0b2JqLnNjYWxlID0gewoJCQkJeDogZHR5cGVzX0ludDE2VG9OdW0oZHR5cGVzX21lcmdlMkJ5dGVzKGJ5dGVBcnJheVtpXSxieXRlQXJyYXlbaSsxXSkpLAoJCQkJeTogZHR5cGVzX0ludDE2VG9OdW0oZHR5cGVzX21lcmdlMkJ5dGVzKGJ5dGVBcnJheVtpKzJdLGJ5dGVBcnJheVtpKzNdKSksCgkJCQl6OiBkdHlwZXNfSW50MTZUb051bShkdHlwZXNfbWVyZ2UyQnl0ZXMoYnl0ZUFycmF5W2krNF0sYnl0ZUFycmF5W2krNV0pKQoJCQl9OwoJCQlpKz0gNjsKCQl9CgkJIyA3IGJ5dGVzIGRldGFpbHMgKDIgdHlwZSwgMiB0ZXh0dXJlLCAzIGNvbG9yKQoJCWlmICgoY29udGVudHMxICYgc3luY29ianNfaF9lVFlQRSkgPiAwKSB7CgkJCSMgdG9iai50eXBlID0gZHR5cGVzX21lcmdlMkJ5dGVzKGJ5dGVBcnJheVtpXSxieXRlQXJyYXlbaSsxXSk7CgkJCSMgaSs9MjsKCQkJbnVtIGxlbiA9IGJ5dGVBcnJheVtpXTsKCQkJaSsrOwoJCQludW1bXSBieXRlQSA9IG51bVtdOwoJCQlmb3IgKG51bSBrID0gMDsgayA8IGxlbjsgaysrKQoJCQl7CgkJCQlhZGRUbyBieXRlQSBieXRlQXJyYXlbaV07CgkJCQlpKys7CgkJCX0KCQkJIyBudW1bXSBieXRlQSA9IG51bVtdOyBhZGRUbyBieXRlQSBieXRlQXJyYXlbaV07CgkJCXRvYmoudHlwZSA9IGR0eXBlc19CeXRlQXJyYXlUb1N0cihieXRlQSk7CiAgICAgICAgICAgICMgaSs9MTsKCQkJIyBHQU1FLmxvZygidHlwZToiLHRvYmoudHlwZSk7CgkJfQogICAgICAgIGlmICgoY29udGVudHMxICYgc3luY29ianNfaF9lVEVYVFVSRSkgPiAwKSB7CgkJCXRvYmouYWlkID0gZHR5cGVzX21lcmdlMkJ5dGVzKGJ5dGVBcnJheVtpXSxieXRlQXJyYXlbaSsxXSk7CiAgICAgICAgICAgIGkrPTI7CgkJfQogICAgICAgIGlmICgoY29udGVudHMxICYgc3luY29ianNfaF9lQ09MT1IpID4gMCkgewoJCQl0b2JqLmNvbG9yID0gYnl0ZUFycmF5W2ldIHwgKGJ5dGVBcnJheVtpKzFdIDw8IDgpIHwgKGJ5dGVBcnJheVtpKzJdIDw8IDE2KTsKICAgICAgICAgICAgaSs9MzsKCQl9CiAgICAgICAgaWYgKChjb250ZW50czEgJiBzeW5jb2Jqc19oX2VFTUlTU0lWRSkgPiAwKSB7CgkJCXRvYmouZW1pc3NpdmUgPSBieXRlQXJyYXlbaV0gfCAoYnl0ZUFycmF5W2krMV0gPDwgOCkgfCAoYnl0ZUFycmF5W2krMl0gPDwgMTYpOwogICAgICAgICAgICBpKz0zOwoJCX0KCQlpZiAoKGNvbnRlbnRzMiAmIHN5bmNvYmpzX2hfZUNPTExJU0lPTikgPiAwKQoJCXsKCQkJdG9iai5jb2xsaWRlID0gewoJCQkJdHlwZTpieXRlQXJyYXlbaV0sCgkJCQlnZW9tZXRyeTpieXRlQXJyYXlbaSsxXSwKCQkJCXJlc29sdmU6Ynl0ZUFycmF5W2krMl0KCQkJfTsKCQkJaSs9MzsKCQl9CgkJYWRkVG8gb2JqbGlzdCB0b2JqOwoJfQoJZm9yIChudW0gaiA9IDA7IGogPCB0b3RhbGRlbG9ianM7IGorKyl7CgkJbnVtIG9iamlkID0gZHR5cGVzX21lcmdlMkJ5dGVzKGJ5dGVBcnJheVtpXSxieXRlQXJyYXlbaSsxXSk7CgkJYWRkVG8gZGVsTGlzdCBvYmppZDsKCQlpKz0yOwoJfQoKCglyZXR1cm4ge29iamxpc3Q6b2JqbGlzdCxkZWxMaXN0OmRlbExpc3R9Owp9CgojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIyBMaWJyYXJ5OiBcbGlic1xzeW5jb2Jqc1xzeW5jb2Jqc19jLmtybmsKIyBBdXRob3I6IGJsYW5kcmljZQojICAgRGVzY3JpcHRpb246IG5vdCByZWFkeSEKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpvYmpbXSBzeW5jb2Jqc19jX29iamxpc3QgPSBvYmpbXTsKc3RyIHN5bmNvYmpzX2NfbmV0ZGF0YSA9ICIiOwpzdHJbXSBzeW5jb2Jqc19jX2RlbExpc3QgPSBzdHJbXTsKCiMgaW50ZXJwb2xhdGlvbgpudW0gc3luY29ianNfY19uZXdUaW1lID0gMDsKbnVtIHN5bmNvYmpzX2Nfb2xkVGltZSA9IDA7Cm51bSBzeW5jb2Jqc19jX2RhdGFCdWZmZXIgPSAwOwpudW0gc3luY29ianNfY19pbnRlcnBNID0gMDsKCiMgdXBkYXRlIHdpdGggbmV3IG9iamVjdCBkYXRhCmJvb2wgYWN0aW9uIHN5bmNvYmpzX2NfdXBkYXRlb2JqcHJvcGVydGllcyhvYmogY3VycmVudE9iaiwgb2JqIG5ld09iakRhdGEpIHsKICAgIGN1cnJlbnRPYmoub2xkcG9zLnggPSAobnVtKSBjdXJyZW50T2JqLm5ld3Bvcy54OwogICAgY3VycmVudE9iai5vbGRwb3MueSA9IChudW0pIGN1cnJlbnRPYmoubmV3cG9zLnk7CiAgICBjdXJyZW50T2JqLm9sZHBvcy56ID0gKG51bSkgY3VycmVudE9iai5uZXdwb3MuejsKICAgIGN1cnJlbnRPYmoub2xkcm90LnggPSAobnVtKSBjdXJyZW50T2JqLm5ld3JvdC54OwogICAgY3VycmVudE9iai5vbGRyb3QueSA9IChudW0pIGN1cnJlbnRPYmoubmV3cm90Lnk7CiAgICBjdXJyZW50T2JqLm9sZHJvdC56ID0gKG51bSkgY3VycmVudE9iai5uZXdyb3QuejsKCiAgICBpZiAobm90RW1wdHkgKG9iaikgbmV3T2JqRGF0YS5wb3NpdGlvbil7CiAgICAgICAgY3VycmVudE9iai5uZXdwb3MueCA9IChudW0pIG5ld09iakRhdGEucG9zaXRpb24ueDsKICAgICAgICBjdXJyZW50T2JqLm5ld3Bvcy55ID0gKG51bSkgbmV3T2JqRGF0YS5wb3NpdGlvbi55OwogICAgICAgIGN1cnJlbnRPYmoubmV3cG9zLnogPSAobnVtKSBuZXdPYmpEYXRhLnBvc2l0aW9uLno7CiAgICB9CiAgICBpZiAobm90RW1wdHkgKG9iaikgbmV3T2JqRGF0YS5zY2FsZSl7CiAgICAgICAgY3VycmVudE9iai5zY2FsZS54ID0gKG51bSkgbmV3T2JqRGF0YS5zY2FsZS54OwogICAgICAgIGN1cnJlbnRPYmouc2NhbGUueSA9IChudW0pIG5ld09iakRhdGEuc2NhbGUueTsKICAgICAgICBjdXJyZW50T2JqLnNjYWxlLnogPSAobnVtKSBuZXdPYmpEYXRhLnNjYWxlLno7CiAgICB9CiAgICBpZiAoKHN0ciluZXdPYmpEYXRhLmhlYWx0aCE9InVuZGVmaW5lZCIpIHsKICAgICAgICBjdXJyZW50T2JqLmhlYWx0aCA9IChudW0pbmV3T2JqRGF0YS5oZWFsdGg7CiAgICB9CiAgICBpZiAoKHN0ciluZXdPYmpEYXRhLmZoZWFsdGghPSJ1bmRlZmluZWQiKSB7CiAgICAgICAgY3VycmVudE9iai5maGVhbHRoID0gKG51bSluZXdPYmpEYXRhLmZoZWFsdGg7CiAgICB9CiAgICBpZiAobm90RW1wdHkgKG9iailuZXdPYmpEYXRhLnJvdGF0aW9uKSB7CiAgICAgICAgY3VycmVudE9iai5uZXdyb3QueCA9IChudW0pIG5ld09iakRhdGEucm90YXRpb24ueDsKICAgICAgICBjdXJyZW50T2JqLm5ld3JvdC55ID0gKG51bSkgbmV3T2JqRGF0YS5yb3RhdGlvbi55OwogICAgICAgIGN1cnJlbnRPYmoubmV3cm90LnogPSAobnVtKSBuZXdPYmpEYXRhLnJvdGF0aW9uLno7CiAgICB9CiAgICBpZiAoKHN0ciluZXdPYmpEYXRhLmVtaXNzaXZlICE9InVuZGVmaW5lZCIpewogICAgICAgIHN0ciBjb2xyID0gIiMiICsgZHR5cGVzX251bTJoZXhzdHJpbmcoKG51bSkgbmV3T2JqRGF0YS5lbWlzc2l2ZSk7CiAgICAgICAgY3VycmVudE9iai5lbWlzc2l2ZSA9IGNvbHI7CiAgICB9CiAgICBpZiAobm90RW1wdHkgKG9iailuZXdPYmpEYXRhLmNvbGxpZGUpewogICAgICAgIGN1cnJlbnRPYmouY29sbGlkZS50eXBlID0gKG51bSkgbmV3T2JqRGF0YS5jb2xsaWRlLnR5cGU7CiAgICAgICAgY3VycmVudE9iai5jb2xsaWRlLmdlb21ldHJ5ID0gKG51bSkgbmV3T2JqRGF0YS5jb2xsaWRlLmdlb21ldHJ5OwogICAgICAgIGN1cnJlbnRPYmouY29sbGlkZS5yZXNvbHZlID0gKG51bSkgbmV3T2JqRGF0YS5jb2xsaWRlLnJlc29sdmU7CiAgICB9CiAgICByZXR1cm4gdHJ1ZTsKfQoKIyBGaXJzdCBjcmVhdGlvbiBvZiBvYmplY3QKb2JqIGFjdGlvbiBzeW5jb2Jqc19jX2NyZWF0ZU9iaihvYmogbmV3T2JqRGF0YSkgewogICAgb2JqIGN1YmUgPSB7fTsKICAgIGlmICgoc3RyKSBuZXdPYmpEYXRhLnR5cGUgPT0gIjAiKSB7CiAgICAgICAgIyBzdHIgYWlkID0gKHN0cikgbmV3T2JqRGF0YS5haWQ7CiAgICAgICAgIyBzdHIgYWlkID0gIjM0Mzc5IjsgIyB0ZW1wIGZpeCBmb3Igbm93CiAgICAgICAgc3RyIGNvbHIgPSAiIyIgKyBkdHlwZXNfbnVtMmhleHN0cmluZygobnVtKSBuZXdPYmpEYXRhLmNvbG9yKTsKICAgICAgICAjIG9iaiBjdWJlID0gR0FNRS5TQ0VORS5hZGRDdWJlKHRvU3RyIChudW0pbmV3T2JqRGF0YS5haWQsIGNvbHIsIChudW0pbmV3T2JqRGF0YS5wb3NpdGlvbi54LChudW0pbmV3T2JqRGF0YS5wb3NpdGlvbi55LChudW0pbmV3T2JqRGF0YS5wb3NpdGlvbi56LCAwLDAsMCk7CiAgICAgICAgY3ViZSA9IEdBTUUuU0NFTkUuYWRkQ3ViZSh0b1N0ciAobnVtKW5ld09iakRhdGEuYWlkLCBjb2xyLCAobnVtKW5ld09iakRhdGEucG9zaXRpb24ueCwobnVtKW5ld09iakRhdGEucG9zaXRpb24ueSwobnVtKW5ld09iakRhdGEucG9zaXRpb24ueiwgKG51bSluZXdPYmpEYXRhLnNjYWxlLngsKG51bSluZXdPYmpEYXRhLnNjYWxlLnksKG51bSluZXdPYmpEYXRhLnNjYWxlLnopOwogICAgICAgICMgcmV0dXJuIGN1YmU7CiAgICB9IGVsc2UgaWYgKFVUSUxTLnRleHRDb250YWlucygoc3RyKW5ld09iakRhdGEudHlwZSwidGciKSl7CiAgICAgICAgIyBHQU1FLmxvZygibmV3IHR5cGUgZW5jb3VudGVyZWQ6Iiwoc3RyKSBuZXdPYmpEYXRhLnR5cGUpOwogICAgICAgIHN0ciBjb2xyID0gIiMiICsgZHR5cGVzX251bTJoZXhzdHJpbmcoKG51bSkgbmV3T2JqRGF0YS5jb2xvcik7CiAgICAgICAgY3ViZSA9IEdBTUUuU0NFTkUuYWRkQXNzZXQoKHN0ciluZXdPYmpEYXRhLnR5cGUsIChudW0pbmV3T2JqRGF0YS5wb3NpdGlvbi54LChudW0pbmV3T2JqRGF0YS5wb3NpdGlvbi55LChudW0pbmV3T2JqRGF0YS5wb3NpdGlvbi56LCAxLCBjb2xyLCB7fSk7CgogICAgfQogICAgY3ViZS5vYmppZCA9IChudW0pIG5ld09iakRhdGEub2JqaWQ7CiAgICBjdWJlLm9sZHBvcyA9IHt4OihudW0pbmV3T2JqRGF0YS5wb3NpdGlvbi54LHk6KG51bSluZXdPYmpEYXRhLnBvc2l0aW9uLnksejoobnVtKW5ld09iakRhdGEucG9zaXRpb24uen07CiAgICBjdWJlLm5ld3BvcyA9IHt4OihudW0pbmV3T2JqRGF0YS5wb3NpdGlvbi54LHk6KG51bSluZXdPYmpEYXRhLnBvc2l0aW9uLnksejoobnVtKW5ld09iakRhdGEucG9zaXRpb24uen07CgogICAgY3ViZS5vbGRyb3QgPSB7eDoobnVtKW5ld09iakRhdGEucm90YXRpb24ueCx5OihudW0pbmV3T2JqRGF0YS5yb3RhdGlvbi55LHo6KG51bSluZXdPYmpEYXRhLnJvdGF0aW9uLnp9OwogICAgY3ViZS5uZXdyb3QgPSB7eDoobnVtKW5ld09iakRhdGEucm90YXRpb24ueCx5OihudW0pbmV3T2JqRGF0YS5yb3RhdGlvbi55LHo6KG51bSluZXdPYmpEYXRhLnJvdGF0aW9uLnp9OwoKICAgIGN1YmUuaGVhbHRoID0gKG51bSkgbmV3T2JqRGF0YS5oZWFsdGg7CiAgICBjdWJlLmZoZWFsdGggPSAobnVtKSBuZXdPYmpEYXRhLmZoZWFsdGg7CiAgICBjdWJlLmhpdCA9IChudW0pIG5ld09iakRhdGEuaGl0OwogICAgY3ViZS5jb2xsaWRlID0ge307CiAgICAKICAgIHN5bmNvYmpzX2NfdXBkYXRlb2JqcHJvcGVydGllcyhjdWJlLCBuZXdPYmpEYXRhKTsKCiAgICByZXR1cm4gY3ViZTsKfQoKYWN0aW9uIHN5bmNvYmpzX2NfbGVycE9iaihudW0gZGVsdGEpIHsKICAgIHN5bmNvYmpzX2NfaW50ZXJwTSA9IE1hdGgubWluKDEuNSwgKEdBTUUuVElNRS5ub3coKSAtIHN5bmNvYmpzX2NfbmV3VGltZSkgLyBzeW5jb2Jqc19jX2RhdGFCdWZmZXIpOwogICAgZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBzeW5jb2Jqc19jX29iamxpc3Q7IGkrKyl7CiAgICAgICAgb2JqIGN1ck9iaiA9IHN5bmNvYmpzX2Nfb2JqbGlzdFtpXTsKICAgICAgICBpZiAoIW5vdEVtcHR5IChvYmopIGN1ck9iai5vZ3Bvcyl7CiAgICAgICAgICAgIGN1ck9iai5vZ3BvcyA9IHt9OwogICAgICAgIH0KICAgICAgICBjdXJPYmoub2dwb3MgPSAKICAgICAgICB7CiAgICAgICAgICAgIHg6Y3VyT2JqLnBvc2l0aW9uLngsCiAgICAgICAgICAgIHk6Y3VyT2JqLnBvc2l0aW9uLnksCiAgICAgICAgICAgIHo6Y3VyT2JqLnBvc2l0aW9uLnoKICAgICAgICB9OwogICAgICAgIChudW0pIGN1ck9iai5wb3NpdGlvbi54ICs9IChNYXRoLmxlcnAoKG51bSljdXJPYmoub2xkcG9zLngsIChudW0pY3VyT2JqLm5ld3Bvcy54LCBzeW5jb2Jqc19jX2ludGVycE0pLShudW0pY3VyT2JqLnBvc2l0aW9uLngpKmRlbHRhLzEwMDAqNjAvNDsKICAgICAgICAobnVtKSBjdXJPYmoucG9zaXRpb24ueSArPSAoTWF0aC5sZXJwKChudW0pY3VyT2JqLm9sZHBvcy55LCAobnVtKWN1ck9iai5uZXdwb3MueSwgc3luY29ianNfY19pbnRlcnBNKS0obnVtKWN1ck9iai5wb3NpdGlvbi55KSpkZWx0YS8xMDAwKjYwLzQ7CiAgICAgICAgKG51bSkgY3VyT2JqLnBvc2l0aW9uLnogKz0gKE1hdGgubGVycCgobnVtKWN1ck9iai5vbGRwb3MueiwgKG51bSljdXJPYmoubmV3cG9zLnosIHN5bmNvYmpzX2NfaW50ZXJwTSktKG51bSljdXJPYmoucG9zaXRpb24ueikqZGVsdGEvMTAwMCo2MC80OwogICAgICAgIGlmICghbm90RW1wdHkgKG9iaikgY3VyT2JqLm9ncm90KXsKICAgICAgICAgICAgY3VyT2JqLm9ncm90ID0ge307CiAgICAgICAgfQogICAgICAgIGN1ck9iai5vZ3JvdCA9IAogICAgICAgIHsKICAgICAgICAgICAgeDpjdXJPYmoucm90YXRpb24ueCwKICAgICAgICAgICAgeTpjdXJPYmoucm90YXRpb24ueSwKICAgICAgICAgICAgejpjdXJPYmoucm90YXRpb24uegogICAgICAgIH07CiAgICAgICAgKG51bSkgY3VyT2JqLnJvdGF0aW9uLnggKz0gKE1hdGgubGVycCgobnVtKWN1ck9iai5vbGRyb3QueCwgKG51bSljdXJPYmoubmV3cm90LngsIHN5bmNvYmpzX2NfaW50ZXJwTSktKG51bSljdXJPYmoucm90YXRpb24ueCkqZGVsdGEvMTAwMCo2MC80OwogICAgICAgIChudW0pIGN1ck9iai5yb3RhdGlvbi55ICs9IChNYXRoLmxlcnAoKG51bSljdXJPYmoub2xkcm90LnksIChudW0pY3VyT2JqLm5ld3JvdC55LCBzeW5jb2Jqc19jX2ludGVycE0pLShudW0pY3VyT2JqLnJvdGF0aW9uLnkpKmRlbHRhLzEwMDAqNjAvNDsKICAgICAgICAobnVtKSBjdXJPYmoucm90YXRpb24ueiArPSAoTWF0aC5sZXJwKChudW0pY3VyT2JqLm9sZHJvdC56LCAobnVtKWN1ck9iai5uZXdyb3Queiwgc3luY29ianNfY19pbnRlcnBNKS0obnVtKWN1ck9iai5yb3RhdGlvbi56KSpkZWx0YS8xMDAwKjYwLzQ7CgogICAgICAgIGlmICghbm90RW1wdHkgKG9iaikgY3VyT2JqLnZlbG9jaXR5KXsKICAgICAgICAgICAgY3VyT2JqLnZlbG9jaXR5ID0ge307CiAgICAgICAgfQogICAgICAgIGN1ck9iai52ZWxvY2l0eS54ID0gKChudW0pIGN1ck9iai5wb3NpdGlvbi54IC0gKG51bSkgY3VyT2JqLm9ncG9zLngpIC8gZGVsdGE7CiAgICAgICAgY3VyT2JqLnZlbG9jaXR5LnkgPSAoKG51bSkgY3VyT2JqLnBvc2l0aW9uLnkgLSAobnVtKSBjdXJPYmoub2dwb3MueSkgLyBkZWx0YTsKICAgICAgICBjdXJPYmoudmVsb2NpdHkueiA9ICgobnVtKSBjdXJPYmoucG9zaXRpb24ueiAtIChudW0pIGN1ck9iai5vZ3Bvcy56KSAvIGRlbHRhOwogICAgfQogICAgCiAgICAKICAgICAKfQoKb2JqIGFjdGlvbiBzeW5jb2Jqc19jX2ZpbmRPYmpieUlEKG51bSBpZCkgewogICAgZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBzeW5jb2Jqc19jX29iamxpc3Q7IGkrKykgewogICAgICAgIGlmICgobnVtKSBzeW5jb2Jqc19jX29iamxpc3RbaV0ub2JqaWQgPT0gaWQpIHsKICAgICAgICAgICAgcmV0dXJuIHN5bmNvYmpzX2Nfb2JqbGlzdFtpXTsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4ge307Cn0KCmJvb2wgYWN0aW9uIHN5bmNvYmpzX2NfZGVsZXRlb2JqKG51bSBpZCkgewogICAgZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBzeW5jb2Jqc19jX29iamxpc3Q7IGkrKykgewogICAgICAgIGlmICgobnVtKSBzeW5jb2Jqc19jX29iamxpc3RbaV0ub2JqaWQgPT0gaWQpIHsKICAgICAgICAgICAgb2JqIGN1YmUgPSBzeW5jb2Jqc19jX29iamxpc3RbaV07CiAgICAgICAgICAgIGFkZFRvIHN5bmNvYmpzX2NfZGVsTGlzdCAoc3RyKSBjdWJlLm9iamlkOwogICAgICAgICAgICByZW1vdmUgc3luY29ianNfY19vYmpsaXN0W2ldOwogICAgICAgICAgICBjdWJlLmRlbGV0ZSgpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gZmFsc2U7Cn0KCmFjdGlvbiBzeW5jb2Jqc19jX2NsZWFyQWxsT2JqcygpewogICAgZm9yIChudW0gaSA9IGxlbmd0aE9mIHN5bmNvYmpzX2Nfb2JqbGlzdCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgc3luY29ianNfY19kZWxldGVvYmooKG51bSlzeW5jb2Jqc19jX29iamxpc3RbaV0ub2JqaWQpOwogICAgfQogICAgc3luY29ianNfY19vYmpsaXN0ID0gb2JqW107CiAgICBzeW5jb2Jqc19jX2RlbExpc3QgPSBzdHJbXTsKfQoKYm9vbCBhY3Rpb24gc3luY29ianNfY19vYmpJRFdhc0RlbGV0ZWQoc3RyIGlkKSB7CiAgICBmb3IgKG51bSBpID0gMDsgaSA8IGxlbmd0aE9mIHN5bmNvYmpzX2NfZGVsTGlzdDsgaSsrKSB7CiAgICAgICAgaWYgKGlkID09IHN5bmNvYmpzX2NfZGVsTGlzdFtpXSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgCiAgICB9CiAgICByZXR1cm4gZmFsc2U7Cn0KCm51bVtdIGFjdGlvbiBzeW5jb2Jqc19jX2dldEFsbE9iaklEcygpIHsKICAgIG51bVtdIHJldG9iamlkcyA9IG51bVtdOwogICAgZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBzeW5jb2Jqc19jX29iamxpc3Q7IGkrKykKICAgIHsKICAgICAgICBhZGRUbyByZXRvYmppZHMgKG51bSlzeW5jb2Jqc19jX29iamxpc3RbaV0ub2JqaWQ7CiAgICB9CiAgICByZXR1cm4gcmV0b2JqaWRzOwp9Cgpib29sIGFjdGlvbiBzeW5jb2Jqc19jX3VwZGF0ZW9ianMob2JqW10gbmV0b2JqcykgewogICAgZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBuZXRvYmpzOyBpKyspewogICAgICAgIG9iaiBuZXdPYmpEYXRhID0gbmV0b2Jqc1tpXTsKICAgICAgICAjIGFkZCBuZXcgT2JqZWN0CiAgICAgICAgaWYgKChsZW5ndGhPZiBzeW5jb2Jqc19jX29iamxpc3QgPT0gMCkgfHwgKChudW0pbmV3T2JqRGF0YS5vYmppZCA+IChudW0pIHN5bmNvYmpzX2Nfb2JqbGlzdFtsZW5ndGhPZiBzeW5jb2Jqc19jX29iamxpc3QgLSAxXS5vYmppZCkpIHsKICAgICAgICAgICAgaWYgKCFzeW5jb2Jqc19jX29iaklEV2FzRGVsZXRlZCgoc3RyKW5ld09iakRhdGEub2JqaWQpKSB7CiAgICAgICAgICAgICAgICBvYmogbmV3T2JqID0gc3luY29ianNfY19jcmVhdGVPYmoobmV3T2JqRGF0YSk7CiAgICAgICAgICAgICAgICBhZGRUbyBzeW5jb2Jqc19jX29iamxpc3QgbmV3T2JqOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgR0FNRS5sb2coIm9iamVjdCBhbHJlYWR5IGRlbGV0ZWQhICIgKyAoc3RyKW5ld09iakRhdGEub2JqaWQpOwogICAgICAgICAgICB9CiAgICAgICAgfSAKICAgICAgICAjIFVwZGF0ZSBjdXJyZW50IG9iamVjdCBwcm9wZXJ0aWVzCiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIG9iaiBjdXJPYmogPSBzeW5jb2Jqc19jX2ZpbmRPYmpieUlEKChudW0pbmV3T2JqRGF0YS5vYmppZCk7CiAgICAgICAgICAgIGJvb2wgc3VjY2VzcyA9IHN5bmNvYmpzX2NfdXBkYXRlb2JqcHJvcGVydGllcyhjdXJPYmosIG5ld09iakRhdGEpOwogICAgICAgICAgICBpZiAoIXN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgIEdBTUUubG9nKCJFUlJPUjogcHJvcGVydGllcyBub3QgdXBkYXRlZCBmb3Igb2JqaWQ6ICIsIHRvU3RyIG5ld09iakRhdGEub2JqaWQpOwogICAgICAgICAgICAgICAgR0FNRS5sb2cobmV3T2JqRGF0YSk7CiAgICAgICAgICAgICAgICBHQU1FLmxvZyhzeW5jb2Jqc19jX29iamxpc3QpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIHRydWU7Cn0KCiMgcmVzZXQgb2JqZWN0IGxpc3RzLCB0aW1lIHZhcnMsIGF0dGVtcHRlZCB0byBwcmVsb2FkIHNvdW5kcyBpbnRvIGdhbWUgZW5naW5lIHRvIGF2b2lkIHRoZSBmaXJzdCBzb3VuZCdzIGxhZy4KYWN0aW9uIHN5bmNvYmpzX2Nfc3RhcnQoKSB7CiAgICBzeW5jb2Jqc19jX2NsZWFyQWxsT2JqcygpOwogICAgIyBzeW5jb2Jqc19jX29iamxpc3QgPSBvYmpbXTsKICAgICMgc3luY29ianNfY19kZWxMaXN0ID0gc3RyW107CiAgICAKICAgIHN5bmNvYmpzX2Nfb2xkVGltZSA9IEdBTUUuVElNRS5ub3coKTsKICAgIHN5bmNvYmpzX2NfbmV3VGltZSA9IEdBTUUuVElNRS5ub3coKTsKfQoKYWN0aW9uIHN5bmNvYmpzX2Nfb25OZXR3b3JrTWVzc2FnZShzdHIgaWQsIG9iaiBkYXRhKSB7CiAgICBpZiAoaWQgPT0gInN5bmMiKSB7CiAgICAgICAgCiAgICAgICAgIyBjbGVhciBhbGwgb2JqZWN0IC8gbmV0d29yayBkYXRhIGlmIHJlc2V0IGdpdmVuCiAgICAgICAgaWYgKChzdHIpZGF0YS5yc3QgIT0gInVuZGVmaW5lZCIgJiYgKG51bSlkYXRhLnJzdCA9PSAxKXsKICAgICAgICAgICAgc3luY29ianNfY19jbGVhckFsbE9ianMoKTsKICAgICAgICAgICAgc3luY29ianNfY19uZXRkYXRhID0gIiI7CiAgICAgICAgfQogICAgICAgIHN5bmNvYmpzX2NfbmV0ZGF0YSArPSAoc3RyKWRhdGEuZDsKCiAgICAgICAgaWYgKChzdHIpZGF0YS5wY250ICE9ICJ1bmRlZmluZWQiICYmIChudW0pZGF0YS5wY250ID09IDEwMCkKICAgICAgICB7CiAgICAgICAgICAgICMgZGF0YSBzZW50LCBwZXJmb3JtIGRlY29kZSBhbmQgdXBkYXRlIG9iamVjdHMKICAgICAgICAgICAgb2JqIGRlY29kZWRkYXRhID0gc3luY29ianNfaF9ieXRlQXJyYXlUb09ianMoYjkxX2RlY29kZShzeW5jb2Jqc19jX25ldGRhdGEpKTsKICAgICAgICAgICAgb2JqW10gbmV0b2JqcyA9IChvYmpbXSkgZGVjb2RlZGRhdGEub2JqbGlzdDsKICAgICAgICAgICAgc3luY29ianNfY19vbGRUaW1lID0gc3luY29ianNfY19uZXdUaW1lOwogICAgICAgICAgICBzeW5jb2Jqc19jX25ld1RpbWUgPSBHQU1FLlRJTUUubm93KCk7CiAgICAgICAgICAgIHN5bmNvYmpzX2NfZGF0YUJ1ZmZlciA9IHN5bmNvYmpzX2NfbmV3VGltZSAtIHN5bmNvYmpzX2Nfb2xkVGltZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHN5bmNvYmpzX2NfdXBkYXRlb2JqcyhuZXRvYmpzKTsKICAgICAgICAgICAgbnVtW10gbmV3ZGVsbGlzdCA9IChudW1bXSkgZGVjb2RlZGRhdGEuZGVsTGlzdDsKICAgICAgICAgICAgIyBudW1bXSBuZXdkZWxsaXN0ID0gKG51bVtdKSBkYXRhLmRlbGxpc3Q7CiAgICAgICAgICAgIG51bSBkZWxldGVkID0gMDsKICAgICAgICAgICAgbnVtW10gbm90ZGVsZXRlZCA9IG51bVtdOwogICAgICAgICAgICBmb3IgKG51bSBpID0gMDsgaSA8IGxlbmd0aE9mIG5ld2RlbGxpc3Q7IGkrKykgewogICAgICAgICAgICAgICAgYm9vbCBzdWNjZXNzID0gc3luY29ianNfY19kZWxldGVvYmoobmV3ZGVsbGlzdFtpXSk7CiAgICAgICAgICAgICAgICBpZiAoc3VjY2VzcykKCQkJCXsKCQkJCQlkZWxldGVkKys7CgkJCQl9CgkJCQllbHNlCgkJCQl7CgkJCQkJYWRkVG8gbm90ZGVsZXRlZCBuZXdkZWxsaXN0W2ldOwoJCQkJfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChsZW5ndGhPZiBuZXdkZWxsaXN0ID4gMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgR0FNRS5sb2coImRlbGV0ZWQgdGhpcyBtYW55OiAiLGRlbGV0ZWQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChsZW5ndGhPZiBub3RkZWxldGVkID4gMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgR0FNRS5sb2coImRpZCBub3QgZGVsZXRlIG9iamVjdHMgd2l0aCBpZHM6ICIsIG5vdGRlbGV0ZWQpOwogICAgICAgICAgICAgICAgbnVtW10gYWxsb2JqaWRzID0gc3luY29ianNfY19nZXRBbGxPYmpJRHMoKTsKICAgICAgICAgICAgICAgIEdBTUUubG9nKCJjdXJyZW50IG9iamVjdCBpZHM6ICIsYWxsb2JqaWRzKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAjIGNsZWFyIHN5bmNvYmpzX2NfbmV0ZGF0YSBzdHJpbmcgYnVmZmVyCiAgICAgICAgICAgIHN5bmNvYmpzX2NfbmV0ZGF0YSA9ICIiOwogICAgICAgIH0KCiAgICAgICAgCiAgICB9IGVsc2UgaWYgKGlkID09ICJjbGVhciIpIHsKICAgICAgICBzeW5jb2Jqc19jX2NsZWFyQWxsT2JqcygpOyAgICAgICAKICAgIH0KfQoKYWN0aW9uIHN5bmNvYmpzX2NfdXBkYXRlKG51bSBkZWx0YSl7CiAgICAjIG9iamVjdCBwb3NpdGlvbiBsZXJwaW5nCiAgICBzeW5jb2Jqc19jX2xlcnBPYmooZGVsdGEpOwp9CgphY3Rpb24gc3luY29ianNfY19vbkdhbWVFbmQoKXsKICAgIHN5bmNvYmpzX2NfY2xlYXJBbGxPYmpzKCk7Cn0KCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojIExpYnJhcnk6IGxpYnNcdXRpbHNccGxyYmVoYXZpb3JccGxyYmh2cl9jLmtybmsKIyBBdXRob3I6IGJsYW5kcmljZQojICAgRGVzY3JpcHRpb246IGRpc2FibGUgc2VydmVyIHN5bmMgKyBiZWhhdmlvciBmb3IgY3VzdG9tIG1vdmVtZW50CiMgICBzZW5kIHBsciBwb3NpdGlvbi92ZWwgdG8gc2VydmVyIG1hbnVhbGx5CiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpudW0gcGxyYmh2cl9jX3RsYXN0c3luYyA9IDA7Cm51bSBwbHJiaHZyX2NfUkFURSA9IDI1OyAjIE1JTiAyNW1zIC8gNDAgbXNnIHBlciBzZWNvbmQKb2JqW10gcGxyYmh2cl9jX3BscnMgPSBvYmpbXTsKb2JqIHBscmJodnJfY19zZWxmID0ge307Cm9iaiBwbHJiaHZyX2Nfc2F2ZXN0YXRlID0ge307CgpudW0gcGxyYmh2cl9jX1NJWkVOQU1FID0gMjA7Cm51bSBwbHJiaHZyX2NfSEFMRlNOQU1FID0gMTA7Cm51bSBwbHJiaHZyX2NfTUFYUkVOREVSRElTVCA9IDUwMDsKCgojIGludGVycG9sYXRpb24KbnVtIHBscmJodnJfY19uZXdUaW1lID0gMDsKbnVtIHBscmJodnJfY19vbGRUaW1lID0gMDsKbnVtIHBscmJodnJfY19kYXRhQnVmZmVyID0gMDsKbnVtIHBscmJodnJfY19pbnRlcnBNID0gMDsKCiMgd2Fsa2luZyBvbiBwbGF0Zm9ybXMKYm9vbCBwbHJiaHZyX2NfY3IgPSBmYWxzZTsKbnVtIHBscmJodnJfY19NQVhXQUxLU1BFRUQgPSAwLjA0OwpudW0gcGxyYmh2cl9jX3Rub3cgPSAwOwoKCmFjdGlvbiBwbHJiaHZyX2NfbGVycFBscnMobnVtIGRlbHRhKSB7CiAgICBwbHJiaHZyX2NfaW50ZXJwTSA9IE1hdGgubWluKDEuNSwgKGdfdG5vdyAtIHBscmJodnJfY19uZXdUaW1lKSAvIHBscmJodnJfY19kYXRhQnVmZmVyKTsKICAgIGZvciAobnVtIGkgPSAwOyBpIDwgbGVuZ3RoT2YgcGxyYmh2cl9jX3BscnM7IGkrKyl7CiAgICAgICAgb2JqIHBsciA9IHBscmJodnJfY19wbHJzW2ldOwogICAgICAgIAogICAgICAgIChudW0pIHBsci5wb3NpdGlvbi54ICs9IChNYXRoLmxlcnAoKG51bSlwbHIub2xkcG9zLngsIChudW0pcGxyLm5ld3Bvcy54LCBwbHJiaHZyX2NfaW50ZXJwTSktKG51bSlwbHIucG9zaXRpb24ueCkqZGVsdGEvMTAwMCo2MC80OwogICAgICAgIChudW0pIHBsci5wb3NpdGlvbi55ICs9IChNYXRoLmxlcnAoKG51bSlwbHIub2xkcG9zLnksIChudW0pcGxyLm5ld3Bvcy55LCBwbHJiaHZyX2NfaW50ZXJwTSktKG51bSlwbHIucG9zaXRpb24ueSkqZGVsdGEvMTAwMCo2MC80OwogICAgICAgIChudW0pIHBsci5wb3NpdGlvbi56ICs9IChNYXRoLmxlcnAoKG51bSlwbHIub2xkcG9zLnosIChudW0pcGxyLm5ld3Bvcy56LCBwbHJiaHZyX2NfaW50ZXJwTSktKG51bSlwbHIucG9zaXRpb24ueikqZGVsdGEvMTAwMCo2MC80OwogICAgICAgICMgKG51bSkgcGxyLnJvdGF0aW9uLnggKz0gKE1hdGgubGVycCgobnVtKXBsci5vbGRyb3QueCwgKG51bSlwbHIubmV3cm90LngsIHBscmJodnJfY19pbnRlcnBNKS0obnVtKXBsci5yb3RhdGlvbi54KSpkZWx0YS8xMDAwKjYwLzQ7CiAgICAgICAgKG51bSkgcGxyLnJvdGF0aW9uLnggKz0gKE1hdGgubGVycCgobnVtKXBsci5vbGRyb3QueCwgKG51bSlwbHIubmV3cm90LngsIHBscmJodnJfY19pbnRlcnBNKS0obnVtKXBsci5yb3RhdGlvbi54KSpkZWx0YS8xMDAwKjYwLzQ7CiAgICAgICAgIyAobnVtKSBwbHIucm90YXRpb24ueiArPSAoTWF0aC5sZXJwKChudW0pcGxyLm9sZHJvdC56LCAobnVtKXBsci5uZXdyb3QueiwgcGxyYmh2cl9jX2ludGVycE0pLShudW0pcGxyLnJvdGF0aW9uLnopKmRlbHRhLzEwMDAqNjAvNDsKICAgIH0KICAgIAogICAgCiAgICAgCn0KCm9iaiBhY3Rpb24gcGxyYmh2cl9jX2ZpbmRCeVVzZXJuYW1lKHN0ciBuKXsKICAgIGZvciAobnVtIGkgPSAwOyBpIDwgbGVuZ3RoT2YgcGxyYmh2cl9jX3BscnM7IGkrKyl7CiAgICAgICAgaWYgKG4gPT0gKHN0cilwbHJiaHZyX2NfcGxyc1tpXS51c2VybmFtZSkgewogICAgICAgICAgICByZXR1cm4gcGxyYmh2cl9jX3BscnNbaV07CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIHt9Owp9CgoKCm9iaiBhY3Rpb24gcGxyYmh2cl9jX2ZpbmRCeUlkKHN0ciBpZCl7CiAgICBmb3IgKG51bSBpID0gMDsgaSA8IGxlbmd0aE9mIHBscmJodnJfY19wbHJzOyBpKyspewogICAgICAgIGlmIChpZCA9PSAoc3RyKXBscmJodnJfY19wbHJzW2ldLmlkKSB7CiAgICAgICAgICAgIHJldHVybiBwbHJiaHZyX2NfcGxyc1tpXTsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4ge307Cn0KCmFjdGlvbiBwbHJiaHZyX2NfcmVtb3ZlQnlJZChzdHIgaWQpewogICAgZm9yIChudW0gaSA9IGxlbmd0aE9mIHBscmJodnJfY19wbHJzLTE7IGkgPj0gMDsgaS0tKXsKICAgICAgICBpZiAoaWQgPT0gKHN0cilwbHJiaHZyX2NfcGxyc1tpXS5pZCkgewogICAgICAgICAgICBHQU1FLmxvZygicmVtb3ZpbmcgcGxyIGlkIixpZCk7CiAgICAgICAgICAgIHBscmJodnJfY19wbHJzW2ldLm1vZGVsLmRlbGV0ZSgpOwogICAgICAgICAgICByZW1vdmUgcGxyYmh2cl9jX3BscnNbaV07CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9Cn0KCmFjdGlvbiBwbHJiaHZyX2NfdXBkYXRlKG51bSBkZWx0YSl7CiAgICAjIG51bSBwbHJiaHZyX2NfdG5vdyA9IEdBTUUuVElNRS5ub3coKTsKICAgIHBscmJodnJfY19sZXJwUGxycyhkZWx0YSk7CiAgICBpZiAocGxydXRpbF9jX2ltc3Bhd25lZCAmJiAoZ190bm93IC0gcGxyYmh2cl9jX3RsYXN0c3luYz4gcGxyYmh2cl9jX1JBVEUpKXsKICAgICAgICBwbHJiaHZyX2Nfc2VsZiA9IEdBTUUuUExBWUVSUy5nZXRTZWxmKCk7CiAgICAgICAgaWYgKG5vdEVtcHR5IChvYmopcGxyYmh2cl9jX3NhdmVzdGF0ZS5wb3NpdGlvbil7CiAgICAgICAgICAgIEdBTUUuTkVUV09SSy5zZW5kKCJwbHJiaHZyIiwge3Bvc2l0aW9uOnBscmJodnJfY19zYXZlc3RhdGUucG9zaXRpb24sdmVsb2NpdHk6cGxyYmh2cl9jX3NhdmVzdGF0ZS52ZWxvY2l0eSxyb3RhdGlvbjpwbHJiaHZyX2Nfc2F2ZXN0YXRlLnJvdGF0aW9ufSk7CiAgICAgICAgICAgIHBscmJodnJfY19zYXZlc3RhdGUgPSB7fTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBHQU1FLk5FVFdPUksuc2VuZCgicGxyYmh2ciIsIHtwb3NpdGlvbjpwbHJiaHZyX2Nfc2VsZi5wb3NpdGlvbix2ZWxvY2l0eTpwbHJiaHZyX2Nfc2VsZi52ZWxvY2l0eSxyb3RhdGlvbjpwbHJiaHZyX2Nfc2VsZi5yb3RhdGlvbn0pOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwbHJiaHZyX2NfdGxhc3RzeW5jID0gZ190bm93OwogICAgfQogICAgZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBwbHJiaHZyX2NfcGxycztpKyspCiAgICB7CiAgICAgICAgb2JqIHBsciA9IHBscmJodnJfY19wbHJzW2ldOwogICAgICAgIHBsci5tb2RlbC5wb3NpdGlvbi54ID0gKG51bSlwbHIucG9zaXRpb24ueDsKICAgICAgICBwbHIubW9kZWwucG9zaXRpb24ueSA9IChudW0pcGxyLnBvc2l0aW9uLnk7CiAgICAgICAgcGxyLm1vZGVsLnBvc2l0aW9uLnogPSAobnVtKXBsci5wb3NpdGlvbi56OwogICAgICAgIHBsci5tb2RlbC5yb3RhdGlvbi55ID0gKG51bSlwbHIucm90YXRpb24ueDsKICAgIH0KfQoKYWN0aW9uIHBscmJodnJfY19vbk5ldHdvcmtNZXNzYWdlKHN0ciBpZCwgb2JqIGRhdGEpIHsKICAgIGlmIChpZCA9PSAicGxycyIpewogICAgICAgIHBscmJodnJfY19vbGRUaW1lID0gcGxyYmh2cl9jX25ld1RpbWU7CiAgICAgICAgcGxyYmh2cl9jX25ld1RpbWUgPSBnX3Rub3c7CiAgICAgICAgcGxyYmh2cl9jX2RhdGFCdWZmZXIgPSBwbHJiaHZyX2NfbmV3VGltZSAtIHBscmJodnJfY19vbGRUaW1lOwoKICAgICAgICBvYmpbXSBuZXRwbHJzID0gKG9ialtdKWRhdGEucGxycyA7CiAgICAgICAgc3RyW10gbGVmdHBscnMgPSAoc3RyW10pZGF0YS5sZWZ0OwogICAgICAgIGZvciAobnVtIGkgPSAwOyBpIDwgbGVuZ3RoT2YgbGVmdHBscnM7aSsrKXsKICAgICAgICAgICAgb2JqIHVzciA9IHBscmJodnJfY19maW5kQnlJZChsZWZ0cGxyc1tpXSk7CiAgICAgICAgICAgIGlmICgoc3RyKXVzci5pZCE9InVuZGVmaW5lZCIpewogICAgICAgICAgICAgICAgcGxyYmh2cl9jX3JlbW92ZUJ5SWQoKHN0cil1c3IuaWQpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZvciAobnVtIGkgPSAwOyBpIDwgbGVuZ3RoT2YgbmV0cGxyczsgaSsrKXsKICAgICAgICAgICAgb2JqIHBscmRhdGEgPSBuZXRwbHJzW2ldOwogICAgICAgICAgICBvYmogdXNyID0gcGxyYmh2cl9jX2ZpbmRCeUlkKChzdHIpcGxyZGF0YS5pZCk7CiAgICAgICAgICAgICMgb2JqIHVzciA9IHBscmJodnJfY19maW5kQnlVc2VybmFtZSgoc3RyKXBscmRhdGEubik7CiAgICAgICAgICAgIGlmICgoc3RyKXVzci5pZCE9InVuZGVmaW5lZCIpewogICAgICAgICAgICAgICAgIyBHQU1FLmxvZygidXNyIGZvdW5kIix1c3IpOwogICAgICAgICAgICAgICAgIyB1c3IucG9zaXRpb24ueCA9IChudW0pcGxyZGF0YS5wb3MueDsKICAgICAgICAgICAgICAgICMgdXNyLnBvc2l0aW9uLnkgPSAobnVtKXBscmRhdGEucG9zLnkrNTsKICAgICAgICAgICAgICAgICMgdXNyLnBvc2l0aW9uLnogPSAobnVtKXBscmRhdGEucG9zLno7CiAgICAgICAgICAgICAgICAjIHVzci5yb3RhdGlvbi54ID0gKG51bSlwbHJkYXRhLnJvdC54OwogICAgICAgICAgICAgICAgIyB1c3Iucm90YXRpb24ueSA9IChudW0pcGxyZGF0YS5yb3QueTsKCiAgICAgICAgICAgICAgICB1c3Iub2xkcG9zLnggPSAobnVtKSB1c3IubmV3cG9zLng7CiAgICAgICAgICAgICAgICB1c3Iub2xkcG9zLnkgPSAobnVtKSB1c3IubmV3cG9zLnk7CiAgICAgICAgICAgICAgICB1c3Iub2xkcG9zLnogPSAobnVtKSB1c3IubmV3cG9zLno7CgogICAgICAgICAgICAgICAgdXNyLm9sZHJvdC54ID0gKG51bSkgdXNyLm5ld3JvdC54OwogICAgICAgICAgICAgICAgdXNyLm9sZHJvdC55ID0gKG51bSkgdXNyLm5ld3JvdC55OwoKICAgICAgICAgICAgICAgIHVzci5uZXdwb3MueCA9IChudW0pIHBscmRhdGEucG9zLng7CiAgICAgICAgICAgICAgICB1c3IubmV3cG9zLnkgPSAobnVtKSBwbHJkYXRhLnBvcy55KzU7CiAgICAgICAgICAgICAgICB1c3IubmV3cG9zLnogPSAobnVtKSBwbHJkYXRhLnBvcy56OwogICAgICAgICAgICAgICAgdXNyLm5ld3JvdC54ID0gKG51bSkgcGxyZGF0YS5yb3QueDsKICAgICAgICAgICAgICAgIHVzci5uZXdyb3QueSA9IChudW0pIHBscmRhdGEucm90Lnk7CgoKCiAgICAgICAgICAgIH0gZWxzZSBpZiAoKChzdHIpcGxyZGF0YS5pZCAhPShzdHIpcGxyYmh2cl9jX3NlbGYuaWQpICYmICgoc3RyKXBscmJodnJfY19zZWxmLmlkIT0gInVuZGVmaW5lZCIpKXsKICAgICAgICAgICAgICAgIEdBTUUubG9nKCJuZXcgdXNlciIscGxyZGF0YSk7CiAgICAgICAgICAgICAgICAjIEdBTUUubG9nKCJuZXcgdXNlciBmb3VuZC4gY3JlYXRpbmcgbW9kZWwiKTsKICAgICAgICAgICAgICAgICMgR0FNRS5sb2coInVzciIsdXNyKTsKICAgICAgICAgICAgICAgICMgR0FNRS5sb2coInNlbGYiLHBscmJodnJfY19zZWxmKTsKICAgICAgICAgICAgICAgIG9iaiBtb2RlbCA9IEdBTUUuU0NFTkUuYWRkQXNzZXQoIjEzMjZuZXNhIiwwLDUsMCAsMSwiI2ZmZmZmZiIsIHtvcGFjaXR5OjF9KTsKICAgICAgICAgICAgICAgIGFkZFRvIHBscmJodnJfY19wbHJzIHsKICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTooc3RyKXBscmRhdGEubiwKICAgICAgICAgICAgICAgICAgICBpZDooc3RyKXBscmRhdGEuaWQsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ewogICAgICAgICAgICAgICAgICAgICAgICB4IDoobnVtKXBscmRhdGEucG9zLngsCiAgICAgICAgICAgICAgICAgICAgICAgIHkgOihudW0pcGxyZGF0YS5wb3MueSwKICAgICAgICAgICAgICAgICAgICAgICAgeiA6KG51bSlwbHJkYXRhLnBvcy56CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICByb3RhdGlvbjp7CiAgICAgICAgICAgICAgICAgICAgICAgIHg6KG51bSlwbHJkYXRhLnJvdC54LAogICAgICAgICAgICAgICAgICAgICAgICB5OihudW0pcGxyZGF0YS5yb3QueQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgb2xkcm90OnsKICAgICAgICAgICAgICAgICAgICAgICAgeDoobnVtKXBscmRhdGEucm90LngsCiAgICAgICAgICAgICAgICAgICAgICAgIHk6KG51bSlwbHJkYXRhLnJvdC55CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBuZXdyb3Q6ewogICAgICAgICAgICAgICAgICAgICAgICB4OihudW0pcGxyZGF0YS5yb3QueCwKICAgICAgICAgICAgICAgICAgICAgICAgeToobnVtKXBscmRhdGEucm90LnkKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIG9sZHBvczogewogICAgICAgICAgICAgICAgICAgICAgICB4IDoobnVtKXBscmRhdGEucG9zLngsCiAgICAgICAgICAgICAgICAgICAgICAgIHkgOihudW0pcGxyZGF0YS5wb3MueSwKICAgICAgICAgICAgICAgICAgICAgICAgeiA6KG51bSlwbHJkYXRhLnBvcy56CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBuZXdwb3M6IHsKICAgICAgICAgICAgICAgICAgICAgICAgeCA6KG51bSlwbHJkYXRhLnBvcy54LAogICAgICAgICAgICAgICAgICAgICAgICB5IDoobnVtKXBscmRhdGEucG9zLnksCiAgICAgICAgICAgICAgICAgICAgICAgIHogOihudW0pcGxyZGF0YS5wb3MuegogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgbW9kZWw6bW9kZWwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlkID09ICJjbHJwbHJzIil7CiAgICAgICAgZm9yIChudW0gaSA9IGxlbmd0aE9mIHBscmJodnJfY19wbHJzIC0gMTsgaSA+PSAwOyBpKyspewogICAgICAgICAgICBvYmogcGxyID0gcGxyYmh2cl9jX3BscnNbaV07CiAgICAgICAgICAgIHBsci5tb2RlbC5kZWxldGUoKTsKICAgICAgICAgICAgcmVtb3ZlIHBscmJodnJfY19wbHJzW2ldOwogICAgICAgIH0KICAgIH0KfQoKCmFjdGlvbiBwbHJiaHZyX2Nfb25QbGF5ZXJTcGF3bihzdHIgaWQpIHsKICAgIG9iaiB1c3IgPSBwbHJiaHZyX2NfZmluZEJ5SWQoaWQpOwogICAgaWYgKChzdHIpdXNyLmlkIT0idW5kZWZpbmVkIil7CiAgICAgICAgdXNyLm1vZGVsLm9wYWNpdHkgPSAxOwogICAgfQp9CmFjdGlvbiBwbHJiaHZyX2Nfb25QbGF5ZXJEZWF0aChzdHIgaWQsIHN0ciBraWxsZXJJRCkgewogICAgR0FNRS5sb2coInBsciBkaWVkIixpZCk7CiAgICBvYmogdXNyID0gcGxyYmh2cl9jX2ZpbmRCeUlkKGlkKTsKICAgIGlmICgoc3RyKXVzci5pZCE9InVuZGVmaW5lZCIpewogICAgICAgIHVzci5tb2RlbC5vcGFjaXR5ID0gMDsKICAgIH0KfQoKIyBwdWJsaWMgYWN0aW9uIG9uR2FtZUVuZCgpewojICAgICBmb3IgKG51bSBpID0gbGVuZ3RoT2YgcGxyYmh2cl9jX3BscnMgLSAxOyBpID49IDA7IGkrKyl7CiMgICAgICAgICBvYmogcGxyID0gcGxyYmh2cl9jX3BscnNbaV07CiMgICAgICAgICBwbHIubW9kZWwuZGVsZXRlKCk7CiMgICAgICAgICByZW1vdmUgcGxyYmh2cl9jX3BscnNbaV07CiMgICAgIH0KIyB9CgphY3Rpb24gcGxyYmh2cl9jX3N0YXJ0KCl7CiAgICBwbHJiaHZyX2Nfc2VsZiA9IEdBTUUuUExBWUVSUy5nZXRTZWxmKCk7Cn0KCmFjdGlvbiBwbHJiaHZyX2NfcmVuZGVyKG51bSBkZWx0YSl7CiAgICAjIG9ialtdIHBscmJodnJfY19wbHJzID0gR0FNRS5QTEFZRVJTLmxpc3QoKTsKICAgIG9iaiB5b3UgPSBHQU1FLlBMQVlFUlMuZ2V0U2VsZigpOwoJZm9yIChudW0gaT0wOyBpIDwgbGVuZ3RoT2YgcGxyYmh2cl9jX3BscnM7IGkrKykgewoJCW9iaiBwbHIgPSBwbHJiaHZyX2NfcGxyc1tpXTsKICAgICAgICBpZiAocGxyYmh2cl9jX01BWFJFTkRFUkRJU1QgPiBVVElMUy5nZXREaXN0M0QoKG51bSl5b3UucG9zaXRpb24ueCwobnVtKXlvdS5wb3NpdGlvbi55LChudW0peW91LnBvc2l0aW9uLnosKG51bSlwbHIucG9zaXRpb24ueCwobnVtKXBsci5wb3NpdGlvbi55LChudW0pcGxyLnBvc2l0aW9uLnopKSB7CiAgICAgICAgICAgIG9iaiBwb3MgPSBHQU1FLlNDRU5FLnBvc1RvU2NyZWVuKChudW0pIHBsci5tb2RlbC5wb3NpdGlvbi54LCAobnVtKXBsci5tb2RlbC5wb3NpdGlvbi55KzcsIChudW0pcGxyLm1vZGVsLnBvc2l0aW9uLnopOwogICAgICAgICAgICBpZiAoKGJvb2wpcG9zLm9uU2NyZWVuKXsKICAgICAgICAgICAgICAgIEdBTUUuT1ZFUkxBWS5kcmF3VGV4dCgoc3RyKXBsci51c2VybmFtZSwgKG51bSlwb3MueC1wbHJiaHZyX2NfU0laRU5BTUUqMiwgKG51bSlwb3MueSwgMCwgcGxyYmh2cl9jX1NJWkVOQU1FLCAiIiwgIiNGRkZGRkYiLCAxKTsKICAgICAgICAgICAgfQogICAgICAgIH0JCgl9Cn0KCmFjdGlvbiBwbHJiaHZyX2Nfb25QbGF5ZXJVcGRhdGUoc3RyIGlkLCBudW0gZGVsdGEsIG9iaiBpbnB1dHMpIHsKICAgIG9iaiB5b3UgPSBHQU1FLlBMQVlFUlMuZ2V0U2VsZigpOwogICAgIyBHQU1FLmxvZyh5b3UpOwogICAgaWYgKChib29sKXlvdS5vbkdyb3VuZCA9PSB0cnVlKXsKICAgICAgICBwbHJiaHZyX2Nfc2F2ZXN0YXRlID0gewogICAgICAgICAgICBwb3NpdGlvbjp7CiAgICAgICAgICAgICAgICB4OihudW0peW91LnBvc2l0aW9uLngsCiAgICAgICAgICAgICAgICB5OihudW0peW91LnBvc2l0aW9uLnksCiAgICAgICAgICAgICAgICB6OihudW0peW91LnBvc2l0aW9uLnoKICAgICAgICAgICAgfSwKICAgICAgICAgICAgdmVsb2NpdHk6ewogICAgICAgICAgICAgICAgeDoobnVtKXlvdS52ZWxvY2l0eS54LAogICAgICAgICAgICAgICAgeToobnVtKXlvdS52ZWxvY2l0eS55LAogICAgICAgICAgICAgICAgejoobnVtKXlvdS52ZWxvY2l0eS56CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHJvdGF0aW9uOnsKICAgICAgICAgICAgICAgIHg6KG51bSl5b3Uucm90YXRpb24ueCwKICAgICAgICAgICAgICAgIHk6KG51bSl5b3Uucm90YXRpb24ueQogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgIH0KCiAgICBwbHJiaHZyX2NfdG5vdyA9IGdfdG5vdzsKICAgIHBscmJodnJfY19jciA9IChib29sKWlucHV0cy5jcm91Y2g7CiAgICBvYmogdFBsciA9IEdBTUUuUExBWUVSUy5maW5kQnlJRChpZCk7CiAgICAKICAgICNjdXJyZW50bHkgY29sbGlkZXMgd2l0aCBBTEwgb2JqZWN0cwogICAgaWYgKG5vdEVtcHR5IHRQbHIpIHsKICAgICAgICBvYmpbXSByZXMgPSBBQUJCX3Jlc29sdmVwbHIodFBscixwbHJiaHZyX2NfY3Isc3luY29ianNfY19vYmpsaXN0KTsKICAgICAgICBpZiAoKHN0cil0UGxyLnRPbk9iaklkbGUgPT0gInVuZGVmaW5lZCIpewogICAgICAgICAgICB0UGxyLnRPbk9iaklkbGUgPSAwOwogICAgICAgIH0gCiAgICAgICAgaWYgKChzdHIpdFBsci50T25PYmpNb3YgPT0gInVuZGVmaW5lZCIpewogICAgICAgICAgICB0UGxyLnRPbk9iak1vdiA9IDA7CiAgICAgICAgfSAKICAgICAgICBmb3IgKG51bSBpID0gMDsgaSA8IGxlbmd0aE9mIHJlczsgaSsrKXsKICAgICAgICAgICAgb2JqIGNkYXRhID0gcmVzW2ldOwogICAgICAgICAgICBudW0gY29sc2lkZSA9IChudW0pIGNkYXRhLmNvbHNpZGU7CiAgICAgICAgICAgIG9iaiBjb2JqID0gKG9iailjZGF0YS5jb2xvYmo7CgogICAgICAgICAgICBpZiAoY29sc2lkZSA9PSBBQUJCX1lORUcpewogICAgICAgICAgICAgICAgaWYgKChzdHIpaW5wdXRzLm1vdkRpciAhPSJ1bmRlZmluZWQiKXsKICAgICAgICAgICAgICAgICAgICBpZiAoKG51bSl0UGxyLnRPbk9iak1vdiA9PSAwKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdFBsci50T25PYmpNb3YgPSBwbHJiaHZyX2NfdG5vdzsKICAgICAgICAgICAgICAgICAgICAgICAgdFBsci50T25PYmpJZGxlID0gMDsKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgICAgIG51bSBtb3ZEaXIgPSAobnVtKWlucHV0cy5tb3ZEaXI7CiAgICAgICAgICAgICAgICAgICAgbW92RGlyIC09ICgobnVtKWlucHV0cy5tb3VzZVgpOwogICAgICAgICAgICAgICAgICAgICMgdmVsb2NpdHkgcmVsYXRpdmUgdG8gbW92aW5nIHBsYXRmb3JtCiAgICAgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKChudW0pIGNvYmoudmVsb2NpdHkueCkgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRQbHIudmVsb2NpdHkueCA9IChudW0pY29iai52ZWxvY2l0eS54ICsgKHBscmJodnJfY19NQVhXQUxLU1BFRUQgKiBNYXRoLmNvcyhtb3ZEaXIpKSAqIChwbHJiaHZyX2NfdG5vdy0obnVtKXRQbHIudE9uT2JqTW92KS8oKHBscmJodnJfY190bm93LShudW0pdFBsci50T25PYmpNb3YpKzEwMCkgOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoKG51bSkgY29iai52ZWxvY2l0eS56KSA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdFBsci52ZWxvY2l0eS56ID0gKG51bSljb2JqLnZlbG9jaXR5LnogKyAocGxyYmh2cl9jX01BWFdBTEtTUEVFRCAqIE1hdGguc2luKG1vdkRpcikpICogKHBscmJodnJfY190bm93LShudW0pdFBsci50T25PYmpNb3YpLygocGxyYmh2cl9jX3Rub3ctKG51bSl0UGxyLnRPbk9iak1vdikrMTAwKSA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmICgobnVtKXRQbHIudE9uT2JqSWRsZSA9PTApIAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdFBsci50T25PYmpJZGxlID0gcGxyYmh2cl9jX3Rub3c7CiAgICAgICAgICAgICAgICAgICAgICAgIHRQbHIudE9uT2JqTW92ID0gMDsKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgICAgICMgZGVjY2VsZXJhdGUgcmVsYXRpdmUgdG8gbW92aW5nIHBsYXRmb3JtCiAgICAgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKChudW0pIGNvYmoudmVsb2NpdHkueCkgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIChudW0pIHRQbHIudmVsb2NpdHkueCArPSAoKG51bSljb2JqLnZlbG9jaXR5LnggLSAobnVtKXRQbHIudmVsb2NpdHkueCkgKiAocGxyYmh2cl9jX3Rub3ctKG51bSl0UGxyLnRPbk9iaklkbGUpLygocGxyYmh2cl9jX3Rub3ctKG51bSl0UGxyLnRPbk9iaklkbGUpKzE1MCk7CiAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoKG51bSkgY29iai52ZWxvY2l0eS56KSA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgKG51bSkgdFBsci52ZWxvY2l0eS56ICs9ICgobnVtKWNvYmoudmVsb2NpdHkueiAtIChudW0pdFBsci52ZWxvY2l0eS56KSAqIChwbHJiaHZyX2NfdG5vdy0obnVtKXRQbHIudE9uT2JqSWRsZSkvKChwbHJiaHZyX2NfdG5vdy0obnVtKXRQbHIudE9uT2JqSWRsZSkrMTUwKTsKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgfSAgIAogICAgICAgIH0KICAgIH0KfQojIGVudGl0eSBjb21wb25lbnQgc3lzdGVtCiNpbmNsdWRlIDxzeW5jb2Jqc19jLmtybms+CiNpbmNsdWRlIDxwbHJ1dGlsX2Mua3Juaz4KCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojIExpYnJhcnk6IFxsaWJzXEVDU1xlY3NfYy5rcm5rCiMgQXV0aG9yOiBibGFuZHJpY2UKIyAgIERlc2NyaXB0aW9uOiBFbnRpdHkhIENvbXBvbmVudCEgU3lzdGVtISEhCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCgoKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMgYXV0by1kZXRlY3RlZCBwdWJsaWMgYWN0aW9ucyBmcm9tIGxpYnJhcmllcwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KcHVibGljIGFjdGlvbiBvblBsYXllclNwYXduIChzdHIgaWQpewogICAgcGxydXRpbF9jX29uUGxheWVyU3Bhd24oaWQpOwogICAgQUFCQl9vblBsYXllclNwYXduKGlkKTsKICAgIHBscmJodnJfY19vblBsYXllclNwYXduKGlkKTsKfQoKcHVibGljIGFjdGlvbiBzdGFydCAoKXsKICAgIHBscnV0aWxfY19zdGFydCgpOwogICAgc3luY29ianNfY19zdGFydCgpOwogICAgcGxyYmh2cl9jX3N0YXJ0KCk7Cn0KCnB1YmxpYyBhY3Rpb24gcmVuZGVyIChudW0gZGVsdGEpewogICAgcGxyYmh2cl9jX3JlbmRlcihkZWx0YSk7Cn0KCnB1YmxpYyBhY3Rpb24gb25OZXR3b3JrTWVzc2FnZSAoc3RyIGlkLCBvYmogZGF0YSl7CiAgICBzeW5jb2Jqc19jX29uTmV0d29ya01lc3NhZ2UoaWQsICBkYXRhKTsKICAgIHBscmJodnJfY19vbk5ldHdvcmtNZXNzYWdlKGlkLCAgZGF0YSk7Cn0KCnB1YmxpYyBhY3Rpb24gb25QbGF5ZXJVcGRhdGUgKHN0ciBpZCwgbnVtIGRlbHRhLCBvYmogaW5wdXRzKXsKICAgIHBscmJodnJfY19vblBsYXllclVwZGF0ZShpZCwgIGRlbHRhLCAgaW5wdXRzKTsKfQoKcHVibGljIGFjdGlvbiBvbkdhbWVFbmQgKCl7CiAgICBzeW5jb2Jqc19jX29uR2FtZUVuZCgpOwp9CgpwdWJsaWMgYWN0aW9uIHVwZGF0ZSAobnVtIGRlbHRhKXsKICAgIGdfdXBkYXRlKGRlbHRhKTsKICAgIHN5bmNvYmpzX2NfdXBkYXRlKGRlbHRhKTsKICAgIHBscmJodnJfY191cGRhdGUoZGVsdGEpOwp9CgpwdWJsaWMgYWN0aW9uIG9uUGxheWVyRGVhdGggKHN0ciBpZCwgc3RyIGtpbGxlcklEKXsKICAgIHBscnV0aWxfY19vblBsYXllckRlYXRoKGlkLCAga2lsbGVySUQpOwogICAgcGxyYmh2cl9jX29uUGxheWVyRGVhdGgoaWQsICBraWxsZXJJRCk7Cn0KCg==","server":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMgSGVhZGVyOiBcbGlic1x1dGlsc1xnbG9iYWxcZy5rcm5rCiMgQXV0aG9yOiBibGFuZHJpY2UKIyAgIERlc2NyaXB0aW9uOiBzb21lIGdsb2JhbCB2YXJzIHRoYXQgb3RoZXIgbGlicyBjYW4gcmVmZXJlbmNlIHRvIHJlZHVjZSBjYWxscwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCgpudW0gZ190bm93ID0gMDsKCmFjdGlvbiBnX3VwZGF0ZShudW0gZGVsdGEpewogICAgZ190bm93ID0gR0FNRS5USU1FLm5vdygpOwp9CiNpbmNsdWRlIDxnLmtybms+CiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojIExpYnJhcnk6IFxsaWJzXHBscnV0aWxfc19zcGF3bmVkUGxheWVyc1xwbHJ1dGlsX3Mua3JuawojIEF1dGhvcjogYmxhbmRyaWNlCiMgICBEZXNjcmlwdGlvbjogd29ya2Fyb3VuZCB0byBjaGVjayBob3cgbWFueSBwbGF5ZXJzIGFyZSBzcGF3bmVkIGluCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKc3RyW10gcGxydXRpbF9zX3NwYXduZWRQbGF5ZXJzID0gc3RyW107CmJvb2wgcGxydXRpbF9zX3NvbG9nYW1lID0gdHJ1ZTsKbnVtIHBscnV0aWxfc190Rmlyc3RTcGF3bmVkUGxheWVyID0gMDsKbnVtIHBscnV0aWxfc190TGFzdFNwYXduZWRQbGF5ZXIgPSAwOwoKCmFjdGlvbiBwbHJ1dGlsX3Nfc3RhcnQoKSB7CiAgICBwbHJ1dGlsX3Nfc3Bhd25lZFBsYXllcnMgPSBzdHJbXTsKICAgIHBscnV0aWxfc190Rmlyc3RTcGF3bmVkUGxheWVyID0gMDsKICAgIHBscnV0aWxfc190TGFzdFNwYXduZWRQbGF5ZXIgPSAwOwogICAgcGxydXRpbF9zX3NvbG9nYW1lID0gdHJ1ZTsKfQoKCiMgUGxheWVyIGRpZWQKYWN0aW9uIHBscnV0aWxfc19vblBsYXllckRlYXRoKHN0ciBpZCwgc3RyIGtpbGxlcklEKSB7CiAgICBmb3IgKG51bSBpID0gbGVuZ3RoT2YgcGxydXRpbF9zX3NwYXduZWRQbGF5ZXJzLTE7IGkgPj0wOyBpLS0pIHsKICAgICAgICBpZiAoaWQgPT0gcGxydXRpbF9zX3NwYXduZWRQbGF5ZXJzW2ldKSB7CiAgICAgICAgICAgIHJlbW92ZSBwbHJ1dGlsX3Nfc3Bhd25lZFBsYXllcnNbaV07CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KfQojIFdoZW4gYSBwbGF5ZXIgbGVhdmVzIHRoZSBzZXJ2ZXIKYWN0aW9uIHBscnV0aWxfc19vblBsYXllckxlYXZlKHN0ciBwbGF5ZXJJRCkgewogICAgZm9yIChudW0gaSA9IGxlbmd0aE9mIHBscnV0aWxfc19zcGF3bmVkUGxheWVycy0xOyBpID49MDsgaS0tKSB7CiAgICAgICAgaWYgKHBsYXllcklEID09IHBscnV0aWxfc19zcGF3bmVkUGxheWVyc1tpXSkgewogICAgICAgICAgICByZW1vdmUgcGxydXRpbF9zX3NwYXduZWRQbGF5ZXJzW2ldOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICB9Cn0KIyBTcGF3biBOb3RpZmljYXRpb24gbXVzdCBjb21lIGZyb20gQ2xpZW50CmFjdGlvbiBwbHJ1dGlsX3Nfb25OZXR3b3JrTWVzc2FnZShzdHIgaWQsIG9iaiBkYXRhLCBzdHIgcGxheWVySUQpIHsKICAgIGlmIChpZCA9PSAic3Bhd24iKSB7CiAgICAgICAgYm9vbCBoYXNTcGF3bmVkID0gZmFsc2U7CiAgICAgICAgZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBwbHJ1dGlsX3Nfc3Bhd25lZFBsYXllcnM7IGkrKykgewogICAgICAgICAgICBpZiAocGxydXRpbF9zX3NwYXduZWRQbGF5ZXJzW2ldID09IGlkKSB7CiAgICAgICAgICAgICAgICBoYXNTcGF3bmVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICghaGFzU3Bhd25lZCkge2FkZFRvIHBscnV0aWxfc19zcGF3bmVkUGxheWVycyBwbGF5ZXJJRDt9CiAgICAgICAgaWYgKGxlbmd0aE9mIHBscnV0aWxfc19zcGF3bmVkUGxheWVycyA+PSAyKSB7cGxydXRpbF9zX3NvbG9nYW1lID0gZmFsc2U7fQogICAgICAgIGlmIChwbHJ1dGlsX3NfdEZpcnN0U3Bhd25lZFBsYXllciA9PSAwKSB7cGxydXRpbF9zX3RGaXJzdFNwYXduZWRQbGF5ZXIgPSBnX3Rub3c7fQogICAgICAgIHBscnV0aWxfc190TGFzdFNwYXduZWRQbGF5ZXIgPSBnX3Rub3c7CiAgICB9Cn0KIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMgTGlicmFyeTogbGlic1x1dGlsc1xwbHJiZWhhdmlvclxwbHJiaHZyX3Mua3JuawojIEF1dGhvcjogYmxhbmRyaWNlCiMgICBEZXNjcmlwdGlvbjogZGlzYWJsZSBzZXJ2ZXIgc3luYyArIGJlaGF2aW9yIGZvciBjdXN0b20gbW92ZW1lbnQKIyAgIHNlbmQgcGxyIHBvc2l0aW9uL3ZlbCB0byBzZXJ2ZXIgbWFudWFsbHkKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpudW0gcGxyYmh2cl9zX3RsYXN0YnJvYWRjYXN0ID0gMDsKbnVtIHBscmJodnJfc19JTlRFUlZBTF9CUk9BRENBU1QgPSAxMDA7CnN0cltdIHBscmJodnJfc19wbHJzbGVmdCA9IHN0cltdOwoKYWN0aW9uIHBscmJodnJfc19zdGFydCgpewogICAgR0FNRS5ERUZBVUxULmRpc2FibGVTZXJ2ZXJTeW5jKCk7CglHQU1FLkRFRkFVTFQuZGlzYWJsZVBsYXllckJlaGF2aW91cigpOwp9CgphY3Rpb24gcGxyYmh2cl9zX29uTmV0d29ya01lc3NhZ2Uoc3RyIGlkLCBvYmogZGF0YSwgc3RyIHBsYXllcklEKSB7CiAgICBvYmogcGxyID0gR0FNRS5QTEFZRVJTLmZpbmRCeUlEKHBsYXllcklEKTsKICAgIGlmIChpZCA9PSAicGxyYmh2ciIpewogICAgICAgIHBsci5wb3NpdGlvbi54ID0gKG51bSlkYXRhLnBvc2l0aW9uLng7CiAgICAgICAgcGxyLnBvc2l0aW9uLnkgPSAobnVtKWRhdGEucG9zaXRpb24ueTsKICAgICAgICBwbHIucG9zaXRpb24ueiA9IChudW0pZGF0YS5wb3NpdGlvbi56OwogICAgICAgIHBsci52ZWxvY2l0eS54ID0gKG51bSlkYXRhLnZlbG9jaXR5Lng7CiAgICAgICAgcGxyLnZlbG9jaXR5LnkgPSAobnVtKWRhdGEudmVsb2NpdHkueTsKICAgICAgICBwbHIudmVsb2NpdHkueiA9IChudW0pZGF0YS52ZWxvY2l0eS56OwogICAgICAgIHBsci5yb3RhdGlvbi54ID0gKG51bSlkYXRhLnJvdGF0aW9uLng7CiAgICAgICAgcGxyLnJvdGF0aW9uLnkgPSAobnVtKWRhdGEucm90YXRpb24ueTsKICAgIH0gICAKfQoKYWN0aW9uIHBscmJodnJfc191cGRhdGUobnVtIGRlbHRhKSB7CiAgICBvYmpbXSBwbHJzID0gR0FNRS5QTEFZRVJTLmxpc3QoKTsKICAgIG9ialtdIHBscnNwb3Nyb3QgPSBvYmpbXTsKICAgIGlmICgoZ190bm93IC0gcGxyYmh2cl9zX3RsYXN0YnJvYWRjYXN0KSA+IHBscmJodnJfc19JTlRFUlZBTF9CUk9BRENBU1QpewogICAgICAgIHBscmJodnJfc190bGFzdGJyb2FkY2FzdCA9IGdfdG5vdzsKCiAgICAgICAgZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBwbHJzOyBpKyspewogICAgICAgICAgICBvYmogcGxyID0gcGxyc1tpXTsKICAgICAgICAgICAgYWRkVG8gcGxyc3Bvc3JvdCB7CiAgICAgICAgICAgICAgICBuOiAoc3RyKXBsci51c2VybmFtZSwKICAgICAgICAgICAgICAgIGlkOiAoc3RyKXBsci5pZCwKICAgICAgICAgICAgICAgIHBvczp7CiAgICAgICAgICAgICAgICAgICAgeDpNYXRoLnJvdW5kKChudW0pcGxyLnBvc2l0aW9uLngpLAogICAgICAgICAgICAgICAgICAgIHk6TWF0aC5yb3VuZCgobnVtKXBsci5wb3NpdGlvbi55KSwKICAgICAgICAgICAgICAgICAgICB6Ok1hdGgucm91bmQoKG51bSlwbHIucG9zaXRpb24ueikKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICByb3Q6IHsKICAgICAgICAgICAgICAgICAgICB4Ok1hdGgucm91bmREZWNpbWFsKChudW0pcGxyLnJvdGF0aW9uLngsMiksCiAgICAgICAgICAgICAgICAgICAgeTpNYXRoLnJvdW5kRGVjaW1hbCgobnVtKXBsci5yb3RhdGlvbi55LDIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIEdBTUUuTkVUV09SSy5icm9hZGNhc3QoInBscnMiLCB7cGxyczpwbHJzcG9zcm90LGxlZnQ6cGxyYmh2cl9zX3BscnNsZWZ0fSk7CiAgICAgICAgcGxyYmh2cl9zX3BscnNsZWZ0ID0gc3RyW107CiAgICB9CiAgICAKICAgIAp9CgojIHB1YmxpYyBhY3Rpb24gb25QbGF5ZXJTcGF3bihzdHIgaWQpIHt9CiMgcHVibGljIGFjdGlvbiBvblBsYXllckRlYXRoKHN0ciBpZCwgc3RyIGtpbGxlcklEKSB7fQphY3Rpb24gcGxyYmh2cl9zX29uUGxheWVyTGVhdmUoc3RyIHBsYXllcklEKSB7CiAgICBHQU1FLmxvZygicGxheWVyIGxlZnQiKTsKICAgIGFkZFRvIHBscmJodnJfc19wbHJzbGVmdCBwbGF5ZXJJRDsKCn0KCmFjdGlvbiBwbHJiaHZyX3Nfb25HYW1lRW5kKCl7CiAgICBHQU1FLk5FVFdPUksuYnJvYWRjYXN0KCJjbHJwbHJzIiwge30pOwp9CiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojIEhlYWRlcjogXGxpYnNcY29sbGlzaW9uc1xBQUJCLmtybmsKIyBBdXRob3I6IEtHMDcgKG1vZGlmaWVkIGJ5IGJsYW5kcmljZSkKIyBEZXNjcmlwdGlvbjogQUFCQiAoYXhpcy1hbGlnbmVkIGJvdW5kaW5nIGJveC1ib3gpIGNvbGxpc2lvbiArIHJlc29sdXRpb24KIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpudW0gQUFCQl93ID0gNC45OyMgcGxheWVyIHdpZHRoCm51bSBBQUJCX2MgPSA4OyMgY3JvdWNoaW5nIGhlaWdodApudW0gQUFCQl9IID0gMTE7IyBzdGFuZGluZyBoZWlnaHQKCm51bSBBQUJCX1hORUcgPSAweDE7Cm51bSBBQUJCX1hQT1MgPSAweDI7Cm51bSBBQUJCX1lORUcgPSAweDQ7ICNoaXQgImdyb3VuZCIKbnVtIEFBQkJfWVBPUyA9IDB4ODsgCm51bSBBQUJCX1pORUcgPSAweDEwOwpudW0gQUFCQl9aUE9TID0gMHgyMDsKCiMgY29sbGlkZSB0eXBlcwpudW0gQUFCQl9DT0xfTk9ORSA9IDB4MDsgIyBubyBjb2xsaWRlCm51bSBBQUJCX0NPTF9XT1JMRCA9IDB4MDE7ICMgb2JqZWN0IGNhbiBjb2xsaWRlIHdpdGggd29ybGQKbnVtIEFBQkJfQ09MX09CSlMgPSAweDAyOyAjIG9iamVjdCBjYW4gY29sbGlkZSB3aXRoIG90aGVyIG9iamVjdHMKbnVtIEFBQkJfQ09MX1BMUlMgPSAweDA0OyAjIG9iamVjdCBjYW4gQUFCQl9kZXRlY3QgY29sbGlkZSB3aXRoIHBsYXllcgpudW0gQUFCQl9DT0xfT0JKMlBMUlMgPSAweDA4OyAjICMgcGxheWVyIGNhbiBjb2xsaWRlIHdpdGggb2JqZWN0ICh1c3VhbGx5IHJlc29sdmVzIGNvbGxpZGUuIGN1cnJlbnRseSBkZWZhdWx0IHRoaXMgZG9lcyBub3QgbWF0dGVyKQoKYm9vbCBhY3Rpb24gQUFCQl9pc0NvbGxpc2lvbihvYmogY3ViZTEsIG9iaiBjdWJlMikKewogICAgIyBBZGFwdGVkIGZyb20gaHR0cHM6Ly90dXRvcmlhbGVkZ2UubmV0L2dhbWVkZXYvYWFiYi1jb2xsaXNpb24tZGV0ZWN0aW9uLXR1dG9yaWFsLwogICAgbnVtIGR4ID0gTWF0aC5hYnMoKG51bSljdWJlMS5wb3NpdGlvbi54IC0gKG51bSljdWJlMi5wb3NpdGlvbi54KSAtICgobnVtKWN1YmUxLnNjYWxlLngvMiArIChudW0pY3ViZTIuc2NhbGUueC8yKTsKICAgIG51bSBkeSA9IE1hdGguYWJzKChudW0pY3ViZTEucG9zaXRpb24ueSArKG51bSljdWJlMS5zY2FsZS55LzIgLSAobnVtKWN1YmUyLnBvc2l0aW9uLnkgLSAobnVtKWN1YmUyLnNjYWxlLnkvMikgLSAoKG51bSljdWJlMS5zY2FsZS55LzIgKyAobnVtKWN1YmUyLnNjYWxlLnkvMik7CiAgICBudW0gZHogPSAoTWF0aC5hYnMoKG51bSljdWJlMS5wb3NpdGlvbi56IC0gKG51bSljdWJlMi5wb3NpdGlvbi56KSAtICgobnVtKWN1YmUxLnNjYWxlLnovMiArIChudW0pY3ViZTIuc2NhbGUuei8yKSk7CiAgICBpZiAoKGR4IDwgMCkgJiYgKGR5IDwgMCkgJiYgKGR6IDwgMCkpCiAgICB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgCn0KCm9iaiBhY3Rpb24gQUFCQl9DYWxjdWxhdGVBYWJiRGlzdGFuY2VUbyhvYmogY3ViZTEsIG9iaiBjdWJlMikKewogICAgbnVtIGR4ID0gTWF0aC5hYnMoKG51bSljdWJlMS5wb3NpdGlvbi54IC0gKG51bSljdWJlMi5wb3NpdGlvbi54KSAtICgobnVtKWN1YmUxLnNjYWxlLngvMiArIChudW0pY3ViZTIuc2NhbGUueC8yKTsKICAgIG51bSBkeSA9IE1hdGguYWJzKChudW0pY3ViZTEucG9zaXRpb24ueSArKG51bSljdWJlMS5zY2FsZS55LzIgLSAobnVtKWN1YmUyLnBvc2l0aW9uLnkgLSAobnVtKWN1YmUyLnNjYWxlLnkvMikgLSAoKG51bSljdWJlMS5zY2FsZS55LzIgKyAobnVtKWN1YmUyLnNjYWxlLnkvMik7CiAgICBudW0gZHogPSAoTWF0aC5hYnMoKG51bSljdWJlMS5wb3NpdGlvbi56IC0gKG51bSljdWJlMi5wb3NpdGlvbi56KSAtICgobnVtKWN1YmUxLnNjYWxlLnovMiArIChudW0pY3ViZTIuc2NhbGUuei8yKSk7CgogICAgcmV0dXJuIHt4OmR4LHk6ZHksejpken07Cn0KCm51bSBBQUJCX3N0ID0gMzsjc3RhaXIgaGVpZ2h0CgpudW0gYWN0aW9uIEFBQkJfc2lkZShudW0gQywgbnVtIFMsIG51bSBpbnB1dCl7CglpZihpbnB1dCA8PSBDLVMpe3JldHVybiAtMTt9CglpZihpbnB1dCA+PSBDK1Mpe3JldHVybiAxO30KCXJldHVybiAwOwp9CgpvYmpbXSBhY3Rpb24gQUFCQl9yZXNvbHZlKG9iaiBjdWJlMSxvYmpbXSBjdWJlcykgewogICAgb2JqW10gY29sbGlzaW9ucyA9IG9ialtdOwogICAgbnVtIHRvdGFsY29sc2lkZSA9IDA7Cglmb3IobnVtIGkgPSAwOyBpIDwgbGVuZ3RoT2YgY3ViZXM7IGkrKyl7CiAgICAgICAgbnVtIGNvbHNpZGUgPSAwOwogICAgICAgIG9iaiBjb2xvYmogPSB7fTsKCiAgICAgICAgbnVtIHB4ID0gKG51bSkgY3ViZTEucG9zaXRpb24ueDsKICAgICAgICBudW0gcHkgPSAobnVtKSBjdWJlMS5wb3NpdGlvbi55OwogICAgICAgIG51bSBweiA9IChudW0pIGN1YmUxLnBvc2l0aW9uLno7CiAgICAgICAgbnVtIHZ4ID0gKG51bSkgY3ViZTEudmVsb2NpdHkueDsKICAgICAgICBudW0gdnkgPSAobnVtKSBjdWJlMS52ZWxvY2l0eS55OwogICAgICAgIG51bSB2eiA9IChudW0pIGN1YmUxLnZlbG9jaXR5Lno7CiAgICAgICAgCiAgICAgICAgbnVtIGNzeCA9IChudW0pIGN1YmUxLnNjYWxlLngvMjsKICAgICAgICBudW0gY3N5ID0gKG51bSkgY3ViZTEuc2NhbGUueS8yOwogICAgICAgIG51bSBjc3ogPSAobnVtKSBjdWJlMS5zY2FsZS56LzI7CgogICAgICAgIG9iaiB0Y3ViZSA9IGN1YmVzW2ldOwogICAgICAgIGlmIChub3RFbXB0eSAob2JqKXRjdWJlLmNvbGxpZGUpCiAgICAgICAgewogICAgICAgICAgICBpZiAoISgobnVtKXRjdWJlLmNvbGxpZGUudHlwZSAmIEFBQkJfQ09MX09CSjJQTFJTKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29udGludWU7ICMgc2tpcCB0aGlzIG9iamVjdCBpZiBpdCBpcyBub3QgY29sbGlkYWJsZQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIG51bSBjeCA9IChudW0pIHRjdWJlLnBvc2l0aW9uLng7CiAgICAgICAgbnVtIGN5ID0gKG51bSkgdGN1YmUucG9zaXRpb24ueTsKICAgICAgICBudW0gY3ogPSAobnVtKSB0Y3ViZS5wb3NpdGlvbi56OwogICAgICAgIG51bSBzeCA9IChudW0pIHRjdWJlLnNjYWxlLnggLyAyOwogICAgICAgIG51bSBzeSA9IChudW0pIHRjdWJlLnNjYWxlLnkgLyAyOwogICAgICAgIG51bSBzeiA9IChudW0pIHRjdWJlLnNjYWxlLnogLyAyOwogICAgICAgIG51bSBvcHggPSBweDsKICAgICAgICBudW0gb3B5ID0gcHk7CiAgICAgICAgbnVtIG9weiA9IHB6OwogICAgICAgIG51bSBvY3ggPSBjeDsKICAgICAgICBudW0gb2N5ID0gY3k7CiAgICAgICAgbnVtIG9jeiA9IGN6OwogICAgICAgIAogICAgICAgIGlmIChub3RFbXB0eSAob2JqKSBjdWJlMS5vZ3Bvcyl7CiAgICAgICAgICAgIG9weCA9IChudW0pY3ViZTEub2dwb3MueDsKICAgICAgICAgICAgb3B5ID0gKG51bSljdWJlMS5vZ3Bvcy55OwogICAgICAgICAgICBvcHogPSAobnVtKWN1YmUxLm9ncG9zLno7CiAgICAgICAgfSBpZiAobm90RW1wdHkgKG9iail0Y3ViZS5vZ3Bvcyl7CiAgICAgICAgICAgIG9jeCA9IChudW0pdGN1YmUub2dwb3MueDsKICAgICAgICAgICAgb2N5ID0gKG51bSl0Y3ViZS5vZ3Bvcy55OwogICAgICAgICAgICBvY3ogPSAobnVtKXRjdWJlLm9ncG9zLno7CiAgICAgICAgfQogICAgICAgIAogICAgICAgICMgLXgKICAgICAgICBpZihweCA8PSBjeCArIHN4ICsgY3N4ICYmIG9weCA+PSBvY3ggKyBzeCArIGNzeCAmJiBBQUJCX3NpZGUoY3osIHN6ICsgY3N6LCBweikgPT0gMCAmJiBBQUJCX3NpZGUoY3kgKyBzeSwgc3kgKyBjc3ksIHB5ICsgY3N5KSA9PSAwKXsKICAgICAgICAgICAgaWYocHkgPj0gY3kgKyAyICogc3kgLSBBQUJCX3N0ICYmICgoYm9vbCkgY3ViZTEub25Hcm91bmQpKXsKICAgICAgICAgICAgICAgIGN1YmUxLnBvc2l0aW9uLnkgPSBjeSArIDIgKiBzeTsgCiAgICAgICAgICAgICAgICBjdWJlMS52ZWxvY2l0eS55ID0gKG5vdEVtcHR5IChvYmopdGN1YmUudmVsb2NpdHkpID8gKG51bSl0Y3ViZS52ZWxvY2l0eS55IDogMDsKICAgICAgICAgICAgICAgIGN1YmUxLm9uR3JvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgIGN1YmUxLnBvc2l0aW9uLnggPSBjeCArIHN4ICsgY3N4OwogICAgICAgICAgICAgICAgY3ViZTEudmVsb2NpdHkueCA9IChub3RFbXB0eSAob2JqKXRjdWJlLnZlbG9jaXR5KSA/IChudW0pdGN1YmUudmVsb2NpdHkueCA6IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY3ViZTEub25XYWxsID0gdHJ1ZTsKICAgICAgICAgICAgY29sc2lkZSB8PSBBQUJCX1hORUc7CiAgICAgICAgfQogICAgICAgICMgK3gKICAgICAgICBpZihweCA+PSBjeCAtIHN4IC0gY3N4ICYmIG9weCA8PSBvY3ggLSBzeCAtIGNzeCAmJiBBQUJCX3NpZGUoY3osIHN6ICsgY3N6LCBweikgPT0gMCAmJiBBQUJCX3NpZGUoY3kgKyBzeSwgc3kgKyBjc3ksIHB5ICsgY3N5KSA9PSAwKXsKICAgICAgICAgICAgaWYocHkgPj0gY3kgKyAyICogc3kgLSBBQUJCX3N0ICYmICgoYm9vbCkgY3ViZTEub25Hcm91bmQpKXsKICAgICAgICAgICAgICAgIGN1YmUxLnBvc2l0aW9uLnkgPSBjeSArIDIgKiBzeTsgCiAgICAgICAgICAgICAgICBjdWJlMS52ZWxvY2l0eS55ID0gKG5vdEVtcHR5IChvYmopdGN1YmUudmVsb2NpdHkpID8gKG51bSl0Y3ViZS52ZWxvY2l0eS55IDogMDsKICAgICAgICAgICAgICAgIGN1YmUxLm9uR3JvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgIGN1YmUxLnBvc2l0aW9uLnggPSBjeCAtIHN4IC0gY3N4OwogICAgICAgICAgICAgICAgY3ViZTEudmVsb2NpdHkueCA9IChub3RFbXB0eSAob2JqKXRjdWJlLnZlbG9jaXR5KSA/IChudW0pdGN1YmUudmVsb2NpdHkueCA6IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY3ViZTEub25XYWxsID0gdHJ1ZTsKICAgICAgICAgICAgY29sc2lkZSB8PSBBQUJCX1hQT1M7CiAgICAgICAgfQogICAgICAgICMgLXkKICAgICAgICBpZihweSA8PSBjeSArIDIgKiBzeSAmJiBvcHkgPj0gb2N5ICsgMiAqIHN5ICYmIEFBQkJfc2lkZShjeCwgc3ggKyBjc3gsIHB4KSA9PSAwICYmIEFBQkJfc2lkZShjeiwgc3ogKyBjc3osIHB6KSA9PSAwKXsKICAgICAgICAgICAgY3ViZTEucG9zaXRpb24ueSA9IGN5ICsgMiAqIHN5OwogICAgICAgICAgICBjdWJlMS52ZWxvY2l0eS55ID0gKG5vdEVtcHR5IChvYmopdGN1YmUudmVsb2NpdHkpID8gKG51bSl0Y3ViZS52ZWxvY2l0eS55IDogMDsKICAgICAgICAgICAgY3ViZTEub25Hcm91bmQgPSB0cnVlOwogICAgICAgICAgICBjb2xzaWRlIHw9IEFBQkJfWU5FRzsKICAgICAgICB9CiAgICAgICAgIyAreQogICAgICAgIGlmKHB5ICsgMiAqIGNzeSA+PSBjeSAmJiBvcHkgKyAyICogY3N5IDw9IG9jeSAmJiBBQUJCX3NpZGUoY3gsIHN4ICsgY3N4LCBweCkgPT0gMCAmJiBBQUJCX3NpZGUoY3osIHN6ICsgY3N6LCBweikgPT0gMCl7CiAgICAgICAgICAgIGN1YmUxLnBvc2l0aW9uLnkgPSBjeSAtIDIgKiBjc3k7CiAgICAgICAgICAgIGN1YmUxLnZlbG9jaXR5LnkgPSAobm90RW1wdHkgKG9iail0Y3ViZS52ZWxvY2l0eSkgPyAobnVtKXRjdWJlLnZlbG9jaXR5LnkgOiAwOwogICAgICAgICAgICBjb2xzaWRlIHw9IEFBQkJfWVBPUzsKICAgICAgICB9CiAgICAgICAgIyAtegogICAgICAgIGlmKHB6IDw9IGN6ICsgc3ogKyBjc3ogJiYgb3B6ID49IG9jeiArIHN6ICsgY3N6ICYmIEFBQkJfc2lkZShjeCwgc3ggKyBjc3gsIHB4KSA9PSAwICYmIEFBQkJfc2lkZShjeSArIHN5LCBzeSArIGNzeiwgcHkgKyBjc3opID09IDApewogICAgICAgICAgICBpZihweSA+PSBjeSArIDIgKiBzeSAtIEFBQkJfc3QgJiYgKChib29sKSBjdWJlMS5vbkdyb3VuZCkpewogICAgICAgICAgICAgICAgY3ViZTEucG9zaXRpb24ueSA9IGN5ICsgMiAqIHN5OyAKICAgICAgICAgICAgICAgIGN1YmUxLnZlbG9jaXR5LnkgPSAobm90RW1wdHkgKG9iail0Y3ViZS52ZWxvY2l0eSkgPyAobnVtKXRjdWJlLnZlbG9jaXR5LnkgOiAwOwogICAgICAgICAgICAgICAgY3ViZTEub25Hcm91bmQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICBjdWJlMS5wb3NpdGlvbi56ID0gY3ogKyBzeiArIGNzejsKICAgICAgICAgICAgICAgIGN1YmUxLnZlbG9jaXR5LnogPSAobm90RW1wdHkgKG9iail0Y3ViZS52ZWxvY2l0eSkgPyAobnVtKXRjdWJlLnZlbG9jaXR5LnogOiAwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBjdWJlMS5vbldhbGwgPSB0cnVlOwogICAgICAgICAgICBjb2xzaWRlIHw9IEFBQkJfWk5FRzsKICAgICAgICB9CiAgICAgICAgIyAregogICAgICAgIGlmKHB6ID49IGN6IC0gc3ogLSBjc3ogJiYgb3B6IDw9IG9jeiAtIHN6IC0gY3N6ICYmIEFBQkJfc2lkZShjeCwgc3ggKyBjc3gsIHB4KSA9PSAwICYmIEFBQkJfc2lkZShjeSArIHN5LCBzeSArIGNzeSwgcHkgKyBjc3kpID09IDApewogICAgICAgICAgICBpZihweSA+PSBjeSArIDIgKiBzeSAtIEFBQkJfc3QgJiYgKChib29sKSBjdWJlMS5vbkdyb3VuZCkpewogICAgICAgICAgICAgICAgY3ViZTEucG9zaXRpb24ueSA9IGN5ICsgMiAqIHN5OyAKICAgICAgICAgICAgICAgIGN1YmUxLnZlbG9jaXR5LnkgPSAobm90RW1wdHkgKG9iail0Y3ViZS52ZWxvY2l0eSkgPyAobnVtKXRjdWJlLnZlbG9jaXR5LnkgOiAwOyAKICAgICAgICAgICAgICAgIGN1YmUxLm9uR3JvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgY3ViZTEucG9zaXRpb24ueiA9IGN6IC0gc3ogLSBjc3o7CiAgICAgICAgICAgICAgICBjdWJlMS52ZWxvY2l0eS56ID0gKG5vdEVtcHR5IChvYmopdGN1YmUudmVsb2NpdHkpID8gKG51bSl0Y3ViZS52ZWxvY2l0eS56IDogMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBjdWJlMS5vbldhbGwgPSB0cnVlOwogICAgICAgICAgICBjb2xzaWRlIHw9IEFBQkJfWlBPUzsKICAgICAgICB9CiAgICAgICAgaWYgKGNvbHNpZGUgPiAwKXsKICAgICAgICAgICAgY29sb2JqID0gdGN1YmU7CiAgICAgICAgICAgIGFkZFRvIGNvbGxpc2lvbnMge2NvbHNpZGU6Y29sc2lkZSxjb2xvYmo6Y29sb2JqfTsKICAgICAgICB9IAogICAgICAgIHRvdGFsY29sc2lkZSB8PSBjb2xzaWRlOwoJfQogICAgaWYgKG5vdEVtcHR5IChvYmopY3ViZTEub2dwb3MpIHsKICAgICAgICBjdWJlMS5vZ3Bvcy54ID0gKG51bSkgY3ViZTEucG9zaXRpb24ueCArIDA7CiAgICAgICAgY3ViZTEub2dwb3MueSA9IChudW0pIGN1YmUxLnBvc2l0aW9uLnkgKyAwOwogICAgICAgIGN1YmUxLm9ncG9zLnogPSAobnVtKSBjdWJlMS5wb3NpdGlvbi56ICsgMDsKICAgIH0gZWxzZSB7CiAgICAgICAgY3ViZTEub2dwb3MgPSAKICAgICAgICB7CiAgICAgICAgICAgIHg6KG51bSljdWJlMS5wb3NpdGlvbi54ICsgMCwKICAgICAgICAgICAgeToobnVtKWN1YmUxLnBvc2l0aW9uLnkgKyAwLAogICAgICAgICAgICB6OihudW0pY3ViZTEucG9zaXRpb24ueiArIDAKICAgICAgICB9OwogICAgfQogICAgIyBHQU1FLmxvZyhjb2xsaXNpb25zKTsKICAgIHJldHVybiBjb2xsaXNpb25zOwoJCn0KCm9ialtdIGFjdGlvbiBBQUJCX2RldGVjdChvYmogY3ViZTEsb2JqW10gY3ViZXMpIHsKICAgIG9ialtdIGNvbGxpc2lvbnMgPSBvYmpbXTsKICAgIG51bSB0b3RhbGNvbHNpZGUgPSAwOwoJZm9yKG51bSBpID0gMDsgaSA8IGxlbmd0aE9mIGN1YmVzOyBpKyspewogICAgICAgIG51bSBjb2xzaWRlID0gMDsKICAgICAgICBvYmogY29sb2JqID0ge307CgogICAgICAgIG51bSBweCA9IChudW0pIGN1YmUxLnBvc2l0aW9uLng7CiAgICAgICAgbnVtIHB5ID0gKG51bSkgY3ViZTEucG9zaXRpb24ueTsKICAgICAgICBudW0gcHogPSAobnVtKSBjdWJlMS5wb3NpdGlvbi56OwogICAgICAgIG51bSB2eCA9IChudW0pIGN1YmUxLnZlbG9jaXR5Lng7CiAgICAgICAgbnVtIHZ5ID0gKG51bSkgY3ViZTEudmVsb2NpdHkueTsKICAgICAgICBudW0gdnogPSAobnVtKSBjdWJlMS52ZWxvY2l0eS56OwogICAgICAgIAogICAgICAgIG51bSBjc3ggPSAobnVtKSBjdWJlMS5zY2FsZS54LzI7CiAgICAgICAgbnVtIGNzeSA9IChudW0pIGN1YmUxLnNjYWxlLnkvMjsKICAgICAgICBudW0gY3N6ID0gKG51bSkgY3ViZTEuc2NhbGUuei8yOwoKICAgICAgICBvYmogdGN1YmUgPSBjdWJlc1tpXTsKICAgICAgICBudW0gY3ggPSAobnVtKSB0Y3ViZS5wb3NpdGlvbi54OwogICAgICAgIG51bSBjeSA9IChudW0pIHRjdWJlLnBvc2l0aW9uLnk7CiAgICAgICAgbnVtIGN6ID0gKG51bSkgdGN1YmUucG9zaXRpb24uejsKICAgICAgICBudW0gc3ggPSAobnVtKSB0Y3ViZS5zY2FsZS54IC8gMjsKICAgICAgICBudW0gc3kgPSAobnVtKSB0Y3ViZS5zY2FsZS55IC8gMjsKICAgICAgICBudW0gc3ogPSAobnVtKSB0Y3ViZS5zY2FsZS56IC8gMjsKICAgICAgICBudW0gb3B4ID0gcHg7CiAgICAgICAgbnVtIG9weSA9IHB5OwogICAgICAgIG51bSBvcHogPSBwejsKICAgICAgICBudW0gb2N4ID0gY3g7CiAgICAgICAgbnVtIG9jeSA9IGN5OwogICAgICAgIG51bSBvY3ogPSBjejsKICAgICAgICAKICAgICAgICBpZiAobm90RW1wdHkgKG9iaikgY3ViZTEub2dwb3MpewogICAgICAgICAgICBvcHggPSAobnVtKWN1YmUxLm9ncG9zLng7CiAgICAgICAgICAgIG9weSA9IChudW0pY3ViZTEub2dwb3MueTsKICAgICAgICAgICAgb3B6ID0gKG51bSljdWJlMS5vZ3Bvcy56OwogICAgICAgIH0gaWYgKG5vdEVtcHR5IChvYmopdGN1YmUub2dwb3MpewogICAgICAgICAgICBvY3ggPSAobnVtKXRjdWJlLm9ncG9zLng7CiAgICAgICAgICAgIG9jeSA9IChudW0pdGN1YmUub2dwb3MueTsKICAgICAgICAgICAgb2N6ID0gKG51bSl0Y3ViZS5vZ3Bvcy56OwogICAgICAgIH0KICAgICAgICAKICAgICAgICAjIC14CiAgICAgICAgaWYocHggPD0gY3ggKyBzeCArIGNzeCAmJiBvcHggPj0gb2N4ICsgc3ggKyBjc3ggJiYgQUFCQl9zaWRlKGN6LCBzeiArIGNzeiwgcHopID09IDAgJiYgQUFCQl9zaWRlKGN5ICsgc3ksIHN5ICsgY3N5LCBweSArIGNzeSkgPT0gMCl7CiAgICAgICAgICAgIGlmKHB5ID49IGN5ICsgMiAqIHN5IC0gQUFCQl9zdCAmJiAoKGJvb2wpIGN1YmUxLm9uR3JvdW5kKSl7CiAgICAgICAgICAgICAgICBjdWJlMS5vbkdyb3VuZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY3ViZTEub25XYWxsID0gdHJ1ZTsKICAgICAgICAgICAgY29sc2lkZSB8PSBBQUJCX1hORUc7CiAgICAgICAgfQogICAgICAgICMgK3gKICAgICAgICBpZihweCA+PSBjeCAtIHN4IC0gY3N4ICYmIG9weCA8PSBvY3ggLSBzeCAtIGNzeCAmJiBBQUJCX3NpZGUoY3osIHN6ICsgY3N6LCBweikgPT0gMCAmJiBBQUJCX3NpZGUoY3kgKyBzeSwgc3kgKyBjc3ksIHB5ICsgY3N5KSA9PSAwKXsKICAgICAgICAgICAgaWYocHkgPj0gY3kgKyAyICogc3kgLSBBQUJCX3N0ICYmICgoYm9vbCkgY3ViZTEub25Hcm91bmQpKXsKICAgICAgICAgICAgICAgIGN1YmUxLm9uR3JvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjdWJlMS5vbldhbGwgPSB0cnVlOwogICAgICAgICAgICBjb2xzaWRlIHw9IEFBQkJfWFBPUzsKICAgICAgICB9CiAgICAgICAgIyAteQogICAgICAgIGlmKHB5IDw9IGN5ICsgMiAqIHN5ICYmIG9weSA+PSBvY3kgKyAyICogc3kgJiYgQUFCQl9zaWRlKGN4LCBzeCArIGNzeCwgcHgpID09IDAgJiYgQUFCQl9zaWRlKGN6LCBzeiArIGNzeiwgcHopID09IDApewogICAgICAgICAgICBjdWJlMS5vbkdyb3VuZCA9IHRydWU7CiAgICAgICAgICAgIGNvbHNpZGUgfD0gQUFCQl9ZTkVHOwogICAgICAgIH0KICAgICAgICAjICt5CiAgICAgICAgaWYocHkgKyAyICogY3N5ID49IGN5ICYmIG9weSArIDIgKiBjc3kgPD0gb2N5ICYmIEFBQkJfc2lkZShjeCwgc3ggKyBjc3gsIHB4KSA9PSAwICYmIEFBQkJfc2lkZShjeiwgc3ogKyBjc3osIHB6KSA9PSAwKXsKICAgICAgICAgICAgY29sc2lkZSB8PSBBQUJCX1lQT1M7CiAgICAgICAgfQogICAgICAgICMgLXoKICAgICAgICBpZihweiA8PSBjeiArIHN6ICsgY3N6ICYmIG9weiA+PSBvY3ogKyBzeiArIGNzeiAmJiBBQUJCX3NpZGUoY3gsIHN4ICsgY3N4LCBweCkgPT0gMCAmJiBBQUJCX3NpZGUoY3kgKyBzeSwgc3kgKyBjc3osIHB5ICsgY3N6KSA9PSAwKXsKICAgICAgICAgICAgaWYocHkgPj0gY3kgKyAyICogc3kgLSBBQUJCX3N0ICYmICgoYm9vbCkgY3ViZTEub25Hcm91bmQpKXsKICAgICAgICAgICAgICAgIGN1YmUxLm9uR3JvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjdWJlMS5vbldhbGwgPSB0cnVlOwogICAgICAgICAgICBjb2xzaWRlIHw9IEFBQkJfWk5FRzsKICAgICAgICB9CiAgICAgICAgIyAregogICAgICAgIGlmKHB6ID49IGN6IC0gc3ogLSBjc3ogJiYgb3B6IDw9IG9jeiAtIHN6IC0gY3N6ICYmIEFBQkJfc2lkZShjeCwgc3ggKyBjc3gsIHB4KSA9PSAwICYmIEFBQkJfc2lkZShjeSArIHN5LCBzeSArIGNzeSwgcHkgKyBjc3kpID09IDApewogICAgICAgICAgICBpZihweSA+PSBjeSArIDIgKiBzeSAtIEFBQkJfc3QgJiYgKChib29sKSBjdWJlMS5vbkdyb3VuZCkpewogICAgICAgICAgICAgICAgY3ViZTEub25Hcm91bmQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGN1YmUxLm9uV2FsbCA9IHRydWU7CiAgICAgICAgICAgIGNvbHNpZGUgfD0gQUFCQl9aUE9TOwogICAgICAgIH0KICAgICAgICBpZiAoY29sc2lkZSA+IDApewogICAgICAgICAgICBjb2xvYmogPSB0Y3ViZTsKICAgICAgICAgICAgYWRkVG8gY29sbGlzaW9ucyB7Y29sc2lkZTpjb2xzaWRlLGNvbG9iajpjb2xvYmp9OwogICAgICAgIH0gCiAgICAgICAgdG90YWxjb2xzaWRlIHw9IGNvbHNpZGU7Cgl9CiAgICBpZiAobm90RW1wdHkgKG9iailjdWJlMS5vZ3BvcykgewogICAgICAgIGN1YmUxLm9ncG9zLnggPSAobnVtKSBjdWJlMS5wb3NpdGlvbi54ICsgMDsKICAgICAgICBjdWJlMS5vZ3Bvcy55ID0gKG51bSkgY3ViZTEucG9zaXRpb24ueSArIDA7CiAgICAgICAgY3ViZTEub2dwb3MueiA9IChudW0pIGN1YmUxLnBvc2l0aW9uLnogKyAwOwogICAgfSBlbHNlIHsKICAgICAgICBjdWJlMS5vZ3BvcyA9IAogICAgICAgIHsKICAgICAgICAgICAgeDoobnVtKWN1YmUxLnBvc2l0aW9uLnggKyAwLAogICAgICAgICAgICB5OihudW0pY3ViZTEucG9zaXRpb24ueSArIDAsCiAgICAgICAgICAgIHo6KG51bSljdWJlMS5wb3NpdGlvbi56ICsgMAogICAgICAgIH07CiAgICB9CiAgICAjIEdBTUUubG9nKGNvbGxpc2lvbnMpOwogICAgcmV0dXJuIGNvbGxpc2lvbnM7CgkKfQoKCm9ialtdIGFjdGlvbiBBQUJCX3Jlc29sdmVwbHIob2JqIHBscixib29sIGNyb3VjaCxvYmpbXSBjdWJlcyl7CiAgICBpZiAoY3JvdWNoKXsKICAgICAgICBwbHIuc2NhbGUgPSAKICAgICAgICB7CiAgICAgICAgICAgIHg6QUFCQl93LAogICAgICAgICAgICB5OkFBQkJfYywKICAgICAgICAgICAgejpBQUJCX3cKICAgICAgICB9OwogICAgfSBlbHNlIHsKICAgICAgICBwbHIuc2NhbGU9CiAgICAgICAgewogICAgICAgICAgICB4OkFBQkJfdywKICAgICAgICAgICAgeTpBQUJCX0gsCiAgICAgICAgICAgIHo6QUFCQl93CiAgICAgICAgfTsKICAgIH0KICAgIHJldHVybiBBQUJCX3Jlc29sdmUocGxyLGN1YmVzKTsKfQoKYWN0aW9uIEFBQkJfb25QbGF5ZXJTcGF3bihzdHIgaWQpIHsKICAgIG9iaiBwbHIgPSBHQU1FLlBMQVlFUlMuZmluZEJ5SUQoaWQpOwogICAgcGxyLnNjYWxlID0ge3g6QUFCQl93LHk6QUFCQl93LHo6QUFCQl9IfTsKfQoKI2luY2x1ZGUgPGcua3Juaz4KI2luY2x1ZGUgPHBscnV0aWxfcy5rcm5rPgojaW5jbHVkZSA8cGxyYmh2cl9zLmtybms+CiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojIExpYnJhcnk6IGxpYnNcRUNTXGNvbXBvbmVudHNcc2hha2Vcc2hha2Vfcy5rcm5rCiMgQXV0aG9yOiBibGFuZHJpY2UKIyAgIERlc2NyaXB0aW9uOiB0aW1lIHRvIHNoYWtlIHRoYXQhCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKYWN0aW9uIHNoYWtlX3Nfb25FQ1NVcGRhdGUobnVtIGRlbHRhLCBvYmogdG9iaiwgb2JqW10gb2JqbGlzdCl7CiAgICBpZiAobm90RW1wdHkgKG9iaikgdG9iai5zaGFrZSl7CiAgICAgICAgaWYgKChudW0pdG9iai5zaGFrZS5lbiA9PSAxKXsKICAgICAgICAgICAgaWYgKCFub3RFbXB0eSAob2JqKXRvYmouc2hha2Uub2cpIHsKICAgICAgICAgICAgICAgIHRvYmouc2hha2Uub2cgPSB7CiAgICAgICAgICAgICAgICAgICAgeDoobnVtKXRvYmoucG9zaXRpb24ueCwKICAgICAgICAgICAgICAgICAgICB5OihudW0pdG9iai5wb3NpdGlvbi55LAogICAgICAgICAgICAgICAgICAgIHo6KG51bSl0b2JqLnBvc2l0aW9uLnoKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFub3RFbXB0eSAob2JqKXRvYmouc2hha2UuaW50ZW5zaXR5KSB7CiAgICAgICAgICAgICAgICAgICAgdG9iai5zaGFrZS5pbnRlbnNpdHkgPSB7eDoxLHk6MCx6OjF9OwogICAgICAgICAgICB9IAogICAgICAgICAgICBpZiAoKHN0cikgdG9iai5zaGFrZS50bGFzdHNoYWtlID09ICJ1bmRlZmluZWQiKXsKICAgICAgICAgICAgICAgIHRvYmouc2hha2UudGxhc3RzaGFrZSA9IGdfdG5vdzsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoKG51bSkgdG9iai5zaGFrZS50bGFzdHNoYWtlID09IDApIHsKICAgICAgICAgICAgICAgIHRvYmouc2hha2UudGxhc3RzaGFrZSA9IGdfdG5vdzsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZ190bm93IC0gKG51bSl0b2JqLnNoYWtlLnRsYXN0c2hha2UgPiAobnVtKXRvYmouc2hha2UuZHVyYXRpb24pewogICAgICAgICAgICAgICAgdG9iai5zaGFrZS50bGFzdHNoYWtlID0gMDsKICAgICAgICAgICAgICAgIHRvYmouc2hha2UuZW4gPSAwOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdG9iai5wb3NpdGlvbi54ID0gKChudW0pdG9iai5zaGFrZS5pbnRlbnNpdHkueCAhPSAwKSA/IChudW0pdG9iai5zaGFrZS5vZy54ICsgVVRJTFMucmFuZEludCgtKG51bSl0b2JqLnNoYWtlLmludGVuc2l0eS54LCAobnVtKXRvYmouc2hha2UuaW50ZW5zaXR5LngpIDogKG51bSl0b2JqLnBvc2l0aW9uLng7CiAgICAgICAgICAgICAgICB0b2JqLnBvc2l0aW9uLnkgPSAoKG51bSl0b2JqLnNoYWtlLmludGVuc2l0eS55ICE9IDApID8gKG51bSl0b2JqLnNoYWtlLm9nLnkgKyBVVElMUy5yYW5kSW50KC0obnVtKXRvYmouc2hha2UuaW50ZW5zaXR5LnksIChudW0pdG9iai5zaGFrZS5pbnRlbnNpdHkueikgOiAobnVtKXRvYmoucG9zaXRpb24ueTsKICAgICAgICAgICAgICAgIHRvYmoucG9zaXRpb24ueiA9ICgobnVtKXRvYmouc2hha2UuaW50ZW5zaXR5LnogIT0gMCkgPyAobnVtKXRvYmouc2hha2Uub2cueiArIFVUSUxTLnJhbmRJbnQoLShudW0pdG9iai5zaGFrZS5pbnRlbnNpdHkueiwgKG51bSl0b2JqLnNoYWtlLmludGVuc2l0eS56KSA6IChudW0pdG9iai5wb3NpdGlvbi56OwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIAogICAgICAgIHsKICAgICAgICAgICAgaWYgKG5vdEVtcHR5IChvYmopdG9iai5zaGFrZS5vZykgewogICAgICAgICAgICAgICAgdG9iai5wb3NpdGlvbi54ID0gKChudW0pdG9iai5zaGFrZS5pbnRlbnNpdHkueCAhPSAwKSA/IChudW0pdG9iai5zaGFrZS5vZy54IDogKG51bSkgdG9iai5wb3NpdGlvbi54OwogICAgICAgICAgICAgICAgdG9iai5wb3NpdGlvbi55ID0gKChudW0pdG9iai5zaGFrZS5pbnRlbnNpdHkueSAhPSAwKSA/IChudW0pdG9iai5zaGFrZS5vZy55IDogKG51bSkgdG9iai5wb3NpdGlvbi55OwogICAgICAgICAgICAgICAgdG9iai5wb3NpdGlvbi56ID0gKChudW0pdG9iai5zaGFrZS5pbnRlbnNpdHkueiAhPSAwKSA/IChudW0pdG9iai5zaGFrZS5vZy56IDogKG51bSkgdG9iai5wb3NpdGlvbi56OwogICAgICAgICAgICAgICAgdG9iai5zaGFrZS5vZyA9IHt9OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgojaW5jbHVkZSA8Zy5rcm5rPgojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIyBIZWFkZXI6IFxsaWJzXGZsb2F0XGR0eXBlcy5rcm5rCiMgQXV0aG9yOiBibGFuZHJpY2UKIyAgIERlc2NyaXB0aW9uOiBjdXN0b20gZmxvYXQgZGF0YSB0eXBlcy0tPiBiaW5hcnkgcmVwcmVzZW50YXRpb24gY2FsY3VsYXRpb25zLgojICAgR29hbCB3YXMgdG8gcGFjayBmbG9hdCBkYXRhIGludG8gMTYtYml0cyBhbmQgc2VuZCBvdmVyIE5ldHdvcmtNZXNzYWdlIAojICAgKG11Y2ggc21hbGxlciB0aGFuIEFTQ0lJIHN0cmluZyByZXByZXNlbnRhdGlvbikKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Cm51bSBhY3Rpb24gZHR5cGVzX2ZpbmRNU0JMb2MobnVtIHYpewoJIyB2IGJldHRlciBiZSBhbiBpbnRlZ2VyIHUgZHVtYm8KCW51bSByID0gLTE7CgkjIHYgPSB2ID4+IDE7Cgl3aGlsZSAodiA+IDApIHsKCQlyKys7CgkJdiA9IHYgPj4gMTsKCX0KCXJldHVybiByOwp9Cm51bSBhY3Rpb24gZHR5cGVzX2Ztb2QobnVtIHgsIG51bSByKXsKCXJldHVybiB4IC0gKHIqTWF0aC5mbG9vcih4IC8gcikpOwkKfQpzdHIgYWN0aW9uIGR0eXBlc19wcmludEJpbmFyeShudW0gZil7CglzdHIgcmV0c3RyID0gIiI7Cglmb3IgKG51bSBpID0gMzItMTsgaSA+PSAwOyBpLS0pIHsKCQlyZXRzdHIgKz0gdG9TdHIgKGYgPj4gaSAmIDB4MSk7Cgl9CglyZXR1cm4gcmV0c3RyOwp9Cm51bSBhY3Rpb24gZHR5cGVzX29uZXMobnVtIGYpewoJbnVtIHJldG51bSA9IDA7Cglmb3IgKG51bSBpID0gMDsgaSA8IGY7IGkrKyl7CgkJcmV0bnVtID0gKHJldG51bSA8PCAxKSB8IDE7Cgl9CglyZXR1cm4gcmV0bnVtOwkKfQoKCiMgYWRhcHRlZCBmcm9tIElFRUUgNzU0IFN0YW5kYXJkIGZvciBTaW5nbGUgUHJlY2lzaW9uIDMyIGJpdCBmbG9hdGluZwojIGJ1dCBhbGxvd3MgZm9yIHlvdSB0byBzZWxlY3QgIyBvZiBleHBvbmVudCAvIG1hbnRpc3NhIGJpdHMKIyBoYWxmLXByZWNpc2lvbiAoMTYgYml0KSwgc2luZ2xlLXByZWNpc2lvbiAoMzIgYml0KQojIG51bSBkdHlwZXNfTUFYX0JJVFMgPSAzMjsgbnVtIEJJVFNfRVhQID0gODsKbnVtIGR0eXBlc19NQVhfQklUUyA9IDE2OyBudW0gQklUU19FWFAgPSA1OyAKI2Rvbid0IGNoYW5nZSB0byBzb21ldGhpbmcgbGlrZSAxNi0zLi4gZXJyb3IgdXAgdG8gMzAgdW5pdHMgb2JzZXJ2ZWQKCiMgKGUuZy4gMzItYml0KSBmcm9tIGxlZnQgdG8gcmlnaHQ6CiMgMSBiaXQgLSBTaWduIGJpdCAoMidzIGNvbXBsZW1lbnQpICs9ICgtMSkgKiAyXnBsYWNlIGluIGV4cG9uZW50CiMgOCBiaXRzIC0gRXhwb25lbnQgKDJeZSkKIyAyMyBiaXRzIC0gTWFudGlzc2EgKHBhcnQgYWZ0ZXIgZGVjaW1hbCkKIyByYW5nZSA9IDJeQklUU19FWFAgCiMgcHJlY2lzaW9uID0gMS8oMl5kdHlwZXNfQklUU19NQU5UKQoKbnVtIGR0eXBlc19CSUFTID0gMioqKEJJVFNfRVhQLTEpLTE7Cm51bSBkdHlwZXNfQklUU19NQU5UID0gZHR5cGVzX01BWF9CSVRTIC0gMSAtIEJJVFNfRVhQOwpudW0gZHR5cGVzX1NJR05fTE9DID0gZHR5cGVzX01BWF9CSVRTLTE7CgpudW0gYWN0aW9uIGR0eXBlc19udW1Ub0Zsb2F0MTYobnVtIGRhdGEpIHsKCSMgMS4gZGV0ZXJtaW5lIHRoZSBzaWduIGJpdAoJbnVtIHNpZ25iaXQgPSAwOwoJaWYgKGRhdGEgPCAwKSB7c2lnbmJpdCA9IDE7IGRhdGEgPSAtZGF0YTt9CiAgICBpZiAoZGF0YSA9PSAwKSB7cmV0dXJuIDA7fQoJIyAyLiBDb252ZXJ0ICB3aG9sZSAvIGRlY2ltYWwgYml0cyB0byBwdXJlIGJpbmFyeQoJbnVtIHdob2xlID0gTWF0aC5mbG9vcihkYXRhKTsgIyBmbG9vciBpdCBzbyBpdCdzIGp1c3QgYW4gaW50ZWdlciAod2lsbCBiZSBiZXR3ZWVuIDAgYW5kIDJeYml0c2V4cCkuIG1heCBpcyB0aGUgMiBeIGJpdHMgb2YgdGhlIGV4cG9uZW50CgludW0gZGVjaW1hbCA9IChkYXRhIC0gd2hvbGUgPiAwKSA/IGRhdGEgLSB3aG9sZSA6IDA7CgludW0gZGVjYml0ID0gMHgwMDA7IAoJZm9yIChudW0gaSA9IDA7IGkgPCBkdHlwZXNfQklUU19NQU5UOyBpKyspeyAjIGNvbnZlcnQgZGVjaW1hbHMgaW50byBiaW5hcnkKCQlkZWNpbWFsICo9IDI7CgkJbnVtIHRkZWNiaXQgPSAoZGVjaW1hbCA+PSAxID8gMSA6IDApOwoJCWRlY2JpdCB8PSAgdGRlY2JpdCA8PCAoZHR5cGVzX0JJVFNfTUFOVC0xLWkpOyAjIDEyIC0gaSAKCQlpZiAoZGVjaW1hbCA+PSAxKSB7ZGVjaW1hbCAtPTE7fQoJfQoJCSMgR0FNRS5sb2coImRlY2JpdCIsZHR5cGVzX3ByaW50QmluYXJ5KGRlY2JpdCkpOwoKCW51bSBwdXJiaW5hcnkgPSAod2hvbGUgPDwgZHR5cGVzX0JJVFNfTUFOVCkgfCBkZWNiaXQ7CgkJIyBHQU1FLmxvZygicHVyYmluYXJ5IixkdHlwZXNfcHJpbnRCaW5hcnkocHVyYmluYXJ5KSk7CgkJIyBHQU1FLmxvZygiZHR5cGVzX2ZpbmRNU0JMb2MocHVyYmluYXJ5KSIsZHR5cGVzX2ZpbmRNU0JMb2MocHVyYmluYXJ5KSk7CgkKCSMgMy4gbm9ybWFsaXplIHRvIGRldGVybWluZSBtYW50aXNzYSBhbmQgdW5iaWFzZWQgZXhwb25lbnQKCW51bSB1bmJpYXNlZGV4cCA9IGR0eXBlc19maW5kTVNCTG9jKHB1cmJpbmFyeSkgLSBkdHlwZXNfQklUU19NQU5UOwoJCSMgR0FNRS5sb2coInVuYmlhc2VkZXhwIix1bmJpYXNlZGV4cCk7CgkjIDQuIGRldGVybWluZSBiaWFzZWQgZXhwb25lbnQKCW51bSBiaWFzZWRleHAgPSB1bmJpYXNlZGV4cCArIGR0eXBlc19CSUFTOwoJIyA1LiByZW1vdmUgbGVhZGluZyAxIChNU0IpCgkJIyBhbGlnbiBmaXJzdAoJbnVtIG1hbnRpc3NhID0gcHVyYmluYXJ5OwoJbnVtIGFsaWdubWFudGlzc2EgPSAoZHR5cGVzX0JJVFNfTUFOVC0xKS1kdHlwZXNfZmluZE1TQkxvYyhtYW50aXNzYSk7CglpZiAoYWxpZ25tYW50aXNzYSA+IDApIHsKCQltYW50aXNzYSA9IG1hbnRpc3NhIDw8IGFsaWdubWFudGlzc2E7Cgl9IGVsc2UgewoJCW1hbnRpc3NhID0gbWFudGlzc2EgPj4gKC0xICogYWxpZ25tYW50aXNzYSk7Cgl9CgltYW50aXNzYSA9IChtYW50aXNzYSBeICgxIDw8IChkdHlwZXNfZmluZE1TQkxvYyhtYW50aXNzYSkpKSkgPDwgMTsgIyByZW1vdmUgbGVhZGluZyAxCgkJIyBHQU1FLmxvZygibWFudGlzc2E6IixkdHlwZXNfcHJpbnRCaW5hcnkobWFudGlzc2EpKTsKCQkjIEdBTUUubG9nKCJsZWZ0LXNoaWZ0IGJ5OiIsYWxpZ25tYW50aXNzYSk7CQoJbnVtIGZsb2F0MTYgPSAoc2lnbmJpdCA8PCBkdHlwZXNfU0lHTl9MT0MpIHwgKGJpYXNlZGV4cCA8PCBkdHlwZXNfQklUU19NQU5UKSB8ICggbWFudGlzc2EgKTsKCXJldHVybiBmbG9hdDE2Owp9CgpudW0gYWN0aW9uIGR0eXBlc19mbG9hdDE2VG9OdW0obnVtIGYpIHsKCWlmIChmID09IDApIHtyZXR1cm4gMDt9CiAgICAjIERldGVybWluZSBzaWduCgludW0gc2lnbiA9ICgoKGYgPj4gZHR5cGVzX1NJR05fTE9DKSAmIDB4MSkgPiAwKSA/IC0xIDogMTsKCSMgRGV0ZXJtaW5lIGV4cG9uZW50IDIqZSAKCW51bSBleHAgPSAoZiA+PiBkdHlwZXNfQklUU19NQU5UKSAmIGR0eXBlc19vbmVzKEJJVFNfRVhQKTsgCglleHAgLT0gZHR5cGVzX0JJQVM7CgkjIENvbnZlcnQgbWFudGlzc2EgdG8gZGVuYXJ5CgludW0gbWFudGlzc2EgPSBmICYgZHR5cGVzX29uZXMoZHR5cGVzX0JJVFNfTUFOVCk7CgkjIEdBTUUubG9nKCJtYW50aXNzYTogIiwgZHR5cGVzX3ByaW50QmluYXJ5KG1hbnRpc3NhKSk7CgludW0gbWFudGRlbiA9IDA7Cglmb3IgKG51bSBpID0gZHR5cGVzX2ZpbmRNU0JMb2MobWFudGlzc2EpOyBpID49MCA7IGktLSkgewoJCW51bSB0bWFuID0gMS8oMioqKGR0eXBlc19CSVRTX01BTlQtaSkpICogKChtYW50aXNzYSA+PiBpKSAmIDB4MSk7CgkJbWFudGRlbiArPSB0bWFuOwoJCQoJfQoJbWFudGRlbiArPSAxOyAjIGFkZCAxIGJhY2sgCgludW0gUmFkID0gc2lnbiAqIG1hbnRkZW4gKiAoMiAqKiBleHApOwoJcmV0dXJuIFJhZDsKfQoKbnVtIGFjdGlvbiBkdHlwZXNfbnVtVG9VaW50MTYobnVtIHgpewoJcmV0dXJuICh4ICYgMHhGRkZGKTsgIyBjYXAgNjU1MzYgCn0KCm51bSBhY3Rpb24gZHR5cGVzX251bVRvSW50MTYobnVtIHgpewoJIyByZXR1cm4gKHggJiAweEZGKTsgIyBjYXAgNjU1MzYgCgludW0gcmV0bnVtID0gMDsKCXggPSBNYXRoLnJvdW5kKHgpOwoJeCA9ICh4ID4gMzI3NjcpID8gMzI3NjcgOiB4OwoJeCA9ICh4IDwgLTMyNzY3KSA/IC0zMjc2NyA6IHg7CgkjIGNhcCB0byBsYXJnZXN0IC8gc21hbGxlc3QgaW50IHNpemUKCgludW0gc2lnbiA9IHggPCAwID8gMSA6IDA7CgoJaWYgKHNpZ24gPT0gMSkgewoJCXggPSAteDsKCX0KCXJldG51bSB8PSBzaWduIDw8IDE1OwoKCW51bSBpID0gMTQ7ICMgMTUgLSAxCgl3aGlsZSAoeCA+IDApIHsKCQlpZiAoeCAvICgyKippKSA+PSAxKSB7CgkJCXJldG51bSB8PSAgKDEgPDwgaSk7CgkJCXgtPSAoMioqaSk7CgkJfQoJCWktLTsKCX0KCXJldHVybiByZXRudW07Cn0KCm51bVtdIGFjdGlvbiBkdHlwZXNfbnVtVG9fdWludDE2Qnl0ZUFycmF5KG51bSBkYXRhKSB7CglkYXRhID0gTWF0aC5yb3VuZChkYXRhKTsKCW51bVtdIHJldEFycmF5ID0gbnVtW107CglhZGRUbyByZXRBcnJheSAoZGF0YSA+PiA4KSAmIDB4ZmY7CglhZGRUbyByZXRBcnJheSAoZGF0YSA+PiAwKSAmIDB4ZmY7CgkKCXJldHVybiByZXRBcnJheTsKCn0KCm51bSBhY3Rpb24gZHR5cGVzX21lcmdlMkJ5dGVzKG51bSBhLG51bSBiKSB7CglyZXR1cm4gKGIgPDwgOCkgfCBhOwp9CgpudW0gYWN0aW9uIGR0eXBlc19JbnQxNlRvTnVtKG51bSBiaW4pIHsKCSMgbnVtIGJpbiA9IChiIDw8IDB4ZmYpIHwgYTsKCW51bSBzaWduID0gKChiaW4gJiAweDgwMDApID4gMCkgPyAtMSA6IDE7CgludW0gZGVuYXJ5ID0gYmluICYgMHg3RkZGOwoKCXJldHVybiBzaWduICogZGVuYXJ5Owp9CgojIGludCBOdW1iZXJzIHRvIGJ5dGUgYXJyYXkKbnVtW10gYWN0aW9uIGR0eXBlc19pbnQxNnRvQnl0ZUFycmF5KG51bSBkYXRhKXsKCXJldHVybiBudW1bKChkYXRhID4+IDApICYgMHhmZiksKGRhdGEgPj4gOCkgJiAweGZmXTsKfQoKbnVtW10gYWN0aW9uIGR0eXBlc19pbnQzMnRvQnl0ZUFycmF5KG51bSBkYXRhKXsKCW51bVtdIHJldGFyciA9IG51bVtdOwoJYWRkVG8gcmV0YXJyIChkYXRhID4+IDApICYgMHhmZjsgCglhZGRUbyByZXRhcnIgKGRhdGEgPj4gOCkgJiAweGZmOyAKCWFkZFRvIHJldGFyciAoZGF0YSA+PiAxNikgJiAweGZmOyAKCWFkZFRvIHJldGFyciAoZGF0YSA+PiAyNCkgJiAweGZmOyAKCXJldHVybiByZXRhcnI7Cn0KCm51bVtdIGFjdGlvbiBkdHlwZXNfQ29sb3JUb0J5dGVBcnJheShudW0gY29sb3IpIHsKCW51bVtdIHJldEFycmF5ID0gbnVtW107CglhZGRUbyByZXRBcnJheSAoY29sb3IgPj4gMCkgJiAweGZmOwoJYWRkVG8gcmV0QXJyYXkgKGNvbG9yID4+IDgpICYgMHhmZjsKCWFkZFRvIHJldEFycmF5IChjb2xvciA+PiAxNikgJiAweGZmOwoJCglyZXR1cm4gcmV0QXJyYXk7Cn0KCnN0ciBkdHlwZXNfYWxwaGFiZXQgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkhIyQlJigpKissLi86Ozw9Pj9AW11eX2B7fH1+LSI7CgojIFJlY3Vyc2lvbiBkdWUgdG8gbG9vcCBsaW1pdHMKbnVtIGFjdGlvbiBkdHlwZXNfZ2V0VmFsdWUoc3RyIGMsIG51bSBpbmRleCkgewoJaWYoaW5kZXggPj0gbGVuZ3RoT2YgZHR5cGVzX2FscGhhYmV0KSB7CgkJcmV0dXJuIC0xOwoJfQoJCglpZihkdHlwZXNfYWxwaGFiZXRbaW5kZXhdID09IGMpIHsKCQlyZXR1cm4gaW5kZXg7Cgl9CgkKCXJldHVybiBkdHlwZXNfZ2V0VmFsdWUoYywgaW5kZXggKyAxKTsKfQoKbnVtW10gYWN0aW9uIGR0eXBlc19zdHJ0b0J5dGVBcnJheShzdHIgcyl7CgludW1bXSByZXRBcnJheSA9IG51bVtdOwoJZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBzOyBpKyspewoJCWFkZFRvIHJldEFycmF5IGR0eXBlc19nZXRWYWx1ZShzW2ldLDApOwoJfQoJcmV0dXJuIHJldEFycmF5Owp9CgpzdHIgYWN0aW9uIGR0eXBlc19CeXRlQXJyYXlUb1N0cihudW1bXSBiKXsKCXN0ciBzID0gIiI7Cglmb3IgKG51bSBpID0gMDsgaSA8IGxlbmd0aE9mIGI7IGkrKyl7CgkJaWYgKGJbaV0gPj0wKQoJCXsKCQkJcyArPSBkdHlwZXNfYWxwaGFiZXRbYltpXV07CQoJCX0KCX0KCXJldHVybiBzOwp9CgpzdHJbXSBkdHlwZXNfbG9va3VwID0gc3RyWyIwIiwiMSIsIjIiLCIzIiwiNCIsIjUiLCI2IiwiNyIsIjgiLCI5IiwiQSIsIkIiLCJDIiwiRCIsIkUiLCJGIl07CgpzdHIgYWN0aW9uIGR0eXBlc19udW0yaGV4c3RyaW5nKG51bSBuKXsKCXN0ciBoZXhzdHIgPSAiIjsKCWZvciAobnVtIGkgPTA7IGkgPCA2OyBpKyspewoJCWhleHN0ciA9IGR0eXBlc19sb29rdXBbbiAmIDB4Rl0gKyBoZXhzdHI7CgkJbiA9IG4gPj4gNDsKCX0KCXJldHVybiBoZXhzdHI7Cn0KCm51bSBhY3Rpb24gZHR5cGVzX2hleHN0cmluZzJudW0oc3RyIGgpewoJbnVtIG4gPSAwOwoJaCA9IFVUSUxTLnRvVXBwZXIoaCk7Cglmb3IgKG51bSBpID0gMDsgaSA8IGxlbmd0aE9mIGg7IGkrKyl7CgkJZm9yIChudW0gaiA9IDA7IGogPCBsZW5ndGhPZiBkdHlwZXNfbG9va3VwOyBqKyspewoJCQlpZiAoZHR5cGVzX2xvb2t1cFtqXSA9PSBoW2ldKXsKCQkJCW4gfD0gaiA8PCAobGVuZ3RoT2YgaCAtIDEgLSBpKSo0OwoJCQkJYnJlYWs7CgkJCX0KCQl9Cgl9CglyZXR1cm4gbjsKfQoKbnVtIGFjdGlvbiBkdHlwZXNfY29uc3RyYWluUmFkaWFucyhudW0geCl7Cgl4ID0gZHR5cGVzX2Ztb2QoeCxNYXRoLlBJMik7CglpZiAoeCA8IDApewoJCXggKz0gMzYwOwoJfQogICAgcmV0dXJuIHg7Cn0KCgojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIyBIZWFkZXI6IGI5MWVuY29kaW5nXGI5MS5rcm5rCiMgQXV0aG9yOiBTbHhUblQKIyBEZXNjcmlwdGlvbjogQmFzZTkxIGRlY29kaW5nIGNvbnZlcnRlZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9LdmFuVFRUL0Jhc2VOY29kaW5nCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCm9iaiBiOTFfYmFzZTkxID0gewogICAgYWxwaGFiZXQ6ICJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSEjJCUmKCkqKywuLzo7PD0+P0BbXV5fYHt8fX4tIgp9OwoKIyBSZWN1cnNpb24gZHVlIHRvIGxvb3AgbGltaXRzCm51bSBhY3Rpb24gYjkxX2dldFZhbHVlKHN0ciBjLCBudW0gaW5kZXgpIHsKCWlmKGluZGV4ID49IGxlbmd0aE9mIGI5MV9iYXNlOTEuYWxwaGFiZXQpIHsKCQlyZXR1cm4gLTE7Cgl9CgkKCWlmKChzdHIpYjkxX2Jhc2U5MS5hbHBoYWJldFtpbmRleF0gPT0gYykgewoJCXJldHVybiBpbmRleDsKCX0KCQoJcmV0dXJuIGI5MV9nZXRWYWx1ZShjLCBpbmRleCArIDEpOwp9CgpudW1bXSBhY3Rpb24gYjkxX2RlY29kZShzdHIgZGF0YSkgewogICAgbnVtIGR2ID0gLTE7CiAgICBudW0gZG4gPSAwOwogICAgbnVtIGRicSA9IDA7CiAgICBudW1bXSByZXN1bHQgPSBudW1bXTsKCiAgICBmb3IobnVtIGkgPSAwOyBpIDwgbGVuZ3RoT2YgZGF0YTsgaSsrKSB7CiAgICAgICAgbnVtIGl2ID0gYjkxX2dldFZhbHVlKGRhdGFbaV0sIDApOwoKICAgICAgICBpZihpdiA9PSAtMSkgeyBjb250aW51ZTsgfQoKICAgICAgICBpZihkdiA9PSAtMSkgewogICAgICAgICAgICBkdiA9IGl2OyAKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGR2ICs9IGl2ICogOTE7CiAgICAgICAgICAgIGRicSB8PSAoZHYgPDwgZG4pOwoKICAgICAgICAgICAgaWYoKGR2ICYgODE5MSkgPiA4OCkgewogICAgICAgICAgICAgICAgZG4gKz0gMTM7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBkbiArPSAxNDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBkbyAuLi4gd2hpbGU/CiAgICAgICAgICAgIGJvb2wgZmlyc3QgPSB0cnVlOwoKICAgICAgICAgICAgd2hpbGUoZmlyc3QgfHwgZG4gPiA3KSB7CiAgICAgICAgICAgICAgICBhZGRUbyByZXN1bHQgZGJxICUgMjU2OwogICAgICAgICAgICAgICAgZGJxID4+Pj0gODsKICAgICAgICAgICAgICAgIGRuIC09IDg7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGZpcnN0ID0gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGR2ID0gLTE7CiAgICAgICAgfQogICAgfQoKCWlmKGR2ICE9IC0xKSB7CgkJYWRkVG8gcmVzdWx0IChkYnEgfCBkdiA8PCBkbikgJiAyNTU7Cgl9CgoJcmV0dXJuIHJlc3VsdDsKfQoKIyBCZWluZyB1c2VkIHNlcnZlci1zaWRlCnN0ciBhY3Rpb24gYjkxX2VuY29kZShudW1bXSBkYXRhKSB7CiAgICBudW0gZW4gPSAwOwogICAgbnVtIGVicSA9IDA7CiAgICBzdHIgcmVzdWx0ID0gIiI7CgoJZm9yKG51bSBpID0gMDsgaSA8IGxlbmd0aE9mIGRhdGE7IGkrKykgewoJCWVicSB8PSAoZGF0YVtpXSAmIDI1NSkgPDwgZW47CgkJZW4gKz0gODsKCQkKCQlpZihlbiA+IDEzKSB7CgkJCW51bSBldiA9IGVicSAmIDgxOTE7CgkJCQoJCQlpZihldiA+IDg4KSB7CgkJCQllYnEgPj4+PSAxMzsKCQkJCWVuIC09IDEzOwoJCQl9CgkJCWVsc2UgewoJCQkJZXYgPSBlYnEgJiAxNjM4MzsKCQkJCWVicSA+Pj49IDE0OwoJCQkJZW4gLT0gMTQ7CgkJCX0KCQkJCgkJCW51bSBxdW90aWVudCA9IE1hdGguZmxvb3IoZXYgLyA5MSk7CgkJCW51bSByZW1haW5kZXIgPSBldiAlIDkxOwoJCQoJCQlyZXN1bHQgKz0gKHN0ciliOTFfYmFzZTkxLmFscGhhYmV0W3JlbWFpbmRlcl07CgkJCXJlc3VsdCArPSAoc3RyKWI5MV9iYXNlOTEuYWxwaGFiZXRbcXVvdGllbnRdOwoJCX0KCX0KCglpZihlbiA+IDApIHsKCQkJbnVtIHF1b3RpZW50ID0gTWF0aC5mbG9vcihlYnEgLyA5MSk7CgkJCW51bSByZW1haW5kZXIgPSBlYnEgJSA5MTsKCgkJCXJlc3VsdCArPSAoc3RyKWI5MV9iYXNlOTEuYWxwaGFiZXRbcmVtYWluZGVyXTsKCgkJCWlmKGVuID4gNyB8fCBlYnEgPiA5MCkgewoJCQkJcmVzdWx0ICs9IChzdHIpYjkxX2Jhc2U5MS5hbHBoYWJldFtxdW90aWVudF07CgkJCX0KCX0KCglyZXR1cm4gcmVzdWx0Owp9CiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojIEhlYWRlcjogXHN0cnV0aWxzXHN0cnV0aWxzLmtybmsKIyBBdXRob3I6IGJsYW5kcmljZSwgUHJvZk5vb2IgKHJlcGxhY2VhbGwpLCBNYW5pYU1hcHBlciAoU3BsaWNlKQojIERlc2NyaXB0aW9uOiBBZGRpdGlvbmFsIFN0cmluZyB1dGlsaXRpZXMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CnN0ciBhY3Rpb24gc3RydXRpbHNfdHJ1bmNhdGUoc3RyIHRleHQsIG51bSBsbikgewogICAgc3RyIHJldCA9ICIiOwogICAgZm9yIChudW0gaSA9IDA7IGkgPCBsbjsgaSsrKSB7CiAgICAgICAgcmV0ICs9IHRleHRbaV07CiAgICB9CiAgICByZXR1cm4gcmV0Owp9CgpzdHIgYWN0aW9uIHN0cnV0aWxzX3NwbGljZShzdHIgaW5wdXQsIG51bSBzdGFydCwgbnVtIGVuZCkgewogICAgbnVtIGNoYXJzTGVuID0gbGVuZ3RoT2YgaW5wdXQ7CiAgICBpZihjaGFyc0xlbiA9PSAwIHx8IHN0YXJ0ID49IGNoYXJzTGVuIHx8IHN0YXJ0ID49IGVuZCkgewogICAgICAgIHJldHVybiAnJzsKICAgIH0KICAgIGlmKGVuZCA+IGNoYXJzTGVuKSB7CiAgICAgICAgZW5kID0gY2hhcnNMZW47CiAgICB9CiAgICBzdHIgb3V0cHV0ID0gJyc7CiAgICBmb3IobnVtIGkgPSBzdGFydDsgaSA8IGVuZDsgaSsrKSB7CiAgICAgICAgb3V0cHV0ICs9IGlucHV0W2ldOwogICAgfQogICAgcmV0dXJuIG91dHB1dDsKfQoKYm9vbCBhY3Rpb24gc3RydXRpbHNfc3RhcnRzKHN0ciB0ZXh0LHN0ciB2YWx1ZSkgewogICAgaWYgKFVUSUxTLnRleHRDb250YWlucyhzdHJ1dGlsc190cnVuY2F0ZSh0ZXh0LCBsZW5ndGhPZiB2YWx1ZSksIHZhbHVlKSkge3JldHVybiB0cnVlO30gCglyZXR1cm4gZmFsc2U7fQoKc3RyW10gYWN0aW9uIHN0cnV0aWxzX3NwbGl0KHN0ciBzLCBzdHIgZGVsaW0pIHsKCXN0cltdIG91dHB1dCA9IHN0cltdOwoJbnVtIGlkeF9tYXRjaHN0YXJ0ID0gMDsKCiAgICAjIGl0ZXJhdGUgb3ZlciBzdHJpbmcKICAgIGZvcihudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBzOyBpKyspIHsKICAgICAgICBib29sIG1hdGNoID0gZmFsc2U7CiAgICAgICAgCiAgICAgICAgIyBtYXRjaCBkZWxpbWl0ZXIKICAgICAgICBmb3IgKG51bSBqID0gMDsgaiA8IGxlbmd0aE9mIGRlbGltOyBqKyspIHsKCQkJbWF0Y2ggPSB0cnVlOwogICAgICAgICAgICBpZiAoc1tpK2pdICE9IGRlbGltW2pdKSB7CgkJCQltYXRjaCA9IGZhbHNlOyBicmVhazsKCQkJfQoJCX0KCiAgICAgICAgIyBtYXRjaGVzLCBwYXJzZSBvdXQgdGhlIHN0cmluZyBwcmV2aW91cwogICAgICAgIGlmIChtYXRjaCkgeyAKICAgICAgICAgICAgc3RyIHdvcmQgPSAiIjsKICAgICAgICAgICAgZm9yIChudW0gaiA9IGlkeF9tYXRjaHN0YXJ0OyBqIDwgaTsgaisrKSB7CiAgICAgICAgICAgICAgICB3b3JkICs9IHNbal07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYWRkVG8gb3V0cHV0IHdvcmQ7CgogICAgICAgICAgICAjIHNraXAgZGVsaW1pdGVyCiAgICAgICAgICAgIGkgKz0gbGVuZ3RoT2YgZGVsaW0gLSAxOwogICAgICAgICAgICBpZHhfbWF0Y2hzdGFydCA9IGkrMTsKICAgICAgICB9CiAgICB9IAogICAgCiAgICAjIGFsc28gcGFyc2UgbGFzdCBzdHJpbmcKICAgIHN0ciB3b3JkID0gIiI7CiAgICBmb3IgKG51bSBpID0gaWR4X21hdGNoc3RhcnQ7IGkgPCBsZW5ndGhPZiBzOyBpKyspIHsKICAgICAgICB3b3JkICs9IHNbaV07CiAgICB9CiAgICBhZGRUbyBvdXRwdXQgd29yZDsKCglyZXR1cm4gb3V0cHV0Owp9CgpzdHIgYWN0aW9uIHN0cnV0aWxzX3JlcGxhY2VfYWxsKHN0ciBzdHJpbmcsIHN0ciB0b19yZXBsYWNlLCBzdHIgcmVwbGFjZV93aXRoKXsKICAgIHdoaWxlKFVUSUxTLnJlcGxhY2VUZXh0KHN0cmluZywgdG9fcmVwbGFjZSwgcmVwbGFjZV93aXRoKSAhPSBzdHJpbmcpewogICAgICAgIHN0cmluZyA9IFVUSUxTLnJlcGxhY2VUZXh0KHN0cmluZywgdG9fcmVwbGFjZSwgcmVwbGFjZV93aXRoKTsKICAgIH0KICAgIHJldHVybiBzdHJpbmc7Cn0KCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojIEhlYWRlcjogbGlic1x1dGlsc1xsaXN0c1xsaXN0dXRpbC5rcm5rCiMgQXV0aG9yOiBibGFuZHJpY2UKIyBEZXNjcmlwdGlvbjogQWRkaXRpb25hbCBzdHJpbmcgdXRpbGl0aWVzCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKbnVtIGFjdGlvbiBsaXN0dXRpbF9taW5saXN0KG51bVtdIGxpc3QpewogICAgaWYgKGxlbmd0aE9mIGxpc3QgPiAyKXsKICAgICAgICBudW0gbWluID0gbGlzdFswXTsKICAgICAgICBmb3IgKG51bSBpID0gMTsgaSA8IGxlbmd0aE9mIGxpc3Q7IGkrKyl7CiAgICAgICAgICAgIG1pbiA9IChsaXN0W2ldIDwgbWluKSA/IGxpc3RbaV0gOiBtaW47CiAgICAgICAgfQoJCXJldHVybiBtaW47CiAgICB9IGVsc2UgaWYgKGxlbmd0aE9mIGxpc3QgPT0gMSl7CiAgICAgICAgcmV0dXJuIGxpc3RbMF07CiAgICB9CiAgICBlbHNlIGlmIChsZW5ndGhPZiBsaXN0ID09IDIpIHsKICAgICAgICByZXR1cm4gTWF0aC5taW4obGlzdFswXSxsaXN0WzFdKTsKICAgIH0KICAgIHJldHVybiAwOwp9Cgpib29sIGFjdGlvbiBsaXN0dXRpbF9pbnN0cmxpc3Qoc3RyIHMsIHN0cltdIGxpc3QpewogICAgZm9yKG51bSBpID0gMDsgaSA8IGxlbmd0aE9mIGxpc3Q7IGkrKyl7CiAgICAgICAgaWYgKHMgPT0gbGlzdFtpXSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gZmFsc2U7Cn0KIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMgaGVhZGVyOiBcbGlic1xzeW5jb2Jqc1xzeW5jb2Jqc19oLmtybmsKIyBBdXRob3I6IGJsYW5kcmljZQojICAgRGVzY3JpcHRpb246IG5vdCByZWFkeSEKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgojIGNvbnRlbnRzMQpudW0gc3luY29ianNfaF9lSEVBTFRIID0gMHgwMTsKbnVtIHN5bmNvYmpzX2hfZVBPU0lUSU9OID0gMHgwMjsKbnVtIHN5bmNvYmpzX2hfZVJPVEFUSU9OID0gMHgwNDsKbnVtIHN5bmNvYmpzX2hfZVNDQUxFID0gMHgwODsKbnVtIHN5bmNvYmpzX2hfZVRZUEUgPSAweDEwOwpudW0gc3luY29ianNfaF9lVEVYVFVSRSA9IDB4MjA7Cm51bSBzeW5jb2Jqc19oX2VDT0xPUiA9IDB4NDA7Cm51bSBzeW5jb2Jqc19oX2VFTUlTU0lWRSA9IDB4ODA7CiMgY29udGVudHMyCm51bSBzeW5jb2Jqc19oX2VDT0xMSVNJT04gPSAweDAxOwoKIyBnZW9tZXRyeSB0eXBlcwpudW0gc3luY29ianNfaF9HRU9fQ1VCRSA9IDA7Cm51bSBzeW5jb2Jqc19oX0dFT19TUEhFUkUgPSAxOwpudW0gc3luY29ianNfaF9HRU9fQ1lMSU5ERVIgPSAyOwpudW0gc3luY29ianNfaF9HRU9fUk9UQ1VCRSA9IDM7Cm51bSBzeW5jb2Jqc19oX0dFT19DT01QTEVYQ09MID0gNDsKCiMgcmVzb2x2ZSB0eXBlcwpudW0gc3luY29ianNfaF9SRVNfU1RPUCA9IDA7ICMgc3RvcCBtb3ZlbWVudAoKIyBCaW5hcnkgZGVjb2Rpbmcgb2YgYW4gYXJyYXkgb2YgYnl0ZXMgdG8gT2JqZWN0cwpvYmogYWN0aW9uIHN5bmNvYmpzX2hfYnl0ZUFycmF5VG9PYmpzKG51bVtdIGJ5dGVBcnJheSkgewoJb2JqW10gb2JqbGlzdCA9IG9ialtdOwoJbnVtW10gZGVsTGlzdCA9IG51bVtdOwoJbnVtIGkgPSAwOyAjIHBjIGluIGFycmF5CgludW0gdG90YWxvYmpzID0gMDsKCW51bSB0b3RhbGRlbG9ianMgPSAwOwoJaWYgKGxlbmd0aE9mIGJ5dGVBcnJheSA+PTIpCgl7CiAgICAgICAgdG90YWxvYmpzID0gYnl0ZUFycmF5WzBdOwogICAgICAgIGkrKzsKCQl0b3RhbGRlbG9ianMgPSBieXRlQXJyYXlbMV07CgkJaSsrOwogICAgfSBlbHNlCgl7CiAgICAgICAgcmV0dXJuIHtvYmpsaXN0Om9iamxpc3QsZGVsTGlzdDpkZWxMaXN0fTsKICAgIH0KCQoJZm9yIChudW0gaiA9IDA7IGogPCB0b3RhbG9ianM7IGorKyl7CgkJb2JqIHRvYmogPSB7fTsKCQkjIGNvbnRlbnRzIGJ5dGUKCQludW0gY29udGVudHMxID0gYnl0ZUFycmF5W2ldOwoJCW51bSBjb250ZW50czIgPSBieXRlQXJyYXlbaSsxXTsKCQlpKz0yOwoJCSMgb2JqZWN0IGlkIDIgYnl0ZXMKCQl0b2JqLm9iamlkID0gZHR5cGVzX21lcmdlMkJ5dGVzKGJ5dGVBcnJheVtpXSxieXRlQXJyYXlbaSsxXSk7CgkJaSs9MjsKCQkjIDQgYnl0ZXMgaGVhbHRoIC8gZnVsbGhlYWx0aAoJCWlmICgoY29udGVudHMxICYgc3luY29ianNfaF9lSEVBTFRIKSA+IDApIHsKCQkJdG9iai5oZWFsdGggPSBkdHlwZXNfbWVyZ2UyQnl0ZXMoYnl0ZUFycmF5W2ldLGJ5dGVBcnJheVtpKzFdKTsKCQkJdG9iai5maGVhbHRoID0gZHR5cGVzX21lcmdlMkJ5dGVzKGJ5dGVBcnJheVtpKzJdLGJ5dGVBcnJheVtpKzNdKTsKCQkJaSs9IDQ7CgkJfQoJCSMgNiBieXRlcyBwb3NpdGlvbgoJCWlmICgoY29udGVudHMxICYgc3luY29ianNfaF9lUE9TSVRJT04pID4gMCl7CgkJCXRvYmoucG9zaXRpb24gPSB7CgkJCQl4IDogZHR5cGVzX0ludDE2VG9OdW0oZHR5cGVzX21lcmdlMkJ5dGVzKGJ5dGVBcnJheVtpXSxieXRlQXJyYXlbaSsxXSkpLAoJCQkJeSA6IGR0eXBlc19JbnQxNlRvTnVtKGR0eXBlc19tZXJnZTJCeXRlcyhieXRlQXJyYXlbaSsyXSxieXRlQXJyYXlbaSszXSkpLAoJCQkJeiA6IGR0eXBlc19JbnQxNlRvTnVtKGR0eXBlc19tZXJnZTJCeXRlcyhieXRlQXJyYXlbaSs0XSxieXRlQXJyYXlbaSs1XSkpCgkJCX07CgkJCWkrPSA2OwoJCX0KCQkjIDYgYnl0ZXMgcm90YXRpb24KCQlpZiAoKGNvbnRlbnRzMSAmIHN5bmNvYmpzX2hfZVJPVEFUSU9OKSA+IDApIHsKCQkJdG9iai5yb3RhdGlvbiA9ewoJCQkJeDogZHR5cGVzX2Zsb2F0MTZUb051bShkdHlwZXNfbWVyZ2UyQnl0ZXMoYnl0ZUFycmF5W2ldLGJ5dGVBcnJheVtpKzFdKSksCgkJCQl5OiBkdHlwZXNfZmxvYXQxNlRvTnVtKGR0eXBlc19tZXJnZTJCeXRlcyhieXRlQXJyYXlbaSsyXSxieXRlQXJyYXlbaSszXSkpLAoJCQkJejogZHR5cGVzX2Zsb2F0MTZUb051bShkdHlwZXNfbWVyZ2UyQnl0ZXMoYnl0ZUFycmF5W2krNF0sYnl0ZUFycmF5W2krNV0pKQoJCQl9OwoJCQlpKz0gNjsKCQl9CgkJIyA2IGJ5dGVzIHNjYWxlCgkJaWYgKChjb250ZW50czEgJiBzeW5jb2Jqc19oX2VTQ0FMRSkgPiAwKSB7CgkJCXRvYmouc2NhbGUgPSB7CgkJCQl4OiBkdHlwZXNfSW50MTZUb051bShkdHlwZXNfbWVyZ2UyQnl0ZXMoYnl0ZUFycmF5W2ldLGJ5dGVBcnJheVtpKzFdKSksCgkJCQl5OiBkdHlwZXNfSW50MTZUb051bShkdHlwZXNfbWVyZ2UyQnl0ZXMoYnl0ZUFycmF5W2krMl0sYnl0ZUFycmF5W2krM10pKSwKCQkJCXo6IGR0eXBlc19JbnQxNlRvTnVtKGR0eXBlc19tZXJnZTJCeXRlcyhieXRlQXJyYXlbaSs0XSxieXRlQXJyYXlbaSs1XSkpCgkJCX07CgkJCWkrPSA2OwoJCX0KCQkjIDcgYnl0ZXMgZGV0YWlscyAoMiB0eXBlLCAyIHRleHR1cmUsIDMgY29sb3IpCgkJaWYgKChjb250ZW50czEgJiBzeW5jb2Jqc19oX2VUWVBFKSA+IDApIHsKCQkJIyB0b2JqLnR5cGUgPSBkdHlwZXNfbWVyZ2UyQnl0ZXMoYnl0ZUFycmF5W2ldLGJ5dGVBcnJheVtpKzFdKTsKCQkJIyBpKz0yOwoJCQludW0gbGVuID0gYnl0ZUFycmF5W2ldOwoJCQlpKys7CgkJCW51bVtdIGJ5dGVBID0gbnVtW107CgkJCWZvciAobnVtIGsgPSAwOyBrIDwgbGVuOyBrKyspCgkJCXsKCQkJCWFkZFRvIGJ5dGVBIGJ5dGVBcnJheVtpXTsKCQkJCWkrKzsKCQkJfQoJCQkjIG51bVtdIGJ5dGVBID0gbnVtW107IGFkZFRvIGJ5dGVBIGJ5dGVBcnJheVtpXTsKCQkJdG9iai50eXBlID0gZHR5cGVzX0J5dGVBcnJheVRvU3RyKGJ5dGVBKTsKICAgICAgICAgICAgIyBpKz0xOwoJCQkjIEdBTUUubG9nKCJ0eXBlOiIsdG9iai50eXBlKTsKCQl9CiAgICAgICAgaWYgKChjb250ZW50czEgJiBzeW5jb2Jqc19oX2VURVhUVVJFKSA+IDApIHsKCQkJdG9iai5haWQgPSBkdHlwZXNfbWVyZ2UyQnl0ZXMoYnl0ZUFycmF5W2ldLGJ5dGVBcnJheVtpKzFdKTsKICAgICAgICAgICAgaSs9MjsKCQl9CiAgICAgICAgaWYgKChjb250ZW50czEgJiBzeW5jb2Jqc19oX2VDT0xPUikgPiAwKSB7CgkJCXRvYmouY29sb3IgPSBieXRlQXJyYXlbaV0gfCAoYnl0ZUFycmF5W2krMV0gPDwgOCkgfCAoYnl0ZUFycmF5W2krMl0gPDwgMTYpOwogICAgICAgICAgICBpKz0zOwoJCX0KICAgICAgICBpZiAoKGNvbnRlbnRzMSAmIHN5bmNvYmpzX2hfZUVNSVNTSVZFKSA+IDApIHsKCQkJdG9iai5lbWlzc2l2ZSA9IGJ5dGVBcnJheVtpXSB8IChieXRlQXJyYXlbaSsxXSA8PCA4KSB8IChieXRlQXJyYXlbaSsyXSA8PCAxNik7CiAgICAgICAgICAgIGkrPTM7CgkJfQoJCWlmICgoY29udGVudHMyICYgc3luY29ianNfaF9lQ09MTElTSU9OKSA+IDApCgkJewoJCQl0b2JqLmNvbGxpZGUgPSB7CgkJCQl0eXBlOmJ5dGVBcnJheVtpXSwKCQkJCWdlb21ldHJ5OmJ5dGVBcnJheVtpKzFdLAoJCQkJcmVzb2x2ZTpieXRlQXJyYXlbaSsyXQoJCQl9OwoJCQlpKz0zOwoJCX0KCQlhZGRUbyBvYmpsaXN0IHRvYmo7Cgl9Cglmb3IgKG51bSBqID0gMDsgaiA8IHRvdGFsZGVsb2JqczsgaisrKXsKCQludW0gb2JqaWQgPSBkdHlwZXNfbWVyZ2UyQnl0ZXMoYnl0ZUFycmF5W2ldLGJ5dGVBcnJheVtpKzFdKTsKCQlhZGRUbyBkZWxMaXN0IG9iamlkOwoJCWkrPTI7Cgl9CgoKCXJldHVybiB7b2JqbGlzdDpvYmpsaXN0LGRlbExpc3Q6ZGVsTGlzdH07Cn0KCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojIExpYnJhcnk6IFxsaWJzXHN5bmNvYmpzXHN5bmNvYmpzX3Mua3JuawojIEF1dGhvcjogYmxhbmRyaWNlCiMgICBEZXNjcmlwdGlvbjogbm90IHJlYWR5IQojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCm51bSBzeW5jb2Jqc19zX1NZTkNfSU5URVJWQUwgPSA1MDsKbnVtIHN5bmNvYmpzX3NfREVTSVJFRF9GUFMgPSA1OwpudW0gc3luY29ianNfc19NQVhMRU5fTkVUREFUQSA9IDE1MDA7CgojIG9iamVjdCBjb250ZW50cwpudW1bXSBhY3Rpb24gc3luY29ianNfc19vYmpzVG9CeXRlQXJyYXkob2JqW10gc3luY29ianNfc19vYmpsaXN0LGJvb2wgcmVzZXQsIG9iaiBwbHIsIG9ialtdIHBscnMpIHsKCW51bVtdIHJldEFycmF5ID0gbnVtW107CiAgICBudW1bXSBkZWxBcnJheSA9IG51bVtdOwogICAgbnVtIHRvdGFsb2JqcyA9IDA7CiAgICBudW0gdG90YWxkZWxvYmpzID0gMDsKCiAgICAjIDEgYnl0ZSBsZW5ndGggb2Ygb2JqZWN0cwogICAgYWRkVG8gcmV0QXJyYXkgMDsKCiAgICAjIDEgYnl0ZSBsZW5ndGggb2YgZGVsIGxpc3QKICAgIGFkZFRvIHJldEFycmF5IDA7CgoJZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBzeW5jb2Jqc19zX29iamxpc3Q7IGkrKykgewoJCW9iaiB0T2JqID0gc3luY29ianNfc19vYmpsaXN0W2ldOwogICAgICAgIGlmICgoc3RyKXRPYmouZGVsICE9ICJ1bmRlZmluZWQiICYmIChib29sKXRPYmouZGVsID09IHRydWUpewogICAgICAgICAgICBpZiAoIWxpc3R1dGlsX2luc3RybGlzdCgoc3RyKXBsci5pZCwoc3RyW10pdE9iai5kZWxwbHJpZHMpKXsKICAgICAgICAgICAgICAgIGFkZFRvIChzdHJbXSl0T2JqLmRlbHBscmlkcyAoc3RyKXBsci5pZDsKICAgICAgICAgICAgICAgICMgYWRkVG8gZGVsQXJyYXkgdG9OdW0gKHN0cikgdE9iai5vYmppZDsKICAgICAgICAgICAgICAgIG51bVtdIHRPYmpJRF9hcnIgPSBudW1bXTsKICAgICAgICAgICAgICAgIHRPYmpJRF9hcnIgPSBkdHlwZXNfaW50MTZ0b0J5dGVBcnJheSh0b051bSAoc3RyKSB0T2JqLm9iamlkKTsKICAgICAgICAgICAgICAgICMgYWRkVG8gZGVsQXJyYXkgdG9OdW0gKHN0cikgdE9iai5vYmppZDsKICAgICAgICAgICAgICAgIGFkZFRvIGRlbEFycmF5IHRPYmpJRF9hcnJbMF07IGFkZFRvIGRlbEFycmF5IHRPYmpJRF9hcnJbMV07CiAgICAgICAgICAgICAgICB0b3RhbGRlbG9ianMrKzsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlewogICAgICAgICAgICB0b3RhbG9ianMrKzsKICAgICAgICB9CgoJCW51bVtdIHRBcnJheSA9IG51bVtdOwoKCQkjIDIgYnl0ZXMgKDE2Yml0cykgb2JqZWN0IGNvbnRlbnRzCgkJbnVtIGNvbnRlbnRzMSA9IDB4MDA7CgkJbnVtIGNvbnRlbnRzMiA9IDB4MDA7CgkJbnVtIGNvbnRlbnRzaWR4ID0gbGVuZ3RoT2YgcmV0QXJyYXk7CgkJYWRkVG8gcmV0QXJyYXkgY29udGVudHMxOwoJCWFkZFRvIHJldEFycmF5IGNvbnRlbnRzMjsKCQkjIGlmICgobnVtKSB0T2JqLmhpdD4wKSB7Y29udGVudHMgfD0gIDB4ODA7fQoJCQoJCSMgMiBieXRlcyBzeW5jb2Jqc19zX29iamlkCgkJdEFycmF5ID0gZHR5cGVzX2ludDE2dG9CeXRlQXJyYXkoZHR5cGVzX251bVRvVWludDE2KChudW0pdE9iai5vYmppZCkpOyBhZGRUbyByZXRBcnJheSB0QXJyYXlbMF07IGFkZFRvIHJldEFycmF5IHRBcnJheVsxXTsKCgkJIyA0IGJ5dGVzIGhlYWx0aC9maGVhbHRoCgkJaWYgKG5vdEVtcHR5IChvYmopIHRPYmouaGVhbHRoKSB7CiAgICAgICAgICAgICAgICBib29sIGhlYWx0aGNoYW5nZWQgPSAoKG51bSkgdE9iai5oZWFsdGguaCAhPSAobnVtKSB0T2JqLmhlYWx0aF9vbGQuaCkgfHwgKChudW0pIHRPYmouaGVhbHRoLmZoICE9IChudW0pIHRPYmouaGVhbHRoX29sZC5maCk7CiAgICAgICAgICAgICAgICBpZiAoaGVhbHRoY2hhbmdlZCl7CiAgICAgICAgICAgICAgICAgICAgdE9iai5oZWFsdGhfb2xkID0gc3RyW107CiAgICAgICAgICAgICAgICAgICAgdE9iai5oZWFsdGhfb2xkID0ge3g6dE9iai5oZWFsdGguaCx5OnRPYmouaGVhbHRoLmZofTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChoZWFsdGhjaGFuZ2VkIHx8ICgoIWxpc3R1dGlsX2luc3RybGlzdCgoc3RyKXBsci5pZCwoc3RyW10pdE9iai5oZWFsdGhfb2xkX3BscnMpKSkgfHwgcmVzZXQpIHsKICAgICAgICAgICAgICAgICAgICBjb250ZW50czEgfD0gIHN5bmNvYmpzX2hfZUhFQUxUSDsKICAgICAgICAgICAgICAgICAgICB0QXJyYXkgPSBkdHlwZXNfaW50MTZ0b0J5dGVBcnJheShkdHlwZXNfbnVtVG9VaW50MTYoKG51bSl0T2JqLmhlYWx0aC5oKSk7IGFkZFRvIHJldEFycmF5IHRBcnJheVswXTsgYWRkVG8gcmV0QXJyYXkgdEFycmF5WzFdOwogICAgICAgICAgICAgICAgICAgIHRBcnJheSA9IGR0eXBlc19pbnQxNnRvQnl0ZUFycmF5KGR0eXBlc19udW1Ub1VpbnQxNigobnVtKXRPYmouaGVhbHRoLmZoKSk7IGFkZFRvIHJldEFycmF5IHRBcnJheVswXTsgYWRkVG8gcmV0QXJyYXkgdEFycmF5WzFdOwogICAgICAgICAgICAgICAgICAgIGFkZFRvICAoc3RyW10pIHRPYmouaGVhbHRoX29sZF9wbHJzIChzdHIpcGxyLmlkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgkJIyA2IGJ5dGVzIHBvc2l0aW9uCgkJIyBpZiAobm90RW1wdHkgKG9iaikgdE9iai5wb3NpdGlvbikge30KICAgICAgICBpZiAobm90RW1wdHkgKG9iaikgdE9iai5wb3NpdGlvbikgewogICAgICAgICAgICBib29sIHBvc2NoYW5nZWQgPSAoKG51bSkgdE9iai5wb3NpdGlvbi54ICE9IChudW0pIHRPYmoucG9zX29sZC54KSB8fCAoKG51bSkgdE9iai5wb3NpdGlvbi55ICE9IChudW0pIHRPYmoucG9zX29sZC55KSAgfHwgKChudW0pIHRPYmoucG9zaXRpb24ueiAhPSAobnVtKSB0T2JqLnBvc19vbGQueik7CiAgICAgICAgICAgIGlmIChwb3NjaGFuZ2VkKXsKICAgICAgICAgICAgICAgIHRPYmoucG9zX29sZF9wbHJzID0gc3RyW107CiAgICAgICAgICAgICAgICB0T2JqLnBvc19vbGQgPSB7eDp0T2JqLnBvc2l0aW9uLngseTp0T2JqLnBvc2l0aW9uLnksejp0T2JqLnBvc2l0aW9uLnp9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwb3NjaGFuZ2VkIHx8ICgoIWxpc3R1dGlsX2luc3RybGlzdCgoc3RyKXBsci5pZCwoc3RyW10pdE9iai5wb3Nfb2xkX3BscnMpKSkgfHwgcmVzZXQpewogICAgICAgICAgICAgICAgY29udGVudHMxIHw9ICBzeW5jb2Jqc19oX2VQT1NJVElPTjsKICAgICAgICAgICAgICAgIHRBcnJheSA9IGR0eXBlc19pbnQxNnRvQnl0ZUFycmF5KGR0eXBlc19udW1Ub0ludDE2KChudW0pdE9iai5wb3NpdGlvbi54KSk7IGFkZFRvIHJldEFycmF5IHRBcnJheVswXTsgYWRkVG8gcmV0QXJyYXkgdEFycmF5WzFdOwogICAgICAgICAgICAgICAgdEFycmF5ID0gZHR5cGVzX2ludDE2dG9CeXRlQXJyYXkoZHR5cGVzX251bVRvSW50MTYoKG51bSl0T2JqLnBvc2l0aW9uLnkpKTsgYWRkVG8gcmV0QXJyYXkgdEFycmF5WzBdOyBhZGRUbyByZXRBcnJheSB0QXJyYXlbMV07CiAgICAgICAgICAgICAgICB0QXJyYXkgPSBkdHlwZXNfaW50MTZ0b0J5dGVBcnJheShkdHlwZXNfbnVtVG9JbnQxNigobnVtKXRPYmoucG9zaXRpb24ueikpOyBhZGRUbyByZXRBcnJheSB0QXJyYXlbMF07IGFkZFRvIHJldEFycmF5IHRBcnJheVsxXTsKICAgICAgICAgICAgICAgIGFkZFRvICAoc3RyW10pIHRPYmoucG9zX29sZF9wbHJzIChzdHIpcGxyLmlkOwogICAgICAgICAgICB9CgkJfQoJCSMgNiBieXRlcyByb3RhdGlvbgoJCWlmIChub3RFbXB0eSAob2JqKSB0T2JqLnJvdGF0aW9uKSB7CiAgICAgICAgICAgIGJvb2wgcm90Y2hhbmdlZCA9ICgobnVtKSB0T2JqLnJvdGF0aW9uLnggIT0gKG51bSkgdE9iai5yb3Rfb2xkLngpIHx8ICgobnVtKSB0T2JqLnJvdGF0aW9uLnkgIT0gKG51bSkgdE9iai5yb3Rfb2xkLnkpICB8fCAoKG51bSkgdE9iai5yb3RhdGlvbi56ICE9IChudW0pIHRPYmoucm90X29sZC56KTsKICAgICAgICAgICAgaWYgKHJvdGNoYW5nZWQpewogICAgICAgICAgICAgICAgdE9iai5yb3Rfb2xkX3BscnMgPSBzdHJbXTsKICAgICAgICAgICAgICAgIHRPYmoucm90X29sZCA9IHt4OnRPYmoucm90YXRpb24ueCx5OnRPYmoucm90YXRpb24ueSx6OnRPYmoucm90YXRpb24uen07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHJvdGNoYW5nZWQgfHwgKCghbGlzdHV0aWxfaW5zdHJsaXN0KChzdHIpcGxyLmlkLChzdHJbXSl0T2JqLnJvdF9vbGRfcGxycykpKSB8fCByZXNldCl7CiAgICAgICAgICAgICAgICBjb250ZW50czEgfD0gIHN5bmNvYmpzX2hfZVJPVEFUSU9OOwogICAgICAgICAgICAgICAgdEFycmF5ID0gZHR5cGVzX2ludDE2dG9CeXRlQXJyYXkoZHR5cGVzX251bVRvRmxvYXQxNigobnVtKXRPYmoucm90YXRpb24ueCkpOyBhZGRUbyByZXRBcnJheSB0QXJyYXlbMF07IGFkZFRvIHJldEFycmF5IHRBcnJheVsxXTsKICAgICAgICAgICAgICAgICMgR0FNRS5sb2coIng6ICIsZHR5cGVzX251bVRvRmxvYXQxNigobnVtKXRPYmoucm90YXRpb24ueCksIHByaW50QmluYXJ5KGR0eXBlc19udW1Ub0Zsb2F0MTYoKG51bSl0T2JqLnJvdGF0aW9uLngpKSk7CiAgICAgICAgICAgICAgICB0QXJyYXkgPSBkdHlwZXNfaW50MTZ0b0J5dGVBcnJheShkdHlwZXNfbnVtVG9GbG9hdDE2KChudW0pdE9iai5yb3RhdGlvbi55KSk7IGFkZFRvIHJldEFycmF5IHRBcnJheVswXTsgYWRkVG8gcmV0QXJyYXkgdEFycmF5WzFdOwogICAgICAgICAgICAgICAgdEFycmF5ID0gZHR5cGVzX2ludDE2dG9CeXRlQXJyYXkoZHR5cGVzX251bVRvRmxvYXQxNigobnVtKXRPYmoucm90YXRpb24ueikpOyBhZGRUbyByZXRBcnJheSB0QXJyYXlbMF07IGFkZFRvIHJldEFycmF5IHRBcnJheVsxXTsKICAgICAgICAgICAgICAgIGFkZFRvICAoc3RyW10pIHRPYmoucm90X29sZF9wbHJzIChzdHIpcGxyLmlkOwogICAgICAgICAgICB9CgkJfQoJCSMgNiBieXRlcyBzY2FsZQoJCWlmIChub3RFbXB0eSAob2JqKSB0T2JqLnNjYWxlKSB7CiAgICAgICAgICAgIGJvb2wgc2NhbGVjaGFuZ2VkID0gKChudW0pIHRPYmouc2NhbGUueCAhPSAobnVtKSB0T2JqLnNjYWxlX29sZC54KSB8fCAoKG51bSkgdE9iai5zY2FsZS55ICE9IChudW0pIHRPYmouc2NhbGVfb2xkLnkpICB8fCAoKG51bSkgdE9iai5zY2FsZS56ICE9IChudW0pIHRPYmouc2NhbGVfb2xkLnopOwogICAgICAgICAgICBpZiAoc2NhbGVjaGFuZ2VkKXsKICAgICAgICAgICAgICAgIHRPYmouc2NhbGVfb2xkX3BscnMgPSBzdHJbXTsKICAgICAgICAgICAgICAgIHRPYmouc2NhbGVfb2xkID0ge3g6dE9iai5zY2FsZS54LHk6dE9iai5zY2FsZS55LHo6dE9iai5zY2FsZS56fTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc2NhbGVjaGFuZ2VkIHx8ICgoIWxpc3R1dGlsX2luc3RybGlzdCgoc3RyKXBsci5pZCwoc3RyW10pdE9iai5zY2FsZV9vbGRfcGxycykpKSB8fCByZXNldCl7CiAgICAgICAgICAgICAgICBjb250ZW50czEgfD0gIHN5bmNvYmpzX2hfZVNDQUxFOwogICAgICAgICAgICAgICAgdEFycmF5ID0gZHR5cGVzX2ludDE2dG9CeXRlQXJyYXkoZHR5cGVzX251bVRvSW50MTYoKG51bSl0T2JqLnNjYWxlLngpKTsgYWRkVG8gcmV0QXJyYXkgdEFycmF5WzBdOyBhZGRUbyByZXRBcnJheSB0QXJyYXlbMV07CiAgICAgICAgICAgICAgICB0QXJyYXkgPSBkdHlwZXNfaW50MTZ0b0J5dGVBcnJheShkdHlwZXNfbnVtVG9JbnQxNigobnVtKXRPYmouc2NhbGUueSkpOyBhZGRUbyByZXRBcnJheSB0QXJyYXlbMF07IGFkZFRvIHJldEFycmF5IHRBcnJheVsxXTsKICAgICAgICAgICAgICAgIHRBcnJheSA9IGR0eXBlc19pbnQxNnRvQnl0ZUFycmF5KGR0eXBlc19udW1Ub0ludDE2KChudW0pdE9iai5zY2FsZS56KSk7IGFkZFRvIHJldEFycmF5IHRBcnJheVswXTsgYWRkVG8gcmV0QXJyYXkgdEFycmF5WzFdOwogICAgICAgICAgICAgICAgYWRkVG8gIChzdHJbXSkgdE9iai5zY2FsZV9vbGRfcGxycyAoc3RyKXBsci5pZDsKICAgICAgICAgICAgfQoJCX0KICAgICAgICAjIDcgYnl0ZXMgZGV0YWlscyAoMiB0eXBlLCAyIHRleHR1cmUsIDMgY29sb3IpCiAgICAgICAgIyB0eXBlIChjdWJlLCBzcGhlcmUsIHNwcml0ZSwgbW9kZWxJRCkKICAgICAgICBpZiAoKHN0cil0T2JqLnR5cGUgIT0gInVuZGVmaW5lZCIpCiAgICAgICAgeyAgIAogICAgICAgICAgICBib29sIHR5cGVjaGFuZ2VkID0gKChudW0pIHRPYmoudHlwZSAhPSAobnVtKSB0T2JqLnR5cGVfb2xkKTsKICAgICAgICAgICAgaWYgKHR5cGVjaGFuZ2VkKXsKICAgICAgICAgICAgICAgIHRPYmoudHlwZV9vbGRfcGxycyA9IHN0cltdOwogICAgICAgICAgICAgICAgdE9iai50eXBlX29sZCA9IChudW0pdE9iai50eXBlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh0eXBlY2hhbmdlZCB8fCAoKCFsaXN0dXRpbF9pbnN0cmxpc3QoKHN0cilwbHIuaWQsKHN0cltdKXRPYmoudHlwZV9vbGRfcGxycykpKSB8fCByZXNldCl7CiAgICAgICAgICAgICAgICBjb250ZW50czEgfD0gIHN5bmNvYmpzX2hfZVRZUEU7CiAgICAgICAgICAgICAgICAjIHRBcnJheSA9IGR0eXBlc19pbnQxNnRvQnl0ZUFycmF5KChudW0pdE9iai50eXBlKTsgYWRkVG8gcmV0QXJyYXkgdEFycmF5WzBdOyBhZGRUbyByZXRBcnJheSB0QXJyYXlbMV07ICAgIAogICAgICAgICAgICAgICAgIyBudW0gbGVuID0gbGVuZ3RoT2YgKHN0cil0T2JqLnR5cGU7CiAgICAgICAgICAgICAgICAjIGFkZFRvIHJldEFycmF5IGxlbjsKICAgICAgICAgICAgICAgIHRBcnJheSA9IGR0eXBlc19zdHJ0b0J5dGVBcnJheSgoc3RyKXRPYmoudHlwZSk7CiAgICAgICAgICAgICAgICBudW0gbGVuID0gbGVuZ3RoT2YgdEFycmF5OwogICAgICAgICAgICAgICAgYWRkVG8gcmV0QXJyYXkgbGVuOwogICAgICAgICAgICAgICAgZm9yIChudW0gaiA9IDA7IGogPCBsZW47IGorKykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBhZGRUbyByZXRBcnJheSB0QXJyYXlbal07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAjIHRBcnJheSA9IGR0eXBlc19zdHJ0b0J5dGVBcnJheSgoc3RyKXRPYmoudHlwZSk7IGFkZFRvIHJldEFycmF5IHRBcnJheVswXTsKICAgICAgICAgICAgICAgIGFkZFRvICAoc3RyW10pIHRPYmoudHlwZV9vbGRfcGxycyAoc3RyKXBsci5pZDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAjIGFpZCAodGV4dHVyZSkgQ0FOTk9UIEJFIFVQREFURUQgWUVUIElOIEtTCiAgICAgICAgaWYgKChzdHIpdE9iai5haWQhPSJ1bmRlZmluZWQiKXsKICAgICAgICAgICAgYm9vbCBhaWRfY2hhbmdlZCA9ICgobnVtKSB0T2JqLmFpZCAhPSAobnVtKSB0T2JqLmFpZF9vbGQpOwogICAgICAgICAgICBpZiAoYWlkX2NoYW5nZWQpewogICAgICAgICAgICAgICAgdE9iai5haWRfb2xkX3BscnMgPSBzdHJbXTsKICAgICAgICAgICAgICAgIHRPYmouYWlkX29sZCA9IChudW0pdE9iai5haWQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGFpZF9jaGFuZ2VkIHx8ICgoIWxpc3R1dGlsX2luc3RybGlzdCgoc3RyKXBsci5pZCwoc3RyW10pdE9iai5haWRfb2xkX3BscnMpKSkgfHwgcmVzZXQpewogICAgICAgICAgICAgICAgY29udGVudHMxIHw9ICBzeW5jb2Jqc19oX2VURVhUVVJFOwogICAgICAgICAgICAgICAgdEFycmF5ID0gZHR5cGVzX2ludDE2dG9CeXRlQXJyYXkoKG51bSl0T2JqLmFpZCk7IGFkZFRvIHJldEFycmF5IHRBcnJheVswXTsgYWRkVG8gcmV0QXJyYXkgdEFycmF5WzFdOyAgICAKICAgICAgICAgICAgICAgIGFkZFRvICAoc3RyW10pIHRPYmouYWlkX29sZF9wbHJzIChzdHIpcGxyLmlkOwogICAgICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAjIGNvbG9yCgkJaWYgKChzdHIpIHRPYmouY29sb3IgIT0idW5kZWZpbmVkIil7CiAgICAgICAgICAgIGJvb2wgY29sb3JfY2hhbmdlZCA9ICgobnVtKSB0T2JqLmNvbG9yICE9IChudW0pIHRPYmouY29sb3Jfb2xkKTsKICAgICAgICAgICAgaWYgKGNvbG9yX2NoYW5nZWQpewogICAgICAgICAgICAgICAgdE9iai5jb2xvcl9vbGRfcGxycyA9IHN0cltdOwogICAgICAgICAgICAgICAgdE9iai5jb2xvcl9vbGQgPSAobnVtKXRPYmouY29sb3I7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGNvbG9yX2NoYW5nZWQgfHwgKCghbGlzdHV0aWxfaW5zdHJsaXN0KChzdHIpcGxyLmlkLChzdHJbXSl0T2JqLmNvbG9yX29sZF9wbHJzKSkpIHx8IHJlc2V0KXsKICAgICAgICAgICAgICAgIGNvbnRlbnRzMSB8PSAgc3luY29ianNfaF9lQ09MT1I7CiAgICAgICAgICAgICAgICB0QXJyYXkgPSBkdHlwZXNfQ29sb3JUb0J5dGVBcnJheSgobnVtKXRPYmouY29sb3IpOyBhZGRUbyByZXRBcnJheSB0QXJyYXlbMF07IGFkZFRvIHJldEFycmF5IHRBcnJheVsxXTsgYWRkVG8gcmV0QXJyYXkgdEFycmF5WzJdOwogICAgICAgICAgICAgICAgYWRkVG8gIChzdHJbXSkgdE9iai5jb2xvcl9vbGRfcGxycyAoc3RyKXBsci5pZDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAjIGVtaXNzaXZlCgkJaWYgKChzdHIpIHRPYmouZW1pc3NpdmUgIT0idW5kZWZpbmVkIil7CiAgICAgICAgICAgIGJvb2wgZW1pc3NpdmVfY2hhbmdlZCA9ICgobnVtKSB0T2JqLmVtaXNzaXZlICE9IChudW0pIHRPYmouZW1pc3NpdmVfb2xkKTsKICAgICAgICAgICAgaWYgKGVtaXNzaXZlX2NoYW5nZWQpewogICAgICAgICAgICAgICAgIyBzdHIgY29sciA9ICIjIiArIGR0eXBlc19udW0yaGV4c3RyaW5nKChudW0pIHRPYmouZW1pc3NpdmUpOwogICAgICAgICAgICAgICAgdE9iai5lbWlzc2l2ZV9vbGRfcGxycyA9IHN0cltdOwogICAgICAgICAgICAgICAgdE9iai5lbWlzc2l2ZV9vbGQgPSAobnVtKXRPYmouZW1pc3NpdmU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGVtaXNzaXZlX2NoYW5nZWQgfHwgKCghbGlzdHV0aWxfaW5zdHJsaXN0KChzdHIpcGxyLmlkLChzdHJbXSl0T2JqLmVtaXNzaXZlX29sZF9wbHJzKSkpIHx8IHJlc2V0KXsKICAgICAgICAgICAgICAgIGNvbnRlbnRzMSB8PSAgc3luY29ianNfaF9lRU1JU1NJVkU7CiAgICAgICAgICAgICAgICB0QXJyYXkgPSBkdHlwZXNfQ29sb3JUb0J5dGVBcnJheSgobnVtKXRPYmouZW1pc3NpdmUpOyBhZGRUbyByZXRBcnJheSB0QXJyYXlbMF07IGFkZFRvIHJldEFycmF5IHRBcnJheVsxXTsgYWRkVG8gcmV0QXJyYXkgdEFycmF5WzJdOwogICAgICAgICAgICAgICAgYWRkVG8gIChzdHJbXSkgdE9iai5lbWlzc2l2ZV9vbGRfcGxycyAoc3RyKXBsci5pZDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAjIGNvbGxpZGUKICAgICAgICBpZiAoKHN0cil0T2JqLmNvbGxpZGUgIT0gInVuZGVmaW5lZCIpCiAgICAgICAgewogICAgICAgICAgICBib29sIGNvbGxpc2lvbl9jaGFuZ2VkID0gKCgobnVtKSB0T2JqLmNvbGxpZGUudHlwZSAhPSAobnVtKSB0T2JqLmNvbGxpZGVfb2xkLnR5cGUpfHwoKG51bSkgdE9iai5jb2xsaWRlLmdlb21ldHJ5ICE9IChudW0pIHRPYmouY29sbGlkZV9vbGQuZ2VvbWV0cnkpfHwoKG51bSkgdE9iai5jb2xsaWRlLnJlc29sdmUgIT0gKG51bSkgdE9iai5jb2xsaWRlX29sZC5yZXNvbHZlKSk7CiAgICAgICAgICAgIGlmIChjb2xsaXNpb25fY2hhbmdlZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdE9iai5jb2xsaWRlX29sZF9wbHJzID0gc3RyW107CiAgICAgICAgICAgICAgICB0T2JqLmNvbGxpZGVfb2xkID0gewogICAgICAgICAgICAgICAgICAgIHR5cGU6dE9iai5jb2xsaWRlLnR5cGUsIAogICAgICAgICAgICAgICAgICAgIGdlb21ldHJ5OnRPYmouY29sbGlkZS5nZW9tZXRyeSwKICAgICAgICAgICAgICAgICAgICByZXNvbHZlOnRPYmouY29sbGlkZS5yZXNvbHZlIAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoY29sbGlzaW9uX2NoYW5nZWQgfHwgKCghbGlzdHV0aWxfaW5zdHJsaXN0KChzdHIpcGxyLmlkLChzdHJbXSl0T2JqLmNvbGxpZGVfb2xkX3BscnMpKSkgfHwgcmVzZXQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvbnRlbnRzMiB8PSBzeW5jb2Jqc19oX2VDT0xMSVNJT047CiAgICAgICAgICAgICAgICBhZGRUbyByZXRBcnJheSAobnVtKXRPYmouY29sbGlkZS50eXBlOyAKICAgICAgICAgICAgICAgIGFkZFRvIHJldEFycmF5IChudW0pdE9iai5jb2xsaWRlLmdlb21ldHJ5OwogICAgICAgICAgICAgICAgYWRkVG8gcmV0QXJyYXkgKG51bSl0T2JqLmNvbGxpZGUucmVzb2x2ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCQlyZXRBcnJheVtjb250ZW50c2lkeF0gPSBjb250ZW50czE7CgkJcmV0QXJyYXlbY29udGVudHNpZHgrMV0gPSBjb250ZW50czI7Cgl9CgogICAgZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBkZWxBcnJheTsgaSsrKXsKICAgICAgICBhZGRUbyByZXRBcnJheSBkZWxBcnJheVtpXTsKICAgIH0KICAgIHJldEFycmF5WzBdID0gdG90YWxvYmpzOwogICAgcmV0QXJyYXlbMV0gPSB0b3RhbGRlbG9ianM7CglyZXR1cm4gcmV0QXJyYXk7Cn0KCm51bSBzeW5jb2Jqc19zX3RsYXN0YnJvYWRjYXN0ID0gMDsKb2JqW10gc3luY29ianNfc19vYmpsaXN0ID0gb2JqW107Cm51bVtdIHN5bmNvYmpzX3NfbmV3ZGVsbGlzdCA9IG51bVtdOwpudW0gc3luY29ianNfc19vYmppZCA9IDA7CmJvb2wgc3luY29ianNfc19vYmppZG92ZXJmbG93ID0gZmFsc2U7Cm51bSBzeW5jb2Jqc19zX3Rub3cgPSAwOwpudW0gc3luY29ianNfc19CWVRFT1ZFUkZMT1dfTEVOID0gNjU1MzU7CiMgbnVtIHN5bmNvYmpzX3NfQllURU9WRVJGTE9XX0xFTiA9IDI1NjsKCiMgV0FSTklORzogcGFzcyBpbiBhIGZyZXNoIG9iamVjdCBvbmx5IC0gbm90IGEgcmVmZXJlbmNlISBvdGhlcndpc2UgeW91IHJpc2sgbW9kaWZ5aW5nIHRoZSByZWZlcmVuY2UKIyBmb3IgZXhhbXBsZSBkb24ndCBwYXNzIGluIGEgdGVtcGxhdGUgb2JqZWN0IGZvciBzeW5jb2Jqc19zX2NyZWF0ZU9iamVjdCh0ZW1wbGF0ZUJhbGwpLgoKb2JqIGFjdGlvbiBzeW5jb2Jqc19zX2ZpbmRPYmpieUlEKHN0ciBpZCl7CiAgICBmb3IgKG51bSBpID0gbGVuZ3RoT2Ygc3luY29ianNfc19vYmpsaXN0IC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICBpZiAoKHN0cikgc3luY29ianNfc19vYmpsaXN0W2ldLm9iamlkID09IGlkKSB7CiAgICAgICAgICAgIHJldHVybiBzeW5jb2Jqc19zX29iamxpc3RbaV07CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIHt9Owp9CgpvYmogYWN0aW9uIHN5bmNvYmpzX3NfY3JlYXRlT2JqZWN0KG9iaiBkKSB7CiAgICBpZiAobGVuZ3RoT2Ygc3luY29ianNfc19vYmpsaXN0ID49IHN5bmNvYmpzX3NfQllURU9WRVJGTE9XX0xFTikKICAgIHsKICAgICAgICBHQU1FLmxvZygiRVJST1I6IEVYQ0VFREVEIE1BWElNVU0gT0JKRUNUUyBJTiBPQkpMSVNUICIsc3luY29ianNfc19CWVRFT1ZFUkZMT1dfTEVOKTsKICAgICAgICByZXR1cm4ge307CiAgICB9IGVsc2UgaWYgKHN5bmNvYmpzX3Nfb2JqaWRvdmVyZmxvdykKICAgIHsKICAgICAgICBvYmogdG9iaiA9IHN5bmNvYmpzX3NfZmluZE9iamJ5SUQodG9TdHIgc3luY29ianNfc19vYmppZCk7CiAgICAgICAgd2hpbGUobm90RW1wdHkgdG9iaikKICAgICAgICB7CiAgICAgICAgICAgIHN5bmNvYmpzX3Nfb2JqaWQrKzsKICAgICAgICAgICAgaWYgKHN5bmNvYmpzX3Nfb2JqaWQ+PXN5bmNvYmpzX3NfQllURU9WRVJGTE9XX0xFTikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgc3luY29ianNfc19vYmppZD0wOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgfQogICAgIyBvYmplY3QgdGVtcGxhdGUhCiAgICBvYmogdG9iaiA9IHsKICAgICAgICB0eXBlOiAiMCIsICMwID0gY3ViZSwgMSA9IHNwaGVyZSwgMiA9IGN5bGluZGVyLCBhbGwgZWxzZSA9IG1vZGVsSUQKICAgICAgICBhaWQ6IDM0Mzc5LAogICAgICAgIHNjYWxlOiB7eDoyMCx5OjgwLHo6MjB9LCAjIG1vZGVscyBvbmx5IG5lZWQgeDpzY2FsZSB3aGljaCBpcyBhbGwgMyBkaW1lbnNpb25zCiAgICAgICAgcG9zaXRpb246IHt4OjEseToxLHo6MX0sCiAgICAgICAgdmVsb2NpdHk6IHt4OjAseTowLHo6MH0sCiAgICAgICAgcm90YXRpb246IHt4OjAseTowLHo6MH0sCiAgICAgICAgY29sb3I6IDB4MDBBOEY5LAogICAgICAgIGVtaXNzaXZlOjB4MDAwMDAwLAogICAgICAgIGNvbGxpZGU6IAogICAgICAgIHsKICAgICAgICAgICAgdHlwZTowLCAjIHN5bmNvYmpzX2ggY29sbGlzaW9uIEVOVU0gdHlwZXMgMCA9IENPTF9OT05FCiAgICAgICAgICAgIGdlb21ldHJ5OjAsICMgc3luY29ianNfaCBnZW9tZXRyeSBFTlVNIHR5cGVzIDAgPSBDVUJFCiAgICAgICAgICAgIHJlc29sdmU6MCAjIGN1cnJlbnRseSBvbmx5IHJlc29sdmUgaXMgc3RvcCBtb3ZlbWVudAogICAgICAgIH0KICAgIH07CiAgICBpZiAoKHN0cikgZC50eXBlID09ICJ1bmRlZmluZWQiKSB7ZC50eXBlID0gdG9iai50eXBlO30KICAgIGQudHlwZV9vbGQgPSAoc3RyKWQudHlwZSArICJhIjsKICAgIGQudHlwZV9vbGRfcGxycyA9IHN0cltdOwogICAgaWYgKChzdHIpIGQuYWlkID09ICJ1bmRlZmluZWQiKSB7ZC5haWQgPSB0b2JqLmFpZDt9CiAgICBkLmFpZF9vbGRfcGxycyA9IHN0cltdOwogICAgZC5haWRfb2xkID0gKG51bSlkLmFpZCArIDE7CiAgICBpZiAoIW5vdEVtcHR5IChvYmopIGQuc2NhbGUpIHtkLnNjYWxlID0gdG9iai5zY2FsZTt9CiAgICBkLnNjYWxlX29sZF9wbHJzID0gc3RyW107CiAgICBkLnNjYWxlX29sZCA9IHt4OjAseTowLHo6KG51bSlkLnNjYWxlLnorMX07CiAgICBpZiAoIW5vdEVtcHR5IChvYmopIGQucG9zaXRpb24pIHtkLnBvc2l0aW9uID0gdG9iai5wb3NpdGlvbjt9CiAgICBkLnBvc19vbGRfcGxycyA9IHN0cltdOwogICAgZC5wb3Nfb2xkID0ge3g6MCx5OjAsejoobnVtKWQucG9zaXRpb24ueisxfTsKICAgIGlmICghbm90RW1wdHkgKG9iaikgZC52ZWxvY2l0eSkge2QudmVsb2NpdHkgPSB0b2JqLnZlbG9jaXR5O30KICAgIGQudmVsX29sZF9wbHJzID0gc3RyW107CiAgICBkLnZlbF9vbGQgPSB7eDowLHk6MCx6OihudW0pZC52ZWxvY2l0eS56KzF9OwogICAgaWYgKCFub3RFbXB0eSAob2JqKSBkLnJvdGF0aW9uKSB7ZC5yb3RhdGlvbiA9IHRvYmoucm90YXRpb247fQogICAgZC5yb3Rfb2xkX3BscnMgPSBzdHJbXTsKICAgIGQucm90X29sZCA9IHt4OjAseTowLHo6KG51bSlkLnJvdGF0aW9uLnorMX07CiAgICAjaWYgaGVhbHRoIGlzIHRoZXJlLCBhZGQgb2xkIGRhdGEgY29udGFpbmVyCiAgICBpZiAobm90RW1wdHkgKG9iailkLmhlYWx0aCl7CiAgICAgICAgZC5oZWFsdGhfb2xkID0ge2g6MCxmaDoobnVtKWQuaGVhbHRoLmZoLTF9OwogICAgfQogICAgaWYgKChzdHIpIGQuY29sb3IgPT0gInVuZGVmaW5lZCIpIHtkLmNvbG9yID0gdG9iai5jb2xvcjt9CiAgICBkLmNvbG9yX29sZF9wbHJzID0gc3RyW107CiAgICBkLmNvbG9yX29sZCA9IChudW0pZC5jb2xvcisxOwoKICAgIGlmICgoc3RyKSBkLmVtaXNzaXZlID09ICJ1bmRlZmluZWQiKSB7ZC5lbWlzc2l2ZSA9IHRvYmouZW1pc3NpdmU7fQogICAgZC5lbWlzc2l2ZV9vbGRfcGxycyA9IHN0cltdOwogICAgZC5lbWlzc2l2ZV9vbGQgPSAobnVtKWQuZW1pc3NpdmUrMTsKCiAgICBpZiAoIW5vdEVtcHR5IChvYmopZC5jb2xsaWRlKSB7CiAgICAgICAgZC5jb2xsaWRlID0gCiAgICAgICAgewogICAgICAgICAgICB0eXBlOnRvYmouY29sbGlkZS50eXBlLAogICAgICAgICAgICBnZW9tZXRyeTp0b2JqLmNvbGxpZGUuZ2VvbWV0cnksCiAgICAgICAgICAgIHJlc29sdmU6dG9iai5jb2xsaWRlLnJlc29sdmUsCiAgICAgICAgfTsKICAgIH0KICAgIGQuY29sbGlkZV9vbGRfcGxycyA9IHN0cltdOwogICAgZC5jb2xsaWRlX29sZCA9IHt0eXBlOjB4ZGVhZGJlZWYsZ2VvbWV0cnk6MHhkZWFkYmVlZixyZXNvbHZlOjB4ZGVhZGJlZWZ9OwoKICAgIGQub2JqaWQgPSB0b051bSB0b1N0ciBzeW5jb2Jqc19zX29iamlkOyAgICAKICAgIGlmIChzeW5jb2Jqc19zX29iamlkPj1zeW5jb2Jqc19zX0JZVEVPVkVSRkxPV19MRU4pCiAgICB7CiAgICAgICAgc3luY29ianNfc19vYmppZD0wOwogICAgICAgIHN5bmNvYmpzX3Nfb2JqaWRvdmVyZmxvdz10cnVlOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIHN5bmNvYmpzX3Nfb2JqaWQrKzsKICAgIH0KICAgIGFkZFRvIHN5bmNvYmpzX3Nfb2JqbGlzdCBkOwogICAgcmV0dXJuIGQ7Cn0KCmJvb2wgYWN0aW9uIHN5bmNvYmpzX3NfZGVsZXRlT2JqZWN0KHN0ciBpZCkgewogICAgZm9yIChudW0gaSA9IGxlbmd0aE9mIHN5bmNvYmpzX3Nfb2JqbGlzdCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgaWYgKChzdHIpIHN5bmNvYmpzX3Nfb2JqbGlzdFtpXS5vYmppZCA9PSBpZCkgewogICAgICAgICAgICBpZiAoKHN0cilzeW5jb2Jqc19zX29iamxpc3RbaV0uZGVsID09ICJ1bmRlZmluZWQiIHx8IChib29sKXN5bmNvYmpzX3Nfb2JqbGlzdFtpXS5kZWwgPT0gZmFsc2UpewogICAgICAgICAgICAgICAgIyBhZGRUbyBzeW5jb2Jqc19zX25ld2RlbGxpc3QgdG9OdW0gc3luY29ianNfc19vYmpsaXN0W2ldLm9iamlkOwogICAgICAgICAgICAgICAgIyByZW1vdmUgc3luY29ianNfc19vYmpsaXN0W2ldOwogICAgICAgICAgICAgICAgc3luY29ianNfc19vYmpsaXN0W2ldLmRlbD10cnVlOwogICAgICAgICAgICAgICAgc3luY29ianNfc19vYmpsaXN0W2ldLmRlbHBscmlkcz1zdHJbXTsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIGZhbHNlOwp9CgphY3Rpb24gc3luY29ianNfc19kZWxldGVBbGxPYmpzKCl7CiAgICBmb3IgKG51bSBpID0gbGVuZ3RoT2Ygc3luY29ianNfc19vYmpsaXN0IC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICAjIGFkZFRvIHN5bmNvYmpzX3NfbmV3ZGVsbGlzdCB0b051bSBzeW5jb2Jqc19zX29iamxpc3RbaV0ub2JqaWQ7CiAgICAgICAgIyByZW1vdmUgc3luY29ianNfc19vYmpsaXN0W2ldOwogICAgICAgIHN5bmNvYmpzX3Nfb2JqbGlzdFtpXS5kZWw9dHJ1ZTsKICAgICAgICBzeW5jb2Jqc19zX29iamxpc3RbaV0uZGVscGxyaWRzPXN0cltdOwogICAgICAgIAogICAgfQp9CgpzdHJbXSBhY3Rpb24gc3luY29ianNfc19saXN0T2JqSURzKCl7CiAgICBzdHJbXSBsaXN0ID0gc3RyW107CiAgICBmb3IgKG51bSBpID0gMDsgaSA8IGxlbmd0aE9mIHN5bmNvYmpzX3Nfb2JqbGlzdDsgaSsrKXsKICAgICAgICBhZGRUbyBsaXN0IChzdHIpIHN5bmNvYmpzX3Nfb2JqbGlzdFtpXS5vYmppZDsKICAgIH0KICAgIHJldHVybiBsaXN0Owp9CgphY3Rpb24gc3luY29ianNfc19zdGFydCgpIHsKICAgIHN5bmNvYmpzX3Nfb2JqbGlzdCA9IG9ialtdOwogICAgc3luY29ianNfc19vYmppZD0wOwp9CgphY3Rpb24gc3luY29ianNfc191cGRhdGUobnVtIGRlbHRhKSB7CglzeW5jb2Jqc19zX3Rub3cgPSBnX3Rub3c7CgogICAgIyBCcm9hZGNhc3QgU3luY2VkIE9iamVjdHMgZGF0YQogICAgaWYgKChzeW5jb2Jqc19zX3Rub3cgLSBzeW5jb2Jqc19zX3RsYXN0YnJvYWRjYXN0KSA+IHN5bmNvYmpzX3NfU1lOQ19JTlRFUlZBTCkgewogICAgICAgIHN5bmNvYmpzX3NfdGxhc3Ricm9hZGNhc3QgPSBzeW5jb2Jqc19zX3Rub3c7CiAgICAgICAgIyBzdHIgZW5jb2RlZG9iamRhdGEgPSBvYmplbmNvZGluZygpOwogICAgICAgICMgc3RyIGVuY29kZWRvYmpkYXRhID0gYjkxX2VuY29kZShzeW5jb2Jqc19zX29ianNUb0J5dGVBcnJheShzeW5jb2Jqc19zX29iamxpc3QsZmFsc2UpKTsgIyBzZW5kIG5ldyBkYXRhIG9ubHkKICAgICAgICAjIGJvb2wgc3VjY2VzcyA9IEdBTUUuTkVUV09SSy5icm9hZGNhc3QoInN5bmMiLCB7ZGF0YTpvYmpkYXRhfSk7CiAgICAgICAgb2JqW10gcGxycyA9IEdBTUUuUExBWUVSUy5saXN0KCk7CiAgICAgICAgYm9vbCBzdWNjZXNzPXRydWU7CiAgICAgICAgZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBwbHJzOyBpKyspIHsKCiAgICAgICAgICAgIG9iaiBwbHIgPSBwbHJzW2ldOwogICAgICAgICAgICBzdHIgZGF0YXRvc2VuZCA9ICIiOwogICAgICAgICAgICBib29sIHJlc2V0ID0gZmFsc2U7CiAgICAgICAgICAgICMgZ3VhcmQgZm9yIGluaXRpYWxpemluZyBuZXRkYXRhCiAgICAgICAgICAgIGlmICgoc3RyKSBwbHIubmV0ZGF0YSA9PSAidW5kZWZpbmVkIiB8fCAoYm9vbCkgcGxyLm5ldHJlc2V0ID09IHRydWUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHJlc2V0ID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoKHN0cilwbHIubmV0ZGF0YSA9PSAiIiB8fCAoc3RyKSBwbHIubmV0ZGF0YSA9PSAidW5kZWZpbmVkIiB8fCAoYm9vbCkgcGxyLm5ldHJlc2V0ID09IHRydWUpewogICAgICAgICAgICAgICAgcGxyLm5ldGRhdGEgPSBiOTFfZW5jb2RlKHN5bmNvYmpzX3Nfb2Jqc1RvQnl0ZUFycmF5KHN5bmNvYmpzX3Nfb2JqbGlzdCxyZXNldCxwbHIscGxycykpOyAjIHJlc2VuZCBhbGwgZGF0YSByZWdhcmRsZXNzIG9mIGFnZQogICAgICAgICAgICAgICAgcGxyLm5ldGRhdGFsZW4gPSBNYXRoLmNlaWwoKGxlbmd0aE9mIChzdHIpcGxyLm5ldGRhdGEpIC8gc3luY29ianNfc19NQVhMRU5fTkVUREFUQSk7CiAgICAgICAgICAgICAgICBpZiAocmVzZXQpIHsKICAgICAgICAgICAgICAgICAgICBHQU1FLmxvZyhzeW5jb2Jqc19oX2J5dGVBcnJheVRvT2JqcyhiOTFfZGVjb2RlKChzdHIpcGxyLm5ldGRhdGEpKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKCiAgICAgICAgICAgICAgICAjIGNoZWNrIHNpemUgb2YgZW5jb2RlZCBkYXRhIGlzIHRvbyBsYXJnZSBhbmQgd2FybgogICAgICAgICAgICAgICAgaWYgKGxlbmd0aE9mIChzdHIpcGxyLm5ldGRhdGEgPiBzeW5jb2Jqc19zX01BWExFTl9ORVREQVRBKXsKICAgICAgICAgICAgICAgICAgICBudW0gbmV0bmVlZGVkID0gTWF0aC5jZWlsKChsZW5ndGhPZiAoc3RyKXBsci5uZXRkYXRhKSAvIHN5bmNvYmpzX3NfTUFYTEVOX05FVERBVEEpOwogICAgICAgICAgICAgICAgICAgIG51bSB0X2ZwcyA9IDEwMDAvKHN5bmNvYmpzX3NfU1lOQ19JTlRFUlZBTCAqIG5ldG5lZWRlZCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRfZnBzIDwgc3luY29ianNfc19ERVNJUkVEX0ZQUyl7CiAgICAgICAgICAgICAgICAgICAgICAgIEdBTUUubG9nKCJXQVJOOiBkYXRhIGxlbmd0aCBpcyAiLCBsZW5ndGhPZiAoc3RyKXBsci5uZXRkYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgR0FNRS5sb2coInRha2VzICIsIHN5bmNvYmpzX3NfU1lOQ19JTlRFUlZBTCAqIG5ldG5lZWRlZCwgIm1zIHRvIHNlbmQgdXBkYXRlIG9yIEZQUyBpcyAgIiwgdF9mcHMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSAKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICAjIHBsci5uZXRkYXRhbGVuID0gTWF0aC5jZWlsKChsZW5ndGhPZiBlbmNvZGVkb2JqZGF0YSkgLyBzeW5jb2Jqc19zX01BWExFTl9ORVREQVRBKTsKICAgICAgICAgICAgCiAgICAgICAgICAgICMgZmlsbCBuZXR3b3JrIGRhdGEgaWYgaXQgRE5FIHlldAogICAgICAgICAgICAjIGlmIChsZW5ndGhPZiAoc3RyKSBwbHIubmV0ZGF0YSA9PSAwKQogICAgICAgICAgICAjIHsKICAgICAgICAgICAgICAgICMgcGxyLm5ldGRhdGEgPSBlbmNvZGVkb2JqZGF0YTsKICAgICAgICAgICAgICAgICMgcGxyLm5ldGRhdGFsZW4gPSBNYXRoLmNlaWwoKGxlbmd0aE9mIGVuY29kZWRvYmpkYXRhKSAvIHN5bmNvYmpzX3NfTUFYTEVOX05FVERBVEEpOwogICAgICAgICAgICAjIH0KICAgICAgICAgICAgIyBzZW5kIG92ZXIgbmV0ZGF0YSBpbiB0aGUgbWF4IHNpemUgYWxsb3dlZAogICAgICAgICAgICBpZiAobGVuZ3RoT2YgKHN0cikgcGxyLm5ldGRhdGEgPiBzeW5jb2Jqc19zX01BWExFTl9ORVREQVRBKXsKICAgICAgICAgICAgICAgIGRhdGF0b3NlbmQgPSBzdHJ1dGlsc19zcGxpY2UoKHN0cilwbHIubmV0ZGF0YSwwLHN5bmNvYmpzX3NfTUFYTEVOX05FVERBVEEpOwogICAgICAgICAgICAgICAgcGxyLm5ldGRhdGEgPSBzdHJ1dGlsc19zcGxpY2UoKHN0cilwbHIubmV0ZGF0YSxzeW5jb2Jqc19zX01BWExFTl9ORVREQVRBLGxlbmd0aE9mIChzdHIpcGxyLm5ldGRhdGEpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBkYXRhdG9zZW5kID0gKHN0cikgcGxyLm5ldGRhdGE7CiAgICAgICAgICAgICAgICBwbHIubmV0ZGF0YSA9ICIiOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAjIHBjbnQgaXMgcGVyY2VudGFnZSBvZiBsb2FkIGNvbXBsZXRlCiAgICAgICAgICAgIG51bSBwY250ID0gTWF0aC5mbG9vcigoIDEgLSAoKGxlbmd0aE9mIChzdHIpIHBsci5uZXRkYXRhKSAvICgobnVtKXBsci5uZXRkYXRhbGVuICogc3luY29ianNfc19NQVhMRU5fTkVUREFUQSkpKSoxMDApOwogICAgICAgICAgICAjIHN1Y2Nlc3MgPSBHQU1FLk5FVFdPUksuc2VuZCgic3luYyIsIHtkOmRhdGF0b3NlbmQsIGRlbGxpc3Q6c3luY29ianNfc19uZXdkZWxsaXN0LHBjbnQ6cGNudCxyc3Q6KGJvb2wpcGxyLm5ldHJlc2V0ID8gMTowfSwgKHN0cilwbHJzW2ldLmlkKTsgICAgCiAgICAgICAgICAgIHN1Y2Nlc3MgPSBHQU1FLk5FVFdPUksuc2VuZCgic3luYyIsIHtkOmRhdGF0b3NlbmQscGNudDpwY250LHJzdDooYm9vbClwbHIubmV0cmVzZXQgPyAxOjB9LCAoc3RyKXBscnNbaV0uaWQpOyAgICAKICAgICAgICAgICAgaWYgKCFzdWNjZXNzKSB7CiAgICAgICAgICAgICAgICBHQU1FLmxvZygiRVJST1I6IHN5bmMgbm90IHNlbnQhISEiKTsKICAgICAgICAgICAgICAgIEdBTUUubG9nKHtkOmRhdGF0b3NlbmQscGNudDpwY250LHJzdDooYm9vbClwbHIubmV0cmVzZXQgPyAxOjB9KTsKICAgICAgICAgICAgICAgICMgR0FNRS5sb2coe2Q6ZGF0YXRvc2VuZCwgZGVsbGlzdDpzeW5jb2Jqc19zX25ld2RlbGxpc3QscGNudDpwY250LHJzdDooYm9vbClwbHIubmV0cmVzZXQgPyAxOjB9KTsKICAgICAgICAgICAgfSAKICAgICAgICB9CgogICAgICAgICMgZmluZCBhbGwgb2JqZWN0cyB0aGF0IGFyZSBmdWxseSBkZWxldGVkIChzZW50IGRlbGV0ZSB0byBhbGwgcGxheWVycykKICAgICAgICBmb3IgKG51bSBpID0gbGVuZ3RoT2Ygc3luY29ianNfc19vYmpsaXN0IC0gMTsgaSA+PSAwOyBpLS0pCiAgICAgICAgewogICAgICAgICAgICBvYmogdE9iaiA9IHN5bmNvYmpzX3Nfb2JqbGlzdFtpXTsKICAgICAgICAgICAgaWYgKChzdHIpdE9iai5kZWwgIT0gInVuZGVmaW5lZCIgJiYgKGJvb2wpdE9iai5kZWwgPT0gdHJ1ZSl7CiAgICAgICAgICAgICAgICBpZiAobGVuZ3RoT2YgKHN0cltdKXRPYmouZGVscGxyaWRzID49IGxlbmd0aE9mIHBscnMpewogICAgICAgICAgICAgICAgICAgIHJlbW92ZSBzeW5jb2Jqc19zX29iamxpc3RbaV07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICMgaWYgKHN1Y2Nlc3MpIHsKICAgICAgICAjICAgICBzeW5jb2Jqc19zX25ld2RlbGxpc3QgPSBudW1bXTsKICAgICAgICAjIH0KICAgIH0KfQoKIyBSdW5zIHdoZW4gdGhlIHJvdW5kIGVuZHMKYWN0aW9uIHN5bmNvYmpzX3Nfb25HYW1lRW5kKCkgewogICAgc3luY29ianNfc19kZWxldGVBbGxPYmpzKCk7CiAgICAjIGRlbGV0ZSBhbGwgb2JqZWN0cyBjbGllbnQgc2lkZQogICAgR0FNRS5ORVRXT1JLLmJyb2FkY2FzdCgiY2xlYXIiLCB7fSk7Cn0KCmFjdGlvbiBzeW5jb2Jqc19zX29uTmV0d29ya01lc3NhZ2Uoc3RyIGlkLCBvYmogZGF0YSwgc3RyIHBsYXllcklEKSB7CiAgICBpZiAoaWQgPT0gInJlZnJlc2hvYmpzIil7CiAgICAgICAgb2JqIHBsciA9IEdBTUUuUExBWUVSUy5maW5kQnlJRChwbGF5ZXJJRCk7CiAgICAgICAgcGxyLm5ldHJlc2V0ID0gdHJ1ZTsKICAgIH0KfQojaW5jbHVkZSA8Zy5rcm5rPgojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIyBMaWJyYXJ5OiBsaWJzXEVDU1xjb21wb25lbnRzXG1vdmVtZW50XGZsb2F0aW5nXGZsb2F0aW5nLmtybmsKIyBBdXRob3I6IGJsYW5kcmljZQojICAgRGVzY3JpcHRpb246IGZsb2F0aW5nIHBsYXRmb3JtcyBjb21wb25lbnQKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpudW0gYWN0aW9uIGZsb2F0aW5nX2FwcGx5c2luKG9iaiB0b2JqLCBzdHIgZGltLCBudW0gdCkKewogICAgbnVtIG9mZnNldCA9IChudW0pdG9iai5mbG9hdGluZy5vZmZzZXQ7CiAgICBpZiAoZGltPT0ieCIpCiAgICB7CiAgICAgICAgcmV0dXJuIChudW0pdG9iai5mbG9hdGluZy5vZ3Bvcy54ICsgKChudW0pdG9iai5mbG9hdGluZy5hbXBsaXR1ZGUueCogTWF0aC5zaW4oKCgoTWF0aC5QSTIpKnQpIC8gKG51bSl0b2JqLmZsb2F0aW5nLnRfbXNpbnRlcnZhbCkrKE1hdGguUEkyKm9mZnNldCkpKTsKICAgIH0gCiAgICBlbHNlIGlmIChkaW09PSJ5IikKICAgIHsKICAgICAgICByZXR1cm4gKG51bSl0b2JqLmZsb2F0aW5nLm9ncG9zLnkgKyAoKG51bSl0b2JqLmZsb2F0aW5nLmFtcGxpdHVkZS55KiBNYXRoLnNpbigoKChNYXRoLlBJMikqdCkgLyAobnVtKXRvYmouZmxvYXRpbmcudF9tc2ludGVydmFsKSsoTWF0aC5QSTIqb2Zmc2V0KSkpOwogICAgfQogICAgZWxzZSBpZiAoZGltPT0ieiIpCiAgICB7CiAgICAgICAgcmV0dXJuIChudW0pdG9iai5mbG9hdGluZy5vZ3Bvcy56ICsgKChudW0pdG9iai5mbG9hdGluZy5hbXBsaXR1ZGUueiogTWF0aC5zaW4oKCgoTWF0aC5QSTIpKnQpIC8gKG51bSl0b2JqLmZsb2F0aW5nLnRfbXNpbnRlcnZhbCkrKE1hdGguUEkyKm9mZnNldCkpKTsKICAgIH0KICAgIHJldHVybiAwOwp9CgpudW0gYWN0aW9uIGZsb2F0aW5nX2FwcGx5Y29zKG9iaiB0b2JqLCBzdHIgZGltLCBudW0gdCkKewogICAgbnVtIG9mZnNldCA9IChudW0pdG9iai5mbG9hdGluZy5vZmZzZXQ7CiAgICBpZiAoZGltPT0ieCIpCiAgICB7CiAgICAgICAgcmV0dXJuIChudW0pdG9iai5mbG9hdGluZy5vZ3Bvcy54ICsgKChudW0pdG9iai5mbG9hdGluZy5hbXBsaXR1ZGUueCAqIChudW0pdG9iai5mbG9hdGluZy5jYyAqIE1hdGguY29zKCgoKE1hdGguUEkyKSp0KSAvIChudW0pdG9iai5mbG9hdGluZy50X21zaW50ZXJ2YWwpKyhNYXRoLlBJMipvZmZzZXQpKSk7CiAgICB9IAogICAgZWxzZSBpZiAoZGltPT0ieSIpCiAgICB7CiAgICAgICAgcmV0dXJuIChudW0pdG9iai5mbG9hdGluZy5vZ3Bvcy55ICsgKChudW0pdG9iai5mbG9hdGluZy5hbXBsaXR1ZGUueSAqIChudW0pdG9iai5mbG9hdGluZy5jYyAqIE1hdGguY29zKCgoKE1hdGguUEkyKSp0KSAvIChudW0pdG9iai5mbG9hdGluZy50X21zaW50ZXJ2YWwpKyhNYXRoLlBJMipvZmZzZXQpKSk7CiAgICB9CiAgICBlbHNlIGlmIChkaW09PSJ6IikKICAgIHsKICAgICAgICByZXR1cm4gKG51bSl0b2JqLmZsb2F0aW5nLm9ncG9zLnogKyAoKG51bSl0b2JqLmZsb2F0aW5nLmFtcGxpdHVkZS56ICogKG51bSl0b2JqLmZsb2F0aW5nLmNjICogTWF0aC5jb3MoKCgoTWF0aC5QSTIpKnQpIC8gKG51bSl0b2JqLmZsb2F0aW5nLnRfbXNpbnRlcnZhbCkrKE1hdGguUEkyKm9mZnNldCkpKTsKICAgIH0KICAgIHJldHVybiAwOwp9CgphY3Rpb24gZmxvYXRpbmdfb25FQ1NVcGRhdGUobnVtIGRlbHRhLCBvYmogdG9iaiwgb2JqW10gb2JqbGlzdCl7CmlmIChub3RFbXB0eSAob2JqKSB0b2JqLmZsb2F0aW5nKSAKICAgIHsKCiAgICAgICAgbnVtIHQgPSAoZ190bm93IC0gKG51bSl0b2JqLmZsb2F0aW5nLl90c3RhcnQpOwogICAgICAgIGlmICh0ID4gKG51bSl0b2JqLmZsb2F0aW5nLnRfbXNpbnRlcnZhbCkKICAgICAgICB7CiAgICAgICAgICAgIHRvYmouZmxvYXRpbmcuX3RzdGFydCA9IGdfdG5vdzsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKChudW0pdG9iai5mbG9hdGluZy5hbXBsaXR1ZGUueCAhPTApCiAgICAgICAgewogICAgICAgICAgICBpZiAoKHN0cil0b2JqLmZsb2F0aW5nLnR5cGUueD09InNpbmUiKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0b2JqLnBvc2l0aW9uLnggPSBmbG9hdGluZ19hcHBseXNpbih0b2JqLCJ4Iix0KTsKICAgICAgICAgICAgfSAKICAgICAgICAgICAgZWxzZSBpZiAoKHN0cil0b2JqLmZsb2F0aW5nLnR5cGUueD09ImNvcyIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRvYmoucG9zaXRpb24ueCA9IGZsb2F0aW5nX2FwcGx5Y29zKHRvYmosIngiLHQpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICgobnVtKXRvYmouZmxvYXRpbmcuYW1wbGl0dWRlLnkgIT0wKQogICAgICAgIHsKICAgICAgICAgICAgaWYgKChzdHIpdG9iai5mbG9hdGluZy50eXBlLnk9PSJzaW5lIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdG9iai5wb3NpdGlvbi55ID0gZmxvYXRpbmdfYXBwbHlzaW4odG9iaiwieSIsdCk7CiAgICAgICAgICAgIH0gCiAgICAgICAgICAgIGVsc2UgaWYgKChzdHIpdG9iai5mbG9hdGluZy50eXBlLnk9PSJjb3MiKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0b2JqLnBvc2l0aW9uLnkgPSBmbG9hdGluZ19hcHBseWNvcyh0b2JqLCJ5Iix0KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoKG51bSl0b2JqLmZsb2F0aW5nLmFtcGxpdHVkZS56ICE9MCkKICAgICAgICB7CiAgICAgICAgICAgIGlmICgoc3RyKXRvYmouZmxvYXRpbmcudHlwZS56PT0ic2luZSIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRvYmoucG9zaXRpb24ueiA9IGZsb2F0aW5nX2FwcGx5c2luKHRvYmosInoiLHQpOwogICAgICAgICAgICB9IAogICAgICAgICAgICBlbHNlIGlmICgoc3RyKXRvYmouZmxvYXRpbmcudHlwZS56PT0iY29zIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdG9iai5wb3NpdGlvbi56ID0gZmxvYXRpbmdfYXBwbHljb3ModG9iaiwieiIsdCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSAjIGRlZmF1bHQgaXMgbm8gbW92ZW1lbnQKICAgICAgICB7CiAgICAgICAgfQoKICAgIH0KfQojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIyBMaWJyYXJ5OiBsaWJzXEVDU1xib3VuY2VcZWNzZ3Jhdi5rcm5rCiMgQXV0aG9yOiBibGFuZHJpY2UKIyAgIERlc2NyaXB0aW9uOiBncmF2aXR5CiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKbnVtIGVjc2dyYXZfTUFYWVZFTCA9IDEwMDsKCm51bSBhY3Rpb24gZWNzZ3Jhdl9zaWduKG51bSBkKXsKICAgIHJldHVybiBkID49IDAgPyAxIDogLTE7Cn0KCmFjdGlvbiBlY3NncmF2X29uRUNTVXBkYXRlKG51bSBkZWx0YSwgb2JqIHRvYmosIG9ialtdIG9iamxpc3QpewppZiAobm90RW1wdHkgKG9iaikgdG9iai5ncmF2aXR5ICYmIChudW0pIHRvYmoub25Hcm91bmQgPT0gMCApIAogICAgewogICAgICAgIChudW0pIHRvYmoudmVsb2NpdHkueSArPSAobnVtKSB0b2JqLmdyYXZpdHkueSooZGVsdGEvMTAwMCk7CiAgICAgICAgaWYgKE1hdGguYWJzKChudW0pIHRvYmoudmVsb2NpdHkueSkgPiBlY3NncmF2X01BWFlWRUwpewogICAgICAgICAgICB0b2JqLnZlbG9jaXR5LnkgPSBlY3NncmF2X3NpZ24oKG51bSkgdG9iai52ZWxvY2l0eS55KSAqIGVjc2dyYXZfTUFYWVZFTDsKICAgICAgICB9CgogICAgfQp9CiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojIExpYnJhcnk6IGxpYnNcRUNTXGNvbXBvbmVudHNccGh5c2ljc1xlY3NwaHlzaWNzLmtybmsKIyBBdXRob3I6IGJsYW5kcmljZQojICAgRGVzY3JpcHRpb246IGNsYXNzaWMgcG9zaXRpb24vdmVsb2NpdHkvKGV2ZW50dWFsbHkgYWNjZWxlcmF0aW9uKQojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmFjdGlvbiBlY3NwaHlzaWNzX29uRUNTVXBkYXRlKG51bSBkZWx0YSwgb2JqIHRvYmosIG9ialtdIG9iamxpc3QpewogICAgdG9iai5vZ3ZlbCA9IAogICAgICAgIHsKICAgICAgICAgICAgeDogKG51bSkgdG9iai52ZWxvY2l0eS54LAogICAgICAgICAgICB5OiAobnVtKSB0b2JqLnZlbG9jaXR5LnksCiAgICAgICAgICAgIHo6IChudW0pIHRvYmoudmVsb2NpdHkuegogICAgICAgIH07CiAgICAjIGFjdHVhbGx5IGNoYW5nZSBwb3NpdGlvbgogICAgKG51bSkgdG9iai5wb3NpdGlvbi54ICs9IChudW0pdG9iai52ZWxvY2l0eS54ICogKGRlbHRhLzEwMDApOwogICAgKG51bSkgdG9iai5wb3NpdGlvbi55ICs9IChudW0pdG9iai52ZWxvY2l0eS55ICogKGRlbHRhLzEwMDApOwogICAgKG51bSkgdG9iai5wb3NpdGlvbi56ICs9IChudW0pdG9iai52ZWxvY2l0eS56ICogKGRlbHRhLzEwMDApOwp9CiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojIExpYnJhcnk6IFxsaWJzXEVDU1xlY3NfaC5rcm5rCiMgQXV0aG9yOiBibGFuZHJpY2UKIyAgIERlc2NyaXB0aW9uOiBFbnRpdHkhIENvbXBvbmVudCEhIFN5c3RlbSEhIQojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmFjdGlvbiBlY3NfaF9vbkNvbGxpZGVXb3JsZChvYmogdG9iaiwgb2JqW10gY29sbGlzdCl7Cgp9CgphY3Rpb24gZWNzX2hfb25FQ1NVcGRhdGUobnVtIGRlbHRhLCBvYmogdG9iaiwgb2JqW10gb2JqbGlzdCl7Cn0KCmFjdGlvbiBlY3NfaF9vbkNvbGxpZGUob2JqIHRvYmosIG9ialtdIG9iamxpc3QpewoKfQoKYWN0aW9uIGVjc19oX29uQ29sbGlkZVBscnMob2JqIHRvYmosIG9ialtdIHBscnMpewoKfQoKCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojIExpYnJhcnk6IGxpYnNcRUNTXGVudGl0aWVzXHBsYXRmb3JtXHBsYXRmb3JtLmtybmsKIyBBdXRob3I6IGJsYW5kcmljZQojICAgRGVzY3JpcHRpb246IGZpcnN0IHRyeSBjcmVhdGluZyBwbGF0Zm9ybQojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCgojIGRlZmF1bHQgcGxhdGZvcm0gd2lsbDoKIyAxLiBzaGFrZSBhbmQgZmFsbCBvbiBzdGVwcGluZyAzIHRpbWVzCmFjdGlvbiBwbGF0Zm9ybV9jcmVhdGUob2JqIHByb3BzKXsKICAgIG9iaiBuZXdPYmogPSB7CiAgICAgICAgYWlkOiAxMTY3NiwKICAgICAgICBzY2FsZTp7eDoxMCx5OjEwLHo6MTB9LAogICAgICAgIHBvc2l0aW9uOnt4OjAseToyMix6OjB9LAogICAgICAgIHZlbG9jaXR5Ont4OjAseTowLHo6MH0sCiAgICAgICAgc2NhbGU6e3g6NTAseToxMCx6OjUwfSwKICAgICAgICBjb2xvcjoweEZGRkZGRiwKICAgICAgICBlbWlzc2l2ZToweDAwMDAwMCwKICAgICAgICBvbkdyb3VuZDpmYWxzZSwKICAgICAgICBjb2xsaWRlOnt0eXBlOkFBQkJfQ09MX1BMUlN8QUFCQl9DT0xfT0JKMlBMUlN9LAogICAgICAgICMgcGxhdGNydW1ibGVzOntjcnVtYmxlY250OjMsaW50X2NydW1ibGU6NTAwLF90bGFzdGNydW1ibGU6MCxsaWZldGltZToxMDAwfSwKICAgICAgICAjIHNoYWtlOnt4OjAseTowLHo6MCxlbjowLGludGVuc2l0eTp7eDoxLHk6MCx6OjF9LGR1cmF0aW9uOjQwMH0KICAgIH07CiAgICBpZiAoKHN0cilwcm9wcy5zaGFrZSAhPSAidW5kZWZpbmVkIikKICAgIHsKICAgICAgICBuZXdPYmouc2hha2UgPSB7eDowLHk6MCx6OjAsZW46MCxpbnRlbnNpdHk6e3g6MSx5OjAsejoxfSxkdXJhdGlvbjo0MDB9OwogICAgfQogICAgaWYgKChzdHIpcHJvcHMuY3J1bWJsZSAhPSAidW5kZWZpbmVkIikKICAgIHsKICAgICAgICBuZXdPYmoucGxhdGNydW1ibGVzPQogICAgICAgICAgICB7ICAgCiAgICAgICAgICAgICAgICBjcnVtYmxlY250OihudW0pcHJvcHMuY3J1bWJsZS5jcnVtYmxlY250LAogICAgICAgICAgICAgICAgaW50X2NydW1ibGU6KG51bSlwcm9wcy5jcnVtYmxlLmludF9jcnVtYmxlLAogICAgICAgICAgICAgICAgbGlmZXRpbWU6KG51bSlwcm9wcy5jcnVtYmxlLmxpZmV0aW1lLAogICAgICAgICAgICAgICAgX3RsYXN0Y3J1bWJsZTowCiAgICAgICAgICAgIH07CiAgICB9CiAgICBpZiAoKHN0cilwcm9wcy5mbG9hdGluZyAhPSAidW5kZWZpbmVkIikKICAgIHsKICAgICAgICBuZXdPYmouZmxvYXRpbmc9CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG9ncG9zOnt4OihudW0pcHJvcHMuZmxvYXRpbmcub2dwb3MueCx5OihudW0pcHJvcHMuZmxvYXRpbmcub2dwb3MueSx6OihudW0pcHJvcHMuZmxvYXRpbmcub2dwb3Muen0sCiAgICAgICAgICAgICAgICBhbXBsaXR1ZGU6IHt4OihudW0pcHJvcHMuZmxvYXRpbmcuYW1wbGl0dWRlLngseToobnVtKXByb3BzLmZsb2F0aW5nLmFtcGxpdHVkZS55LHo6KG51bSlwcm9wcy5mbG9hdGluZy5hbXBsaXR1ZGUuen0sCiAgICAgICAgICAgICAgICB0X21zaW50ZXJ2YWw6IChudW0pcHJvcHMuZmxvYXRpbmcudF9tc2ludGVydmFsLAogICAgICAgICAgICAgICAgdHlwZToge3g6KHN0cilwcm9wcy5mbG9hdGluZy50eXBlLngseTooc3RyKXByb3BzLmZsb2F0aW5nLnR5cGUueSx6OihzdHIpcHJvcHMuZmxvYXRpbmcudHlwZS56fSwKICAgICAgICAgICAgICAgIG9mZnNldDogKChzdHIpcHJvcHMuZmxvYXRpbmcub2Zmc2V0ICE9ICJ1bmRlZmluZWQiKSA/IChudW0pIHByb3BzLmZsb2F0aW5nLm9mZnNldDogMCwKICAgICAgICAgICAgICAgIGNjOiAoKHN0cilwcm9wcy5mbG9hdGluZy5jYyAhPSAidW5kZWZpbmVkIikgPyAtMTogMSwKICAgICAgICAgICAgICAgIF90c3RhcnQ6IGdfdG5vdywKICAgICAgICAgICAgfTsKICAgIH0KICAgIGlmIChub3RFbXB0eSAob2JqKXByb3BzLnBvc2l0aW9uKXsKICAgICAgICBuZXdPYmoucG9zaXRpb24ueCA9IChudW0pcHJvcHMucG9zaXRpb24ueDsKICAgICAgICBuZXdPYmoucG9zaXRpb24ueSA9IChudW0pcHJvcHMucG9zaXRpb24ueTsKICAgICAgICBuZXdPYmoucG9zaXRpb24ueiA9IChudW0pcHJvcHMucG9zaXRpb24uejsKICAgIH0KICAgIGlmIChub3RFbXB0eSAob2JqKXByb3BzLnNjYWxlKXsKICAgICAgICBuZXdPYmouc2NhbGUueCA9IChudW0pcHJvcHMuc2NhbGUueDsKICAgICAgICBuZXdPYmouc2NhbGUueSA9IChudW0pcHJvcHMuc2NhbGUueTsKICAgICAgICBuZXdPYmouc2NhbGUueiA9IChudW0pcHJvcHMuc2NhbGUuejsKICAgIH0KICAgIGlmICgoc3RyKXByb3BzLmNvbG9yICE9ICJ1bmRlZmluZWQiKXsKICAgICAgICBuZXdPYmouY29sb3IgPSAobnVtKSBwcm9wcy5jb2xvcjsKICAgIH0KICAgIGlmICgoc3RyKXByb3BzLmNvbG9yICE9ICJ1bmRlZmluZWQiKXsKICAgICAgICBuZXdPYmouYWlkID0gKG51bSkgcHJvcHMuYWlkOwogICAgfQogICAgc3luY29ianNfc19jcmVhdGVPYmplY3QobmV3T2JqKTsKICAgICMgZ3Jhdml0eTp7eDowLHk6LTEwMCx6OjB9Cn0KCm51bSBbXSBwbGF0Zm9ybV9jb2xvcmNydW1ibGUgPSBudW1bMHhGRjAwMDAsMHhGRkZGMDAsMHgwMEZGMDBdOwphY3Rpb24gcGxhdGZvcm1fb25Db2xsaWRlUGxycyhvYmogdG9iaiwgb2JqW10gcGxycyl7CiAgICBpZiAobm90RW1wdHkgKG9iaikgdG9iai5wbGF0Y3J1bWJsZXMpewogICAgICAgIGlmICgoZ190bm93IC0gKG51bSl0b2JqLnBsYXRjcnVtYmxlcy5fdGxhc3RjcnVtYmxlKSA+IChudW0pdG9iai5wbGF0Y3J1bWJsZXMuaW50X2NydW1ibGUpewogICAgICAgICAgICBpZiAoKG51bSl0b2JqLnBsYXRjcnVtYmxlcy5jcnVtYmxlY250ID4gMCl7CiAgICAgICAgICAgICAgICAobnVtKXRvYmoucGxhdGNydW1ibGVzLmNydW1ibGVjbnQtLTsKICAgICAgICAgICAgICAgIHRvYmouZW1pc3NpdmUgPSBwbGF0Zm9ybV9jb2xvcmNydW1ibGVbKChudW0pdG9iai5wbGF0Y3J1bWJsZXMuY3J1bWJsZWNudCAlIDMpXTsKICAgICAgICAgICAgICAgIHRvYmouc2hha2UuZW4gPSAxOwogICAgICAgICAgICAgICAgdG9iai5wbGF0Y3J1bWJsZXMuX3RsYXN0Y3J1bWJsZSA9IGdfdG5vdzsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoKG51bSl0b2JqLnBsYXRjcnVtYmxlcy5jcnVtYmxlY250ID09IDAgJiYgIW5vdEVtcHR5IChvYmopIHRvYmouZ3Jhdml0eSl7CiAgICAgICAgICAgICAgICB0b2JqLmdyYXZpdHkgPSB7eDowLHk6LTEwMCx6OjB9OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgphY3Rpb24gcGxhdGZvcm1fb25FQ1NVcGRhdGUobnVtIGRlbHRhLCBvYmogdG9iaiwgb2JqW10gb2JqbGlzdCl7CiAgICBpZiAobm90RW1wdHkgKG9iaikgdG9iai5wbGF0Y3J1bWJsZXMpewogICAgICAgIGlmICgobnVtKXRvYmoucGxhdGNydW1ibGVzLmNydW1ibGVjbnQgPT0gMCAmJiAoZ190bm93IC0gKG51bSl0b2JqLnBsYXRjcnVtYmxlcy5fdGxhc3RjcnVtYmxlKSA+IChudW0pdG9iai5wbGF0Y3J1bWJsZXMubGlmZXRpbWUpewogICAgICAgICAgICBzeW5jb2Jqc19zX2RlbGV0ZU9iamVjdCgoc3RyKXRvYmoub2JqaWQpOwogICAgICAgICAgICAKICAgICAgICB9CiAgICB9Cn0KI2luY2x1ZGUgPHN5bmNvYmpzX3Mua3Juaz4KI2luY2x1ZGUgPEFBQkIua3Juaz4KI2luY2x1ZGUgPGVjc19oLmtybms+CgoKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMgcHJpdmF0ZSBhY3Rpb25zIGJ5IGJsYW5kcmljZQojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIGFjdGlvbiBvbkVDU1VwZGF0ZSAobnVtIGRlbHRhLCBvYmogdG9iaiwgb2JqW10gb2JqbGlzdCl7CiAgICBzaGFrZV9zX29uRUNTVXBkYXRlKGRlbHRhLCAgdG9iaiwgIG9iamxpc3QpOwogICAgZmxvYXRpbmdfb25FQ1NVcGRhdGUoZGVsdGEsICB0b2JqLCAgb2JqbGlzdCk7CiAgICBlY3NncmF2X29uRUNTVXBkYXRlKGRlbHRhLCAgdG9iaiwgIG9iamxpc3QpOwogICAgZWNzcGh5c2ljc19vbkVDU1VwZGF0ZShkZWx0YSwgIHRvYmosICBvYmpsaXN0KTsKICAgIGVjc19oX29uRUNTVXBkYXRlKGRlbHRhLCAgdG9iaiwgIG9iamxpc3QpOwogICAgcGxhdGZvcm1fb25FQ1NVcGRhdGUoZGVsdGEsICB0b2JqLCAgb2JqbGlzdCk7Cn0KCiBhY3Rpb24gb25Db2xsaWRlIChvYmogdG9iaiwgb2JqW10gb2JqbGlzdCl7CiAgICBlY3NfaF9vbkNvbGxpZGUodG9iaiwgIG9iamxpc3QpOwp9CgogYWN0aW9uIG9uQ29sbGlkZVdvcmxkIChvYmogdG9iaiwgb2JqW10gY29sbGlzdCl7CiAgICBlY3NfaF9vbkNvbGxpZGVXb3JsZCh0b2JqLCAgY29sbGlzdCk7Cn0KCiBhY3Rpb24gb25Db2xsaWRlUGxycyAob2JqIHRvYmosIG9ialtdIHBscnMpewogICAgZWNzX2hfb25Db2xsaWRlUGxycyh0b2JqLCAgcGxycyk7CiAgICBwbGF0Zm9ybV9vbkNvbGxpZGVQbHJzKHRvYmosICBwbHJzKTsKfQoKCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojIExpYnJhcnk6IFxsaWJzXEVDU1xlY3Nfcy5rcm5rCiMgQXV0aG9yOiBibGFuZHJpY2UKIyAgIERlc2NyaXB0aW9uOiBFbnRpdHkhIENvbXBvbmVudCEhIFN5c3RlbSEhIQojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCiMgRW50aXRpZXM6IG9iaiBsaXN0CiMgQ29tcG9uZW50czogc2VwYXJhdGUgImNvbXBvbmVudHMiIGxpYnJhcmllcwojIFN5c3RlbXM6IHB1YmxpYyArIHByaXZhdGUgYWN0aW9uIGhvb2tzIQoKCgphY3Rpb24gZWNzX3NfdXBkYXRlKG51bSBkZWx0YSl7CgogICAgb2JqW10gd29ybGQgPSBHQU1FLk9CSkVDVFMubGlzdCgpOwogICAgb2JqW10gd29ybGRlZGl0ID0gb2JqW107ICMgZWRpdHMgdG8gbWFrZSAKCiAgICAjIHNpbXBsZXIgd29ybGQgcG9zaXRpb24gYW5kIHNjYWxlIHN5c3RlbQogICAgZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiB3b3JsZDsgaSsrKXsKICAgICAgICAgICAgb2JqIHdjdWJlID0gewogICAgICAgICAgICAgICAgcG9zaXRpb246ewogICAgICAgICAgICAgICAgICAgIHg6KG51bSl3b3JsZFtpXS5wb3NpdGlvbi54LAogICAgICAgICAgICAgICAgICAgIHk6KG51bSl3b3JsZFtpXS5wb3NpdGlvbi55IC0gKG51bSl3b3JsZFtpXS5zY2FsZS55LAogICAgICAgICAgICAgICAgICAgIHo6KG51bSl3b3JsZFtpXS5wb3NpdGlvbi56CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgc2NhbGU6IHsKICAgICAgICAgICAgICAgICAgICB4OihudW0pd29ybGRbaV0uc2NhbGUueCoyLAogICAgICAgICAgICAgICAgICAgIHk6KG51bSl3b3JsZFtpXS5zY2FsZS55KjIsCiAgICAgICAgICAgICAgICAgICAgejoobnVtKXdvcmxkW2ldLnNjYWxlLnoqMgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgIGFkZFRvIHdvcmxkZWRpdCB3Y3ViZTsKICAgIH0KCiAgICAjIGxvb3AgdGhyb3VnaCBvYmplY3QgbGlzdAogICAgZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBzeW5jb2Jqc19zX29iamxpc3Q7IGkrKykKICAgIHsKICAgICAgICBvYmogdG9iaiA9IHN5bmNvYmpzX3Nfb2JqbGlzdFtpXTsKICAgICAgICAKICAgICAgICAjIENVU1RPTSBBQ1RJT04gVEhBVCBCVU5ETEVTIEFMTCBVUERBVEUgRVZFTlRTCiAgICAgICAgb25FQ1NVcGRhdGUoZGVsdGEsIHRvYmosIHN5bmNvYmpzX3Nfb2JqbGlzdCk7CiAgICAgICAgCiAgICAgICAgaWYgKG5vdEVtcHR5IChvYmopIHRvYmouY29sbGlkZSkKICAgICAgICB7CiAgICAgICAgICAgIG51bSBjb2x0eXBlID0gKG51bSkgdG9iai5jb2xsaWRlLnR5cGU7CiAgICAgICAgICAgIGlmICgoY29sdHlwZSAmIEFBQkJfQ09MX1dPUkxEKSA+IDApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICMgcmVzb2x2ZSBjb2xsaXNpb24uIGN1cnJlbnRseSBkZWZhdWx0IHdpbGwgc3RvcCBvYmplY3QgKHZlbCA9IDApCiAgICAgICAgICAgICAgICBvYmpbXSByZXMgPSBBQUJCX3Jlc29sdmUodG9iaix3b3JsZGVkaXQpOwogICAgICAgICAgICAgICAgIyBDVVNUT00gQUNUSU9OIFRIQVQgQlVORExFUyBBTEwgQ09MTElTSU9OIEVWRU5UUwogICAgICAgICAgICAgICAgb25Db2xsaWRlV29ybGQodG9iaixyZXMpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgoY29sdHlwZSAmIEFBQkJfQ09MX1BMUlMpID4gMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIyByZXNvbHZlIGNvbGxpc2lvbi4gY3VycmVudGx5IGRldGVjdHMgZmFjZSBidXQgZG9lcyBOT1Qgc3RvcAogICAgICAgICAgICAgICAgb2JqW10gcGxycyA9IEdBTUUuUExBWUVSUy5saXN0KCk7CiAgICAgICAgICAgICAgICBvYmpbXSByZXMgPSBBQUJCX2RldGVjdCh0b2JqLHBscnMpOwogICAgICAgICAgICAgICAgaWYgKGxlbmd0aE9mIHJlcyA+IDApewogICAgICAgICAgICAgICAgICAgIG9uQ29sbGlkZVBscnModG9iaixyZXMpOyAgICAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgCgogICAgICAgIAoKICAgICAgICBpZiAoKHN0cikgdG9iai5kZWJ1ZyA9PSAiMSIpewogICAgICAgICAgICBHQU1FLmxvZyh0b2JqKTsKICAgICAgICB9CiAgICB9IAoKCn0KCmFjdGlvbiBlY3Nfc19vbk5ldHdvcmtNZXNzYWdlKHN0ciBpZCwgb2JqIGRhdGEsIHN0ciBwbGF5ZXJJRCkgewoKfQoKIyBwcml2YXRlIGFjdGlvbiBvbkNvbGxpZGUob2JqIHRvYmosIG9ialtdIG9iamxpc3QpewojIH0KCiMgcHJpdmF0ZSBhY3Rpb24gb25FQ1NVcGRhdGUobnVtIGRlbHRhLCBvYmogdG9iaiwgb2JqW10gb2JqbGlzdCl7CiMgfQoKIyBwcml2YXRlIGFjdGlvbiBvblBsYXllckNvbGxpc2lvbigpez8/PwojICAgICBvYmpbXSBwbHJzID0gR0FNRS5QTEFZRVJTLmxpc3QoKTsKIyAgICAgZm9yIChudW0gaSA9IDA7IGkgPCBsZW5ndGhPZiBwbHJzOyBpKyspewojICAgICB9CiMgfQoKIyBwcml2YXRlIGFjdGlvbiBvbkNvbGxpZGVXb3JsZChvYmogdG9iaiwgb2JqW10gY29sbGlzdCl7fQoKIyBkaW1lbnNpb25zIG9mIHBsYXRmb3JtcwpudW0gV0lEVEggPSAzMDsKbnVtIEhFSUdIVCA9IDU7Cm51bSBTRVAgPSAxMDsKbnVtIGNyZWF0ZWQgPSAwOwoKIyBhZXN0aGV0aWMgcHJvcGVydGllcwpudW0gUExBVENPTE9SID0gMHhBQUFBQUE7CiMgbnVtIFBMQVRBSUQgPSAxMTY3NjsgIyBicmljayB0ZXh0dXJlCm51bSBQTEFUQUlEID0gMzQzNzk7ICMgZGVmYXVsdCBubyB0ZXh0dXJlLCB3aGl0ZQoKIyBwbGF0Zm9ybSByYW5nZS9zcGVlZCAKbnVtIFJBTkdFID0gNDA7ICMgNDAgdW5pdHMsIDgwIHVuaXRzIHRvdGFsCm51bSBQRVJJT0QgPSA1MDAwOyAjIDUgc2Vjb25kcwoKIyBub2RlZSBJRCByYW5nZXMgZm9yIGJhY2sgYW5kIGZvcnRoIGxpbmVhciBwbGF0Zm9ybXMKbnVtIE5fWF9MSU5fUExBVFNUQVJUICAgICAgICA9ICAwOwpudW0gTl9YX0xJTl9QTEFURU5EICAgICAgICAgID0gNTA7CgpudW0gTl9YX0xJTl8wXzVfUExBVFNUQVJUICAgID0gIDUxOwpudW0gTl9YX0xJTl8wXzVfUExBVEVORCAgICAgID0gMTAwOwoKbnVtIE5fWV9MSU5fUExBVFNUQVJUICAgICAgICA9IDEwMTsKbnVtIE5fWV9MSU5fUExBVEVORCAgICAgICAgICA9IDE1MDsKCm51bSBOX1lfTElOXzBfNV9QTEFUU1RBUlQgICAgPSAxNTE7Cm51bSBOX1lfTElOXzBfNV9QTEFURU5EICAgICAgPSAyMDA7CgpudW0gTl9aX0xJTl9QTEFUU1RBUlQgICAgICAgID0gMjAxOwpudW0gTl9aX0xJTl9QTEFURU5EICAgICAgICAgID0gMjUwOwoKbnVtIE5fWl9MSU5fMF81X1BMQVRTVEFSVCAgICA9IDI1MTsKbnVtIE5fWl9MSU5fMF81X1BMQVRFTkQgICAgICA9IDMwMDsKCm51bSBOX1ZFUlRfQ0lSQ0xFWF9QTEFUU1RBUlQgPSAzMDE7Cm51bSBOX1ZFUlRfQ0lSQ0xFWF9QTEFURU5EICAgPSAzNTA7CgpudW0gTl9WRVJUX0NJUkNMRVhfMF81X1BMQVRTVEFSVCA9IDM1MTsKbnVtIE5fVkVSVF9DSVJDTEVYXzBfNV9QTEFURU5EICAgPSA0MDA7CgojIDcwMS04MDAKbnVtIE5fVkVSVF9DSVJDTEVYX0NDX1BMQVRTVEFSVCA9IDcwMTsKbnVtIE5fVkVSVF9DSVJDTEVYX0NDX1BMQVRFTkQgICA9IDc1MDsKCm51bSBOX1ZFUlRfQ0lSQ0xFWF9DQ18wXzVfUExBVFNUQVJUID0gNzUxOwpudW0gTl9WRVJUX0NJUkNMRVhfQ0NfMF81X1BMQVRFTkQgICA9IDgwMDsKIyA3MDEtODAwCgpudW0gTl9WRVJUX0NJUkNMRVpfUExBVFNUQVJUID0gNDAxOwpudW0gTl9WRVJUX0NJUkNMRVpfUExBVEVORCAgID0gNDUwOwoKbnVtIE5fVkVSVF9DSVJDTEVaXzBfNV9QTEFUU1RBUlQgPSA0NTE7Cm51bSBOX1ZFUlRfQ0lSQ0xFWl8wXzVfUExBVEVORCAgID0gNTAwOwoKIyA4MDEtOTAwCm51bSBOX1ZFUlRfQ0lSQ0xFWl9DQ19QTEFUU1RBUlQgPSA4MDE7Cm51bSBOX1ZFUlRfQ0lSQ0xFWl9DQ19QTEFURU5EICAgPSA4NTA7CgpudW0gTl9WRVJUX0NJUkNMRVpfQ0NfMF81X1BMQVRTVEFSVCA9IDg1MTsKbnVtIE5fVkVSVF9DSVJDTEVaX0NDXzBfNV9QTEFURU5EICAgPSA5MDA7CiMgODAxLTkwMAoKCm51bSBOX0hPUl9DSVJDTEVfUExBVFNUQVJUICAgPSA1MDE7Cm51bSBOX0hPUl9DSVJDTEVfUExBVEVORCAgICAgPSA1NTA7CgpudW0gTl9IT1JfQ0lSQ0xFXzBfNV9QTEFUU1RBUlQgICA9IDU1MTsKbnVtIE5fSE9SX0NJUkNMRV8wXzVfUExBVEVORCAgICAgPSA2MDA7CgpudW0gTl9IT1JfQ0lSQ0xFX0NDX1BMQVRTVEFSVCAgID0gNjAxOwpudW0gTl9IT1JfQ0lSQ0xFX0NDX1BMQVRFTkQgICAgID0gNjUwOwoKbnVtIE5fSE9SX0NJUkNMRV8wXzVfQ0NfUExBVFNUQVJUICAgPSA2NTE7Cm51bSBOX0hPUl9DSVJDTEVfMF81X0NDX1BMQVRFTkQgICAgID0gNzAwOwoKcHVibGljIGFjdGlvbiB1cGRhdGUobnVtIGRlbHRhKXsKICAgIGdfdXBkYXRlKGRlbHRhKTsKICAgIHBscmJodnJfc191cGRhdGUoZGVsdGEpOwogICAgc3luY29ianNfc191cGRhdGUoZGVsdGEpOwogICAgZWNzX3NfdXBkYXRlKGRlbHRhKTsKCiAgICBpZiAobGVuZ3RoT2YgcGxydXRpbF9zX3NwYXduZWRQbGF5ZXJzID4gMCkgewogICAgICAgIGlmIChjcmVhdGVkID09IDApewoKICAgICAgICAgICAgb2JqW10gbm9kZXMgPSBHQU1FLk9CSkVDVFMuZ2V0UGF0aE5vZGVzKCk7CgogICAgICAgICAgICBmb3IgKG51bSBpID0gMDsgaSA8IGxlbmd0aE9mIG5vZGVzOyBpKyspIHsKICAgICAgICAgICAgICAgIG9iaiBpbm9kZSA9IG5vZGVzW2ldOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiAoKChudW0paW5vZGUuaWQgPj0gTl9YX0xJTl9QTEFUU1RBUlQpICYmICgobnVtKWlub2RlLmlkIDw9IE5fWF9MSU5fUExBVEVORCkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcGxhdGZvcm1fY3JlYXRlKAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogUExBVENPTE9SLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlkOiBQTEFUQUlELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU6e3g6V0lEVEgseTpIRUlHSFQsejpXSURUSH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjp7eDoobnVtKWlub2RlLngseToobnVtKWlub2RlLnksejoobnVtKWlub2RlLnp9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXRpbmc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2dwb3M6e3g6KG51bSlpbm9kZS54LHk6KG51bSlpbm9kZS55LHo6KG51bSlpbm9kZS56fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbXBsaXR1ZGU6e3g6UkFOR0UseTowLHo6MH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdF9tc2ludGVydmFsOlBFUklPRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOnt4OiJzaW5lIix5OiIiLHo6IiJ9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgIGVsc2UgaWYgKCgobnVtKWlub2RlLmlkID49IE5fWF9MSU5fMF81X1BMQVRTVEFSVCkgJiYgKChudW0paW5vZGUuaWQgPD0gTl9YX0xJTl8wXzVfUExBVEVORCkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcGxhdGZvcm1fY3JlYXRlKAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogUExBVENPTE9SLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlkOiBQTEFUQUlELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU6e3g6V0lEVEgseTpIRUlHSFQsejpXSURUSH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjp7eDoobnVtKWlub2RlLngseToobnVtKWlub2RlLnksejoobnVtKWlub2RlLnp9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXRpbmc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2dwb3M6e3g6KG51bSlpbm9kZS54LHk6KG51bSlpbm9kZS55LHo6KG51bSlpbm9kZS56fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbXBsaXR1ZGU6e3g6UkFOR0UseTowLHo6MH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdF9tc2ludGVydmFsOlBFUklPRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6MC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6e3g6InNpbmUiLHk6IiIsejoiIn0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmICgoKG51bSlpbm9kZS5pZCA+PSBOX1lfTElOX1BMQVRTVEFSVCkgJiYgKChudW0paW5vZGUuaWQgPD0gTl9ZX0xJTl9QTEFURU5EKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwbGF0Zm9ybV9jcmVhdGUoCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBQTEFUQ09MT1IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhaWQ6IFBMQVRBSUQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZTp7eDpXSURUSCx5OkhFSUdIVCx6OldJRFRIfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOnt4OihudW0paW5vZGUueCx5OihudW0paW5vZGUueSx6OihudW0paW5vZGUuen0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbG9hdGluZzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZ3Bvczp7eDoobnVtKWlub2RlLngseToobnVtKWlub2RlLnksejoobnVtKWlub2RlLnp9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtcGxpdHVkZTp7eDowLHk6UkFOR0UsejowfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0X21zaW50ZXJ2YWw6UEVSSU9ELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6e3g6IiIseToic2luZSIsejoiIn0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmICgoKG51bSlpbm9kZS5pZCA+PSBOX1lfTElOXzBfNV9QTEFUU1RBUlQpICYmICgobnVtKWlub2RlLmlkIDw9IE5fWV9MSU5fMF81X1BMQVRFTkQpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHBsYXRmb3JtX2NyZWF0ZSgKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFBMQVRDT0xPUiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFpZDogUExBVEFJRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlOnt4OldJRFRILHk6SEVJR0hULHo6V0lEVEh9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246e3g6KG51bSlpbm9kZS54LHk6KG51bSlpbm9kZS55LHo6KG51bSlpbm9kZS56fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsb2F0aW5nOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ncG9zOnt4OihudW0paW5vZGUueCx5OihudW0paW5vZGUueSx6OihudW0paW5vZGUuen0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1wbGl0dWRlOnt4OjAseTpSQU5HRSx6OjB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRfbXNpbnRlcnZhbDpQRVJJT0QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OjAuNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOnt4OiIiLHk6InNpbmUiLHo6IiJ9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAoKChudW0paW5vZGUuaWQgPj0gTl9aX0xJTl9QTEFUU1RBUlQpICYmICgobnVtKWlub2RlLmlkIDw9IE5fWl9MSU5fUExBVEVORCkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcGxhdGZvcm1fY3JlYXRlKAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogUExBVENPTE9SLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlkOiBQTEFUQUlELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU6e3g6V0lEVEgseTpIRUlHSFQsejpXSURUSH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjp7eDoobnVtKWlub2RlLngseToobnVtKWlub2RlLnksejoobnVtKWlub2RlLnp9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXRpbmc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2dwb3M6e3g6KG51bSlpbm9kZS54LHk6KG51bSlpbm9kZS55LHo6KG51bSlpbm9kZS56fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbXBsaXR1ZGU6e3g6MCx5OjAsejpSQU5HRX0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdF9tc2ludGVydmFsOlBFUklPRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOnt4OiIiLHk6IiIsejoic2luZSJ9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAoKChudW0paW5vZGUuaWQgPj0gTl9aX0xJTl8wXzVfUExBVFNUQVJUKSAmJiAoKG51bSlpbm9kZS5pZCA8PSBOX1pfTElOXzBfNV9QTEFURU5EKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwbGF0Zm9ybV9jcmVhdGUoCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBQTEFUQ09MT1IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhaWQ6IFBMQVRBSUQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZTp7eDpXSURUSCx5OkhFSUdIVCx6OldJRFRIfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOnt4OihudW0paW5vZGUueCx5OihudW0paW5vZGUueSx6OihudW0paW5vZGUuen0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbG9hdGluZzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZ3Bvczp7eDoobnVtKWlub2RlLngseToobnVtKWlub2RlLnksejoobnVtKWlub2RlLnp9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtcGxpdHVkZTp7eDowLHk6MCx6OlJBTkdFfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0X21zaW50ZXJ2YWw6UEVSSU9ELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDowLjUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTp7eDoiIix5OiIiLHo6InNpbmUifQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKCgobnVtKWlub2RlLmlkID49IE5fVkVSVF9DSVJDTEVYX1BMQVRTVEFSVCkgJiYgKChudW0paW5vZGUuaWQgPD0gTl9WRVJUX0NJUkNMRVhfUExBVEVORCkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcGxhdGZvcm1fY3JlYXRlKAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogUExBVENPTE9SLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlkOiBQTEFUQUlELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU6e3g6V0lEVEgseTpIRUlHSFQsejpXSURUSH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjp7eDoobnVtKWlub2RlLngseToobnVtKWlub2RlLnksejoobnVtKWlub2RlLnp9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXRpbmc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2dwb3M6e3g6KG51bSlpbm9kZS54LHk6KG51bSlpbm9kZS55LHo6KG51bSlpbm9kZS56fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbXBsaXR1ZGU6e3g6UkFOR0UseTpSQU5HRSx6OjB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRfbXNpbnRlcnZhbDpQRVJJT0QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTp7eDoiY29zIix5OiJzaW5lIix6OiIifQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKCgobnVtKWlub2RlLmlkID49IE5fVkVSVF9DSVJDTEVYXzBfNV9QTEFUU1RBUlQpICYmICgobnVtKWlub2RlLmlkIDw9IE5fVkVSVF9DSVJDTEVYXzBfNV9QTEFURU5EKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwbGF0Zm9ybV9jcmVhdGUoCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBQTEFUQ09MT1IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhaWQ6IFBMQVRBSUQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZTp7eDpXSURUSCx5OkhFSUdIVCx6OldJRFRIfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOnt4OihudW0paW5vZGUueCx5OihudW0paW5vZGUueSx6OihudW0paW5vZGUuen0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbG9hdGluZzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZ3Bvczp7eDoobnVtKWlub2RlLngseToobnVtKWlub2RlLnksejoobnVtKWlub2RlLnp9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtcGxpdHVkZTp7eDpSQU5HRSx5OlJBTkdFLHo6MH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdF9tc2ludGVydmFsOlBFUklPRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6MC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6e3g6ImNvcyIseToic2luZSIsejoiIn0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmICgoKG51bSlpbm9kZS5pZCA+PSBOX1ZFUlRfQ0lSQ0xFWF9DQ19QTEFUU1RBUlQpICYmICgobnVtKWlub2RlLmlkIDw9IE5fVkVSVF9DSVJDTEVYX0NDX1BMQVRFTkQpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHBsYXRmb3JtX2NyZWF0ZSgKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFBMQVRDT0xPUiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFpZDogUExBVEFJRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlOnt4OldJRFRILHk6SEVJR0hULHo6V0lEVEh9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246e3g6KG51bSlpbm9kZS54LHk6KG51bSlpbm9kZS55LHo6KG51bSlpbm9kZS56fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsb2F0aW5nOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ncG9zOnt4OihudW0paW5vZGUueCx5OihudW0paW5vZGUueSx6OihudW0paW5vZGUuen0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1wbGl0dWRlOnt4OlJBTkdFLHk6UkFOR0UsejowfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0X21zaW50ZXJ2YWw6UEVSSU9ELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjOi0xLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6e3g6ImNvcyIseToic2luZSIsejoiIn0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmICgoKG51bSlpbm9kZS5pZCA+PSBOX1ZFUlRfQ0lSQ0xFWF9DQ18wXzVfUExBVFNUQVJUKSAmJiAoKG51bSlpbm9kZS5pZCA8PSBOX1ZFUlRfQ0lSQ0xFWF9DQ18wXzVfUExBVEVORCkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcGxhdGZvcm1fY3JlYXRlKAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogUExBVENPTE9SLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlkOiBQTEFUQUlELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU6e3g6V0lEVEgseTpIRUlHSFQsejpXSURUSH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjp7eDoobnVtKWlub2RlLngseToobnVtKWlub2RlLnksejoobnVtKWlub2RlLnp9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXRpbmc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2dwb3M6e3g6KG51bSlpbm9kZS54LHk6KG51bSlpbm9kZS55LHo6KG51bSlpbm9kZS56fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbXBsaXR1ZGU6e3g6UkFOR0UseTpSQU5HRSx6OjB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRfbXNpbnRlcnZhbDpQRVJJT0QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OjAuNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYzotMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOnt4OiJjb3MiLHk6InNpbmUiLHo6IiJ9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAoKChudW0paW5vZGUuaWQgPj0gTl9WRVJUX0NJUkNMRVpfUExBVFNUQVJUKSAmJiAoKG51bSlpbm9kZS5pZCA8PSBOX1ZFUlRfQ0lSQ0xFWl9QTEFURU5EKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwbGF0Zm9ybV9jcmVhdGUoCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBQTEFUQ09MT1IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhaWQ6IFBMQVRBSUQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZTp7eDpXSURUSCx5OkhFSUdIVCx6OldJRFRIfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOnt4OihudW0paW5vZGUueCx5OihudW0paW5vZGUueSx6OihudW0paW5vZGUuen0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbG9hdGluZzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZ3Bvczp7eDoobnVtKWlub2RlLngseToobnVtKWlub2RlLnksejoobnVtKWlub2RlLnp9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtcGxpdHVkZTp7eDowLHk6UkFOR0UsejpSQU5HRX0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdF9tc2ludGVydmFsOlBFUklPRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOnt4OiIiLHk6InNpbmUiLHo6ImNvcyJ9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAoKChudW0paW5vZGUuaWQgPj0gTl9WRVJUX0NJUkNMRVpfMF81X1BMQVRTVEFSVCkgJiYgKChudW0paW5vZGUuaWQgPD0gTl9WRVJUX0NJUkNMRVpfMF81X1BMQVRFTkQpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHBsYXRmb3JtX2NyZWF0ZSgKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFBMQVRDT0xPUiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFpZDogUExBVEFJRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlOnt4OldJRFRILHk6SEVJR0hULHo6V0lEVEh9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246e3g6KG51bSlpbm9kZS54LHk6KG51bSlpbm9kZS55LHo6KG51bSlpbm9kZS56fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsb2F0aW5nOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ncG9zOnt4OihudW0paW5vZGUueCx5OihudW0paW5vZGUueSx6OihudW0paW5vZGUuen0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1wbGl0dWRlOnt4OjAseTpSQU5HRSx6OlJBTkdFfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0X21zaW50ZXJ2YWw6UEVSSU9ELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDowLjUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTp7eDoiIix5OiJzaW5lIix6OiJjb3MifQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKCgobnVtKWlub2RlLmlkID49IE5fVkVSVF9DSVJDTEVaX0NDX1BMQVRTVEFSVCkgJiYgKChudW0paW5vZGUuaWQgPD0gTl9WRVJUX0NJUkNMRVpfQ0NfUExBVEVORCkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcGxhdGZvcm1fY3JlYXRlKAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogUExBVENPTE9SLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlkOiBQTEFUQUlELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU6e3g6V0lEVEgseTpIRUlHSFQsejpXSURUSH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjp7eDoobnVtKWlub2RlLngseToobnVtKWlub2RlLnksejoobnVtKWlub2RlLnp9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXRpbmc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2dwb3M6e3g6KG51bSlpbm9kZS54LHk6KG51bSlpbm9kZS55LHo6KG51bSlpbm9kZS56fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbXBsaXR1ZGU6e3g6MCx5OlJBTkdFLHo6UkFOR0V9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRfbXNpbnRlcnZhbDpQRVJJT0QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2M6LTEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTp7eDoiIix5OiJzaW5lIix6OiJjb3MifQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKCgobnVtKWlub2RlLmlkID49IE5fVkVSVF9DSVJDTEVaX0NDXzBfNV9QTEFUU1RBUlQpICYmICgobnVtKWlub2RlLmlkIDw9IE5fVkVSVF9DSVJDTEVaX0NDXzBfNV9QTEFURU5EKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwbGF0Zm9ybV9jcmVhdGUoCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBQTEFUQ09MT1IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhaWQ6IFBMQVRBSUQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZTp7eDpXSURUSCx5OkhFSUdIVCx6OldJRFRIfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOnt4OihudW0paW5vZGUueCx5OihudW0paW5vZGUueSx6OihudW0paW5vZGUuen0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbG9hdGluZzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZ3Bvczp7eDoobnVtKWlub2RlLngseToobnVtKWlub2RlLnksejoobnVtKWlub2RlLnp9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtcGxpdHVkZTp7eDowLHk6UkFOR0UsejpSQU5HRX0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdF9tc2ludGVydmFsOlBFUklPRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6MC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjOi0xLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6e3g6IiIseToic2luZSIsejoiY29zIn0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmICgoKG51bSlpbm9kZS5pZCA+PSBOX0hPUl9DSVJDTEVfUExBVFNUQVJUKSAmJiAoKG51bSlpbm9kZS5pZCA8PSBOX0hPUl9DSVJDTEVfUExBVEVORCkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcGxhdGZvcm1fY3JlYXRlKAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogUExBVENPTE9SLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlkOiBQTEFUQUlELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU6e3g6V0lEVEgseTpIRUlHSFQsejpXSURUSH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjp7eDoobnVtKWlub2RlLngseToobnVtKWlub2RlLnksejoobnVtKWlub2RlLnp9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXRpbmc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2dwb3M6e3g6KG51bSlpbm9kZS54LHk6KG51bSlpbm9kZS55LHo6KG51bSlpbm9kZS56fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbXBsaXR1ZGU6e3g6UkFOR0UseTowLHo6UkFOR0V9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRfbXNpbnRlcnZhbDpQRVJJT0QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTp7eDoiY29zIix5OiIiLHo6InNpbmUifQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKCgobnVtKWlub2RlLmlkID49IE5fSE9SX0NJUkNMRV8wXzVfUExBVFNUQVJUKSAmJiAoKG51bSlpbm9kZS5pZCA8PSBOX0hPUl9DSVJDTEVfMF81X1BMQVRFTkQpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHBsYXRmb3JtX2NyZWF0ZSgKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFBMQVRDT0xPUiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFpZDogUExBVEFJRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlOnt4OldJRFRILHk6SEVJR0hULHo6V0lEVEh9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246e3g6KG51bSlpbm9kZS54LHk6KG51bSlpbm9kZS55LHo6KG51bSlpbm9kZS56fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsb2F0aW5nOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ncG9zOnt4OihudW0paW5vZGUueCx5OihudW0paW5vZGUueSx6OihudW0paW5vZGUuen0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1wbGl0dWRlOnt4OlJBTkdFLHk6MCx6OlJBTkdFfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0X21zaW50ZXJ2YWw6UEVSSU9ELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDowLjUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTp7eDoiY29zIix5OiIiLHo6InNpbmUifQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKCgobnVtKWlub2RlLmlkID49IE5fSE9SX0NJUkNMRV9DQ19QTEFUU1RBUlQpICYmICgobnVtKWlub2RlLmlkIDw9IE5fSE9SX0NJUkNMRV9DQ19QTEFURU5EKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwbGF0Zm9ybV9jcmVhdGUoCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBQTEFUQ09MT1IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhaWQ6IFBMQVRBSUQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZTp7eDpXSURUSCx5OkhFSUdIVCx6OldJRFRIfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOnt4OihudW0paW5vZGUueCx5OihudW0paW5vZGUueSx6OihudW0paW5vZGUuen0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbG9hdGluZzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZ3Bvczp7eDoobnVtKWlub2RlLngseToobnVtKWlub2RlLnksejoobnVtKWlub2RlLnp9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtcGxpdHVkZTp7eDpSQU5HRSx5OjAsejpSQU5HRX0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdF9tc2ludGVydmFsOlBFUklPRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYzotMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOnt4OiJjb3MiLHk6IiIsejoic2luZSJ9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAoKChudW0paW5vZGUuaWQgPj0gTl9IT1JfQ0lSQ0xFXzBfNV9DQ19QTEFUU1RBUlQpICYmICgobnVtKWlub2RlLmlkIDw9IE5fSE9SX0NJUkNMRV8wXzVfQ0NfUExBVEVORCkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcGxhdGZvcm1fY3JlYXRlKAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogUExBVENPTE9SLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlkOiBQTEFUQUlELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU6e3g6V0lEVEgseTpIRUlHSFQsejpXSURUSH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjp7eDoobnVtKWlub2RlLngseToobnVtKWlub2RlLnksejoobnVtKWlub2RlLnp9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXRpbmc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2dwb3M6e3g6KG51bSlpbm9kZS54LHk6KG51bSlpbm9kZS55LHo6KG51bSlpbm9kZS56fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbXBsaXR1ZGU6e3g6UkFOR0UseTowLHo6UkFOR0V9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRfbXNpbnRlcnZhbDpQRVJJT0QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OjAuNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYzotMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOnt4OiJjb3MiLHk6IiIsejoic2luZSJ9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgY3JlYXRlZCA9IDE7CiAgICAgICAgfQogICAgfQoKfQoKCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojIGF1dG8tZGV0ZWN0ZWQgcHVibGljIGFjdGlvbnMgZnJvbSBsaWJyYXJpZXMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CnB1YmxpYyBhY3Rpb24gb25HYW1lRW5kICgpewogICAgcGxyYmh2cl9zX29uR2FtZUVuZCgpOwogICAgc3luY29ianNfc19vbkdhbWVFbmQoKTsKfQoKcHVibGljIGFjdGlvbiBvbk5ldHdvcmtNZXNzYWdlIChzdHIgaWQsIG9iaiBkYXRhLCBzdHIgcGxheWVySUQpewogICAgcGxydXRpbF9zX29uTmV0d29ya01lc3NhZ2UoaWQsICBkYXRhLCAgcGxheWVySUQpOwogICAgcGxyYmh2cl9zX29uTmV0d29ya01lc3NhZ2UoaWQsICBkYXRhLCAgcGxheWVySUQpOwogICAgc3luY29ianNfc19vbk5ldHdvcmtNZXNzYWdlKGlkLCAgZGF0YSwgIHBsYXllcklEKTsKICAgIGVjc19zX29uTmV0d29ya01lc3NhZ2UoaWQsICBkYXRhLCAgcGxheWVySUQpOwp9CgpwdWJsaWMgYWN0aW9uIG9uUGxheWVyU3Bhd24gKHN0ciBpZCl7CiAgICBBQUJCX29uUGxheWVyU3Bhd24oaWQpOwp9CgpwdWJsaWMgYWN0aW9uIG9uUGxheWVyTGVhdmUgKHN0ciBwbGF5ZXJJRCl7CiAgICBwbHJ1dGlsX3Nfb25QbGF5ZXJMZWF2ZShwbGF5ZXJJRCk7CiAgICBwbHJiaHZyX3Nfb25QbGF5ZXJMZWF2ZShwbGF5ZXJJRCk7Cn0KCnB1YmxpYyBhY3Rpb24gb25QbGF5ZXJEZWF0aCAoc3RyIGlkLCBzdHIga2lsbGVySUQpewogICAgcGxydXRpbF9zX29uUGxheWVyRGVhdGgoaWQsICBraWxsZXJJRCk7Cn0KCnB1YmxpYyBhY3Rpb24gc3RhcnQgKCl7CiAgICBwbHJ1dGlsX3Nfc3RhcnQoKTsKICAgIHBscmJodnJfc19zdGFydCgpOwogICAgc3luY29ianNfc19zdGFydCgpOwp9Cgo="}},"groups":{"493c2716-93c4-4496-a634-b2d3363964de":{"ids":["23eff5f0-d705-4d7e-b2ae-8ed7025f3028","e9016a18-6729-48c6-adbd-b849d891e163","a77a4e72-03d9-414b-a5cb-ebaa5f38b1ce"]},"25ca7813-b506-4753-ba13-3bdd6707173d":{"ids":["d7e27226-c4ea-47f7-aa3e-dee4a0ec9143","afb40494-d2c5-45e5-b7eb-68ca02e0b92e","4a375cf4-b307-425f-88d3-044f3ff573b0"]},"ef114562-aec7-4415-b987-97ab28bc01aa":{"ids":["c17b1e6b-67cb-4383-bdbf-f35667908ce1","a4314c74-e18c-46f0-964a-86af845c941d","418ccdf4-0015-4b9f-b224-54726edc6dda"]},"dda818ff-b7bc-478e-b4d2-366b3888f2f9":{"ids":["51ce432e-99f4-47cf-a329-1a537353b425","f63c26e9-0a27-4f95-af08-4b44fd2c11ae","35d2f234-500c-44d7-bdc6-09dcad7a505d"]},"8d55049a-8155-4d8d-bb99-0ce960c1e9d4":{"ids":["a3f87a0d-609f-49f0-9ed6-8a92ddd3008d","438863a3-35b0-4918-bbfa-4ae525d00dee","3b24c6a5-2e43-4ab0-8d21-bcf284989e00"]},"205984bc-51f4-42b5-8fcc-a64e31afbc63":{"ids":["54e12a9b-e299-4e3b-9542-45eb071001d4","9d877895-1634-4cba-8ae0-3d6adbfdce3d","e1fc0070-fe0f-496c-84f2-383e7297edeb"]},"e82222d5-c855-4ae5-8995-75b5bd755a8f":{"ids":["ccc42296-d3cc-436b-8f61-f455a9cb19eb","fb14785a-1865-4e58-819b-2ee321fe3daa","91c5bd08-a90d-49a8-8ffe-d7e8329edb59"]},"4ca2014e-12ea-4851-8677-57bc8b2eb8ab":{"ids":["b8f32724-5f4c-4129-9d9f-1682476fed08","30e43e38-8bbb-4128-ab38-27653e65efd2","daded675-9d9e-4fe6-b9b0-308f5ab51a17"]},"b0c8c79f-44b5-4e57-82fb-c8291c202370":{"ids":["2cc4b793-0aa8-4aca-b8cf-78852f8bdfd7","b9369c0f-e66e-40ac-82e5-0e6206d4a2cd","f369a65e-ff40-4031-a7d8-223c8ad42a48"]},"0384ac8e-4d17-434b-b677-ef3e0df9c2f2":{"ids":["ce73fb97-bbcb-41d1-b18c-6b5fbbd082d0","89246411-f42d-4205-9738-d97fe35b638b","6b019a83-e86b-4c20-beeb-6a3c5f1ed133"]},"98424399-6188-4218-9218-dfc8742a3aea":{"ids":["e812e3e5-6147-4c1d-ae80-deaf5e83441d","6ec55d54-1ce2-421b-821a-2e2e265a4526","2b64bce8-2823-4c16-b806-46e25387785d"]},"ff8cf6e1-7ab1-44ee-90ad-60c742613d88":{"ids":["fecc18b9-1608-47ac-97b2-3c1e17164ab9","c32de8eb-ba74-4138-b564-9de8438ea3f2","47413c3d-69bf-42fe-8b20-40c69b6de00b"]}},"selected":"0c731f3e-7ef0-4719-80da-d42798c5c1f2","cam":{"p":[490.56394248379223,575.5036135473154,208.55878614220182],"r":[-0.8039999999999934,1.3771853071795714]},"history":[]}